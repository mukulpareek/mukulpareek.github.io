<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Exploratory Data Analysis - Business Analytics, Mukul Pareek</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Exploratory Data Analysis";
        var mkdocs_page_input_path = "02_Exploratory_Data_Analysis.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Business Analytics, Mukul Pareek
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Introduction to Business Analytics</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Exploratory Data Analysis</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#what-is-eda">What is EDA?</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#inquiries-to-conduct">Inquiries to conduct</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#introduction-to-arrays">Introduction to Arrays</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#multi-dimensional-data">Multi-dimensional data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#creating-arrays-with-numpy">Creating arrays with Numpy</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#summarizing-data-along-an-axis">Summarizing data along an axis</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#subsetting-arrays-slices">Subsetting arrays ('slices')</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#more-slicing-picking-selected-rows-or-columns">More slicing: Picking selected rows or columns</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#matrix-math">Matrix math</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#transpose-with-a-t">Transpose with a .T</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#inverse-with-a-i">Inverse with a .I</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#matrix-multiplication">Matrix multiplication</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#exponents-with-matrices-and-arrays">Exponents with matrices and arrays **.</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#modulus-or-size">Modulus, or size</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#determinant-of-a-matrix-nplinalgdeta">Determinant of a matrix np.linalg.det(a)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#converting-from-matrix-to-array-and-vice-versa">Converting from matrix to array and vice-versa</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#distances-and-angles-between-vectors">Distances and angles between vectors</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#sorting-with-argsort">Sorting with argsort</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#understanding-dataframes">Understanding DataFrames</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#exploring-tabular-data-with-pandas">Exploring Tabular Data with Pandas</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#reading-data-with-pandas">Reading data with Pandas</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#other-data-types-in-python">Other data types in Python</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#loading-built-in-data-sets-in-python">Loading built-in data sets in Python</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#loading-data-from-statsmodels">Loading data from Statsmodels</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#importing-r-datasets-using-statsmodels">Importing R datasets using Statsmodels</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#datasets-in-seaborn">Datasets in Seaborn</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#datasets-in-sklearn">Datasets in sklearn</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#create-artificial-data-using-sklearn">Create Artificial Data using sklearn</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exploratory-data-analysis-using-python">Exploratory Data Analysis using Python</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#a-note-on-managing-working-directories">A note on managing working directories</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#eda-on-the-diamonds-dataset">EDA on the diamonds dataset</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#questions-we-might-like-answered">Questions we might like answered</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#load-data">Load data</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#descriptive-stats">Descriptive stats</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#functions-for-descriptive-stats">Functions for descriptive stats</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#some-quick-histograms">Some quick histograms</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#calculate-range">Calculate range</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#covariance-and-correlations">Covariance and correlations</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#quantiles-to-analyze-the-distribution">Quantiles to analyze the distribution</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#z-scores">Z-scores</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dataframe-information">Dataframe information</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#names-of-columns">Names of columns</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#other-useful-functions">Other useful functions</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#split-apply-combine">Split-Apply-Combine</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#stack">Stack</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#unstack">Unstack</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pivot-table">Pivot table</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pivot">Pivot</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#crosstab">Crosstab</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#melt">Melt</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#groupby">Groupby</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pandas-profiling">Pandas Profiling</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#profiling-our-toy-dataframe">Profiling our toy dataframe</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pandas-profiling-on-the-diamonds-dataset">Pandas Profiling on the Diamonds Dataset</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../03_Visualization_Basics/">Visualization Basics</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../04_Data_Preparation/">Data Preparation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../05_Introduction_to_Modeling/">Introduction to Modeling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../06_Recommender_Systems/">Recommender Systems</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../07_Regression/">Regression</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../08_Feature_Engineering/">Feature Engineering</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../09_Machine_Learning/">Machine Learning</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../10_Deep_Learning/">Deep Learning</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../11_Time_Series/">Time Series</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../12_Text_Data/">Text as Data</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../13.1_Transformers_and_LLMs/">Transformers and LLMs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../13.2_OpenAI/">OpenAI</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../13.3_Local_LLMs/">Local LLMs</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Business Analytics, Mukul Pareek</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Exploratory Data Analysis</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="exploratory-data-analysis">Exploratory Data Analysis</h1>
<h2 id="what-is-eda">What is EDA?</h2>
<p>EDA is the unstructured process of probing the data we haven’t seen before to understand more about it with a view to thinking about how we can use the data, and to discover what it reveals as insights at first glance.  </p>
<p>At other times, we need to analyze some data with no particular objective in mind except to find out if it could be useful for anything at all.<br />
Consider a situation where your manager points you to some data and asks you to do some analysis on it.  The data could be in a Google Drive, or a Github repo, or on a thumb drive.  It may have been received from a client, a customer or a vendor.  You may have a high level pointer to what the data is, for example you may know there is order history data, or invoice data, or web log data.  The ask may not be very specific, nor the goal clarified, but we would like to check the data out to see if there is something useful we can do with it.</p>
<p>In other situations, we are looking for something specific, and are looking for the right data to analyze.  For example, we may be trying to to identify zip codes where to market our product.  We may be able to get data that provides us information on income, consumption, population characteristics etc that could help us with our task.  When we receive such data, we would like to find out if it is fit for purpose.  </p>
<h3 id="inquiries-to-conduct">Inquiries to conduct</h3>
<p>So when you get data that you do not know much about in advance, you start with exploratory data analysis, or EDA.  Possible inquiries you might like to conduct are:</p>
<ul>
<li>How much data do we have - number of rows in the data?</li>
<li>How many columns, or fields do we have in the dataset?</li>
<li>Data types - which of the columns appear to be numeric, dates or strings?</li>
<li>Names of the columns, and do they tell us anything?</li>
<li>A visual review of a sample of the dataset</li>
<li>Completeness of the dataset, are missing values obvious?  Columns that are largely empty?</li>
<li>Unique values for columns that appear to be categorical, and how many observations of each category?</li>
<li>For numeric columns, the range of values (calculated from min and max values)</li>
<li>Distributions for the different columns, possibly graphed</li>
<li>Correlations between the different columns</li>
</ul>
<p>Exploratory Data Analysis (EDA) is generally the first activity performed to get a high level understanding of new data.  It employs a variety of graphical and summarization techniques to get a ‘sense of the data’.</p>
<p>The purpose of Exploratory Data Analysis is to interrogate the data in an open-minded way with a view to understanding the structure of the data, uncover any prominent themes, identify important variables, detect obvious anomalies, consider missing values, review data types, obtain a visual understanding of the distribution of the data, understand correlations between variables, etc.  Not all these things can be discovered during EDA, but these are generally the things we look for when performing EDA. </p>
<p>EDA is unstructured exploration, there is not a defined set of activities you must perform.  Generally, you probe the data, and depending upon what you discover, you ask more questions.</p>
<h2 id="introduction-to-arrays">Introduction to Arrays</h2>
<p>Arrays, or collection of numbers, are fundamental to analytics at scale.  We will cover arrays from a NumPy lens exclusively, given how much NumPy dominates all array based manipulation.  </p>
<p>NumPy is the underlying library for manipulating arrays in Python.  And arrays are really important for analytics.  The reason arrays are important is because many analytical algorithms will only accept arrays as input.  Deep learning networks will exclusively accept only arrays as input, though arrays are called <strong><em>tensors</em></strong> in the deep learning world.  In addition to this practical issue, data is much easier to manipulate, transform and perform mathematical operations on if it is expressed as an array.  </p>
<p>NumPy underpins pandas as well as many other libraries.  So we may not be using it a great deal, but there will be situations where numpy is unavoidable.</p>
<p>Below is a high level overview of what arrays are, and some basic array operations.  </p>
<hr />
<h3 id="multi-dimensional-data">Multi-dimensional data</h3>
<p>Arrays have structure in the form of dimensions, and numbers sit at the intersection of these dimensions.  In a spreadsheet, you see two dimensions - one being the rows, represented as 1, 2, 3..., and the other the columns, repesented as A, B, C.  Numpy arrays can have any number of dimensions, even though dimensions beyond the third are humanly impossible to visualize.</p>
<p>A numpy array when printed in Python encloses data for a dimension in square brackets.  The fundamental unit of an array of any size is a single one-dimensional row where numbers are separated by commas and enclosed in a set of square brackets, for example, <code>[1, 2, 3, 1]</code>.  Several of these will then be arranged within additional nested square brackets to make up the complete array.  To understand the idea of an array, mentally visualize a 2-dimensional array similar to a spreadsheet.  Every number within the array exists at the intersection of all of its dimensions.  In Python, each position along a dimension, more commonly called an <em>axis</em>, is represented by numbers starting with the first element being 0.  These positions are called indexes.</p>
<p>The number of square brackets <code>[</code> gives the number of dimensions in the array.  Two are represented on screen, the rows and columns, like a 2D matrix.  But the screen is two-dimensional, and cannot display additional dimensions.  Therefore all other dimensions appear as repeats of rows and columns - look at the example next. The last two dimensions, eg here 3, 4 represent rows and columns.  The 2, the first one, means there are two sets of these rows and columns in the array!</p>
<hr />
<h3 id="creating-arrays-with-numpy">Creating arrays with Numpy</h3>
<p>Everything that Numpy touches ends as an array, just like everything from a pandas function is a dataframe.  Easiest way to generate a random array is <code>np.random.randn(2,3)</code> which will give an array with dimensions 2,3.  You can pick any other dimensions too.  <code>randn</code> gives random normal numbers.</p>
<pre><code class="language-python"># import some libraries

import pandas as pd
import os
import random
import numpy as np
import scipy
import math
import joblib 
</code></pre>
<pre><code class="language-python"># Create a one dimensional array

np.random.randn(4)
</code></pre>
<pre><code>array([ 1.1736499 ,  1.54772703, -0.21693701,  0.31459622])
</code></pre>
<pre><code class="language-python"># Create a 2-dimensional array with random normal variables
# np.random.seed(123)

np.random.randn(2,3)
</code></pre>
<pre><code>array([[-0.4905774 , -1.47052507, -1.04379812],
       [-0.20386335,  0.56686123,  1.16730192]])
</code></pre>
<pre><code class="language-python"># Create a 3-dimensional array with random integers

x = np.random.randint(low = 1, high = 5, size = (2,3,4))
print('Shape: ', x.shape)
x
</code></pre>
<pre><code>Shape:  (2, 3, 4)





array([[[3, 3, 2, 1],
        [2, 1, 1, 2],
        [1, 1, 1, 3]],

       [[1, 4, 1, 1],
        [3, 2, 1, 1],
        [2, 4, 2, 3]]])
</code></pre>
<p>Numpy axes numbers run from left to right, starting with the index 0.  So <code>x.shape</code> gives me 2, 3, 4 which means 2 is the 0th axis, 3 rows are the 1st axis and 4 columns are the 2nd axis.  </p>
<p>The shape of the above array is (2, 3, 4)  </p>
<p>axis = 0 means : (<strong>2</strong>, 3, 4)<br />
axis = 1 means : (2, <strong>3</strong>, 4)<br />
axis = 2 means : (2, 3, <strong>4</strong>)  </p>
<pre><code class="language-python"># Create a 3-dimensional array

data = np.random.randn(2, 3, 4)
print('The shape of the array is:', data.shape)
data
</code></pre>
<pre><code>The shape of the array is: (2, 3, 4)





array([[[-0.94207619,  0.85819949,  0.85937811,  0.03423557],
        [ 0.43471567, -0.3977568 , -0.38560239,  1.37103135],
        [-0.8236544 , -0.75445943,  0.34979668,  0.46855885]],

       [[ 1.12936861, -0.44238069,  0.96649123, -1.36034059],
        [ 0.64099078,  1.41112827, -0.58302938,  0.0526134 ],
        [ 1.6253795 ,  0.47798241,  0.53996765, -0.77834533]]])
</code></pre>
<blockquote>
<p>The number of <code>[</code> gives the number of dimensions in the array.<br />
Two are represented on screen, the rows and columns.  All others appear afterwards.
The last two dimensions, eg here 3, 4 represent rows and columns.  The 2, the first one, means there are two 
sets of these rows and columns in the array.</p>
</blockquote>
<pre><code class="language-python">np.random.randn(4, 3, 2)
</code></pre>
<pre><code>array([[[-1.84207847, -0.22688959],
        [ 1.40275113,  0.74415778],
        [-0.15042182, -0.75451819]],

       [[ 0.58001497,  0.9170983 ],
        [ 0.253829  ,  1.08733683],
        [-0.6430149 ,  2.01905416]],

       [[ 0.15379162, -0.07853098],
        [-0.85224692,  0.25954211],
        [ 0.0392591 ,  0.29043794]],

       [[-0.85687338, -0.90593571],
        [-1.28917985,  0.25920641],
        [ 1.48624977, -0.27429377]]])
</code></pre>
<pre><code class="language-python"># Now let us add another dimension.  But this time random integers than random normal.
# The random integer function (randint) requires specifying low and high for the uniform distribution.

data = np.random.randint(low = 1, high = 100, size = (2,3,2,4))
data
</code></pre>
<pre><code>array([[[[50, 35, 31, 23],
         [67, 69, 34, 61]],

        [[70, 83, 55, 30],
         [47, 76, 54, 61]],

        [[73, 14, 87, 13],
         [ 8, 95,  6, 13]]],


       [[[73, 33, 25, 83],
         [48, 73, 44, 83]],

        [[54, 24, 72,  3],
         [ 1, 91, 30, 60]],

        [[62, 39, 74, 77],
         [14, 33,  8, 83]]]])
</code></pre>
<p>So there will be a collection of 2 rows x 4 columns matrices, repeated 3 times, and that entire set another 2 times. <br><br>
And the 4 occurrences of <code>[[[[</code> means there are 4 dimensions to the array.</p>
<pre><code class="language-python">type(data)
</code></pre>
<pre><code>numpy.ndarray
</code></pre>
<pre><code class="language-python"># Converting a list to an array

list1 = list(range(12))
list1
</code></pre>
<pre><code>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
</code></pre>
<pre><code class="language-python">array1 = np.array(list1)
array1
</code></pre>
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])
</code></pre>
<pre><code class="language-python"># This array1 is one dimensional, let us convert to a 3x4 array.
array1.shape = (3,4)
array1
</code></pre>
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</code></pre>
<pre><code class="language-python"># Create arrays of zeros
array1 = np.zeros((2,3)) # The dimensions must be a tuple inside the brackets
array1
</code></pre>
<pre><code>array([[0., 0., 0.],
       [0., 0., 0.]])
</code></pre>
<pre><code class="language-python"># Create arrays from a range
array1 = np.arange((12))
array1
</code></pre>
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11])
</code></pre>
<pre><code class="language-python">#You can reshape the dimensions of an array
array1.reshape(3,4) 
</code></pre>
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</code></pre>
<pre><code class="language-python">array1.reshape(3,2,2)
</code></pre>
<pre><code>array([[[ 0,  1],
        [ 2,  3]],

       [[ 4,  5],
        [ 6,  7]],

       [[ 8,  9],
        [10, 11]]])
</code></pre>
<pre><code class="language-python"># Create an array of 1's
array1 = np.ones((3,5))
array1
</code></pre>
<pre><code>array([[1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.]])
</code></pre>
<pre><code class="language-python"># Creates the identity matrix 
array1 = np.eye(4) 
array1
</code></pre>
<pre><code>array([[1., 0., 0., 0.],
       [0., 1., 0., 0.],
       [0., 0., 1., 0.],
       [0., 0., 0., 1.]])
</code></pre>
<pre><code class="language-python"># Create an empty array - useful if you need a place to keep data that will be generated later in the code.
# It shows zeros but is actually empty

np.empty([2,3])
</code></pre>
<pre><code>array([[6.23042070e-307, 4.67296746e-307, 1.69121096e-306],
       [9.34609111e-307, 1.42413555e-306, 1.78019082e-306]])
</code></pre>
<h3 id="summarizing-data-along-an-axis">Summarizing data along an axis</h3>
<p>Putting the <code>axis = n</code> argument with a summarization function (eg, sum) makes the axis <em>n</em> disappear, having been summarized into the function's results, leaving only the rest of the dimensions.  So <code>np.sum(array_name, axis = n)</code>, similarly <code>mean()</code>, <code>min()</code>, <code>median()</code>, <code>std()</code> etc will calculate the aggregation function by collapsing all the elements of the selected axis number into one and performing that operation.  See below using the sum function.  </p>
<pre><code class="language-python">x = data = np.random.randint(low = 1, high = 100, size = (2,3))
x
</code></pre>
<pre><code>array([[17, 58, 47],
       [63, 98, 94]])
</code></pre>
<pre><code class="language-python"># So with axis = 0, the very first dimension, ie the 2 rows, will collapse leaving an array of shape (3,)
x.sum(axis = 0)
</code></pre>
<pre><code>array([ 80, 156, 141])
</code></pre>
<pre><code class="language-python"># So with axis = 0, the very first dimension, ie the 2 rows, will collapse leaving an array of shape (2,)
x.sum(axis = 1)
</code></pre>
<pre><code>array([122, 255])
</code></pre>
<h3 id="subsetting-arrays-slices">Subsetting arrays ('slices')</h3>
<p>Python starts numbering things starting with zero, which means the first item is the 0th item.  </p>
<p>The portion of the dimension you wish to select is given in the form <code>start:finish</code> where the <code>start</code> element is included, but the <code>finish</code> is excluded.  So <code>1:3</code> means include 1 and 2 but not 3.</p>
<p><code>:</code> means include everything</p>
<pre><code class="language-python">array1 = np.random.randint(0, 100, (3,5))
array1
</code></pre>
<pre><code>array([[46, 19, 51, 42, 76],
       [80, 27, 40, 28, 81],
       [34, 37, 87, 93, 97]])
</code></pre>
<pre><code class="language-python">array1[0:2, 0:2]
</code></pre>
<pre><code>array([[46, 19],
       [80, 27]])
</code></pre>
<pre><code class="language-python">array1[:,0:2] # ':' means include everything
</code></pre>
<pre><code>array([[46, 19],
       [80, 27],
       [34, 37]])
</code></pre>
<pre><code class="language-python">array1[0:2]
</code></pre>
<pre><code>array([[46, 19, 51, 42, 76],
       [80, 27, 40, 28, 81]])
</code></pre>
<pre><code class="language-python">#Slices are references to the original array.  So you if you need a copy, use the below:
array1[0:2].copy()
</code></pre>
<pre><code>array([[46, 19, 51, 42, 76],
       [80, 27, 40, 28, 81]])
</code></pre>
<p>Generally, use the above 'Long Form' way for slicing where you specify the indices for each dimension. Where everything is to be included, use <code>:</code>.  There are other short-cut methods of slicing, but can leave those as is.</p>
<p>Imagine an array a1 with dimensions (3, 5, 2, 4).  This means:
 - This array has 3 arrays in it that have the dimensions (5, 2, 4)
 - Each of these 3 arrays have 5 additional arrays each in them of the dimension (2,4).  (So there are 3*5=15 of these 2x4 arrays)
 - Each of these (2,4) arrays has 2 one-dimensional arrays with 4 columns.</p>
<p>If in the slice notation only a portion of what to include is specified, eg a1[0], then it means we are asking for the first one of these axes, ie the dimension parameters are specifying from the left of (3, 5, 2, 4).  It means give me the first of the 3 arrays with size (5,2,4).  </p>
<p>If the slice notation says a1[0,1], then it means 0th element of the first dim, and 1st element of the second dim.</p>
<p>Check it out using the following code:</p>
<pre><code class="language-python">a1 = np.random.randint(0, 100, (3,4,2,5))
a1
</code></pre>
<pre><code>array([[[[59, 41, 61,  8, 39],
         [73, 32, 61, 51,  6]],

        [[69,  3, 25,  8, 46],
         [67, 65, 13, 83, 88]],

        [[79, 17, 61, 24, 86],
         [97, 47, 49, 53, 55]],

        [[77, 52, 43, 40, 74],
         [51, 39, 97, 66, 19]]],


       [[[54, 88, 81, 40, 95],
         [74, 61, 27, 53, 92]],

        [[ 9, 57, 21, 87, 73],
         [99,  6, 77, 63, 76]],

        [[73, 31, 94, 85, 65],
         [95, 78, 27, 83, 44]],

        [[75, 63, 71, 49, 43],
         [54,  4, 93, 75, 70]]],


       [[[87,  0, 13, 69,  0],
         [81, 13, 88, 24, 36]],

        [[21, 19, 30, 32, 55],
         [40, 21, 74, 89, 68]],

        [[80, 34, 75, 13,  9],
         [63, 19, 73, 12, 47]],

        [[27, 29, 45, 65, 43],
         [83, 21, 11, 45,  6]]]])
</code></pre>
<pre><code class="language-python">a1[0].shape
</code></pre>
<pre><code>(4, 2, 5)
</code></pre>
<pre><code class="language-python">a1[0]
</code></pre>
<pre><code>array([[[59, 41, 61,  8, 39],
        [73, 32, 61, 51,  6]],

       [[69,  3, 25,  8, 46],
        [67, 65, 13, 83, 88]],

       [[79, 17, 61, 24, 86],
        [97, 47, 49, 53, 55]],

       [[77, 52, 43, 40, 74],
        [51, 39, 97, 66, 19]]])
</code></pre>
<pre><code class="language-python">a1[0,1]
</code></pre>
<pre><code>array([[69,  3, 25,  8, 46],
       [67, 65, 13, 83, 88]])
</code></pre>
<h3 id="more-slicing-picking-selected-rows-or-columns">More slicing: Picking selected rows or columns</h3>
<pre><code class="language-python">a1 = np.random.randint(0, 100, (8,9))
a1
</code></pre>
<pre><code>array([[44, 78, 29, 91, 82, 86, 76,  3, 90],
       [69, 96, 29, 79, 25, 47, 95, 87, 85],
       [79, 42, 99, 88, 14, 38, 47, 62, 41],
       [39, 98, 27, 95, 65,  2, 59, 72, 16],
       [46, 44, 55, 65, 32,  5, 79, 40, 65],
       [38, 76, 78,  8, 76, 35, 27, 32, 51],
       [58, 75,  3, 99, 23, 73, 77, 12, 39],
       [66, 43, 58, 35, 33, 85, 75,  8, 10]])
</code></pre>
<pre><code class="language-python"># Select the first row
a1[0]
</code></pre>
<pre><code>array([44, 78, 29, 91, 82, 86, 76,  3, 90])
</code></pre>
<pre><code class="language-python"># Select the fourth row
a1[3]
</code></pre>
<pre><code>array([39, 98, 27, 95, 65,  2, 59, 72, 16])
</code></pre>
<pre><code class="language-python"># Select the first and the fourth row together
a1[[0,3]]
</code></pre>
<pre><code>array([[44, 78, 29, 91, 82, 86, 76,  3, 90],
       [39, 98, 27, 95, 65,  2, 59, 72, 16]])
</code></pre>
<pre><code class="language-python"># Select the first and the fourth column
a1[:,[0,3]]
</code></pre>
<pre><code>array([[44, 91],
       [69, 79],
       [79, 88],
       [39, 95],
       [46, 65],
       [38,  8],
       [58, 99],
       [66, 35]])
</code></pre>
<pre><code class="language-python"># Select subset of named rows and columns

a1[[0, 3]][:,[0, 1]] # Named rows and columns.  

# Note that a1[[0, 3],[0, 1]] does not work as expected, it selects two points (0,0)and (3,1).  
# Really crazy but it is what it is.
</code></pre>
<pre><code>array([[44, 78],
       [39, 98]])
</code></pre>
<p>### Operations on arrays
 <strong>All math on arrays is element wise, and scalars are multiplied/added with each element.</strong></p>
<pre><code class="language-python">array1 + 4
</code></pre>
<pre><code>array([[68, 82, 45, 28, 15],
       [86, 33, 19, 37, 21],
       [29, 72, 94, 70, 62]])
</code></pre>
<pre><code class="language-python">array1 &gt; np.random.randint(0, 2, (3,5))
</code></pre>
<pre><code>array([[ True,  True,  True,  True,  True],
       [ True,  True,  True,  True,  True],
       [ True,  True,  True,  True,  True]])
</code></pre>
<pre><code class="language-python">array1 + 2
</code></pre>
<pre><code>array([[66, 80, 43, 26, 13],
       [84, 31, 17, 35, 19],
       [27, 70, 92, 68, 60]])
</code></pre>
<pre><code class="language-python">np.sum(array1) # adds all the elements of an array
</code></pre>
<pre><code>701
</code></pre>
<pre><code class="language-python">np.sum(array1, axis = 0) # adds all elements of the array along a particular axis
</code></pre>
<pre><code>array([171, 175, 146, 123,  86])
</code></pre>
<h3 id="matrix-math">Matrix math</h3>
<p>Numpy has arrays as well as matrices.  Matrices are 2D, arrays can have any number of dimensions. The only real difference between a matrix (type = <code>numpy.matrix</code>) and an array (type = <code>numpy.ndarray</code>) is that all array operations are element wise, ie the special R x C matrix multiplication does not apply to arrays.  However, for an array that is 2 x 2 in shape you can use the <code>@</code> operator to do matrix math.</p>
<p>So that leaves matrices and arrays interchangeable in a practical sense.  Except that you can't do an inverse of an array using <code>.I</code> which you can for a matrix.</p>
<pre><code class="language-python"># Create a matrix 'm' and an array 'a' that are identical
m = np.matrix(np.random.randint(0,10,(3,3)))
a = np.array(m)
</code></pre>
<pre><code class="language-python">m
</code></pre>
<pre><code>matrix([[4, 2, 7],
        [7, 0, 2],
        [9, 3, 4]])
</code></pre>
<pre><code class="language-python">a
</code></pre>
<pre><code>array([[4, 2, 7],
       [7, 0, 2],
       [9, 3, 4]])
</code></pre>
<h4 id="transpose-with-a-t">Transpose with a <code>.T</code></h4>
<pre><code class="language-python">m.T
</code></pre>
<pre><code>matrix([[4, 7, 9],
        [2, 0, 3],
        [7, 2, 4]])
</code></pre>
<pre><code class="language-python">a.T
</code></pre>
<pre><code>array([[4, 7, 9],
       [2, 0, 3],
       [7, 2, 4]])
</code></pre>
<h4 id="inverse-with-a-i">Inverse with a <code>.I</code></h4>
<p><strong>Does not work for arrays</strong></p>
<pre><code class="language-python">m.I
</code></pre>
<pre><code>matrix([[-0.05825243,  0.12621359,  0.03883495],
        [-0.09708738, -0.45631068,  0.39805825],
        [ 0.2038835 ,  0.05825243, -0.13592233]])
</code></pre>
<h4 id="matrix-multiplication">Matrix multiplication</h4>
<p>For matrices, just a <code>*</code> suffices for matrix multiplication.  If using arrays, use <code>@</code> for matrix multiplication, which also works for matrices.  So just to be safe, just use <code>@</code>.</p>
<p><strong>Dot-product</strong> is the same as row-by-column matrix multiplication, and is not elementwise.</p>
<pre><code class="language-python">a=np.matrix([[4, 3], [2, 1]])
b=np.mat([[1, 2], [3, 4]])
</code></pre>
<pre><code class="language-python">a
</code></pre>
<pre><code>matrix([[4, 3],
        [2, 1]])
</code></pre>
<pre><code class="language-python">b
</code></pre>
<pre><code>matrix([[1, 2],
        [3, 4]])
</code></pre>
<pre><code class="language-python">a*b
</code></pre>
<pre><code>matrix([[13, 20],
        [ 5,  8]])
</code></pre>
<pre><code class="language-python">a@b
</code></pre>
<pre><code>matrix([[13, 20],
        [ 5,  8]])
</code></pre>
<pre><code class="language-python"># Now check with arrays
a=np.array([[4, 3], [2, 1]])
b=np.array([[1, 2], [3, 4]])
</code></pre>
<pre><code class="language-python">a@b # does matrix multiplication.  
</code></pre>
<pre><code>array([[13, 20],
       [ 5,  8]])
</code></pre>
<pre><code class="language-python">a
</code></pre>
<pre><code>array([[4, 3],
       [2, 1]])
</code></pre>
<pre><code class="language-python">b
</code></pre>
<pre><code>array([[1, 2],
       [3, 4]])
</code></pre>
<pre><code class="language-python">a*b # element-wise multiplication as a and b are arrays
</code></pre>
<pre><code>array([[4, 6],
       [6, 4]])
</code></pre>
<p><code>@</code> is the same as <code>np.dot(a, b)</code>, which is just a longer fully spelled out function.</p>
<pre><code class="language-python">np.dot(a,b)
</code></pre>
<pre><code>array([[13, 20],
       [ 5,  8]])
</code></pre>
<h4 id="exponents-with-matrices-and-arrays">Exponents with matrices and arrays <code>**</code>.</h4>
<pre><code class="language-python">a = np.array([[4, 3], [2, 1]])
m = np.matrix(a)
m
</code></pre>
<pre><code>matrix([[4, 3],
        [2, 1]])
</code></pre>
<pre><code class="language-python">a**2 # Because a is an array, this will square each element of a.
</code></pre>
<pre><code>array([[16,  9],
       [ 4,  1]], dtype=int32)
</code></pre>
<pre><code class="language-python">m**2 # Because m is a matrix, this will be read as m*m, and dot product of the matrix with itself will result.
</code></pre>
<pre><code>matrix([[22, 15],
        [10,  7]])
</code></pre>
<p>which is same as <code>a@a</code></p>
<pre><code class="language-python">a@a
</code></pre>
<pre><code>array([[22, 15],
       [10,  7]])
</code></pre>
<h4 id="modulus-or-size">Modulus, or size</h4>
<p>The modulus is just <code>sqrt(a^2 + b^2 + ....n^2)</code>, where a, b...n are elements of the vector, matrix or array.  Can be calculated using <code>np.linalg.norm(a)</code></p>
<pre><code class="language-python">a = np.array([4,3,2,1])
np.linalg.norm(a)
</code></pre>
<pre><code>5.477225575051661
</code></pre>
<pre><code class="language-python"># Same as calculating manually
(4**2 + 3**2 + 2**2 + 1**2) ** 0.5
</code></pre>
<pre><code>5.477225575051661
</code></pre>
<pre><code class="language-python">b

</code></pre>
<pre><code>array([[1, 2],
       [3, 4]])
</code></pre>
<pre><code class="language-python">np.linalg.norm(b)
</code></pre>
<pre><code>5.477225575051661
</code></pre>
<pre><code class="language-python">m
</code></pre>
<pre><code>matrix([[4, 3],
        [2, 1]])
</code></pre>
<pre><code class="language-python">np.linalg.norm(m)
</code></pre>
<pre><code>5.477225575051661
</code></pre>
<pre><code class="language-python">m = np.matrix(np.random.randint(0,10,(3,3)))
m
</code></pre>
<pre><code>matrix([[1, 4, 5],
        [2, 3, 6],
        [4, 6, 6]])
</code></pre>
<pre><code class="language-python">np.linalg.norm(m)
</code></pre>
<pre><code>13.379088160259652
</code></pre>
<pre><code class="language-python">print(np.ravel(m))
print(type(np.ravel(m)))
print('Manual calculation for norm')
((np.ravel(m)**2).sum())**.5
</code></pre>
<pre><code>[1 4 5 2 3 6 4 6 6]
&lt;class 'numpy.ndarray'&gt;
Manual calculation for norm





13.379088160259652
</code></pre>
<h4 id="determinant-of-a-matrix-nplinalgdeta">Determinant of a matrix <code>np.linalg.det(a)</code></h4>
<p>Used for calculating the inverse of a matrix, and only applies to square matrices.</p>
<pre><code class="language-python">np.linalg.det(m)
</code></pre>
<pre><code>30.000000000000014
</code></pre>
<h4 id="converting-from-matrix-to-array-and-vice-versa">Converting from matrix to array and vice-versa</h4>
<p><code>np.asmatrix</code> and <code>np.asarray</code> allow you to convert one to the other. Though above we have just used np.array and np.matrix without any issue.</p>
<p>The above references: https://stackoverflow.com/questions/4151128/what-are-the-differences-between-numpy-arrays-and-matrices-which-one-should-i-u</p>
<h4 id="distances-and-angles-between-vectors">Distances and angles between vectors</h4>
<p><strong>Size of a vector, angle between vectors, distance between vectors</strong></p>
<pre><code class="language-python"># We set up two vectors a and b

a = np.array([1,2,3]); b = np.array([5,4,3])
print('a =',a)
print('b =',b)
</code></pre>
<pre><code>a = [1 2 3]
b = [5 4 3]
</code></pre>
<pre><code class="language-python"># Size of the vector, computed as the root of the squares of each of the elements
np.linalg.norm(a) 
</code></pre>
<pre><code>3.7416573867739413
</code></pre>
<pre><code class="language-python"># Distance between two vectors
np.linalg.norm(a - b) 
</code></pre>
<pre><code>4.47213595499958
</code></pre>
<pre><code class="language-python"># Which is the same as 
print(np.sqrt(np.dot(a, a) - 2 * np.dot(a, b) + np.dot(b, b)))
(a@a + b@b - 2*a@b)**.5
</code></pre>
<pre><code>4.47213595499958





4.47213595499958
</code></pre>
<pre><code class="language-python"># Combine the two vectors
X = np.concatenate((a,b)).reshape(2,3)
X
</code></pre>
<pre><code>array([[1, 2, 3],
       [5, 4, 3]])
</code></pre>
<pre><code class="language-python"># Euclidean distance is the default metric for this function
# from sklearn
from sklearn.metrics import pairwise_distances
pairwise_distances(X)
</code></pre>
<pre><code>array([[0.        , 4.47213595],
       [4.47213595, 0.        ]])
</code></pre>
<pre><code class="language-python"># Angle in radians between two vectors. To get the
# answer in degrees, multiply by 180/pi, or 180/math.pi (after import math).  Also there is a function in math called
# math.radians to get radians from degrees, or math.degrees(x) to convert angle x from radians to degrees.

import math
angle_in_radians = np.arccos(np.dot(a,b) / (np.linalg.norm(a) * np.linalg.norm(b))) 
angle_in_degrees = math.degrees(angle_in_radians)

print('Angle in degrees =', angle_in_degrees)
print('Angle in radians =', angle_in_radians)
</code></pre>
<pre><code>Angle in degrees = 33.74461333141198
Angle in radians = 0.5889546074455115
</code></pre>
<pre><code class="language-python"># Same as above using math.acos instead of np.arccos

math.acos(np.dot(a,b) / (np.linalg.norm(a) * np.linalg.norm(b))) 
</code></pre>
<pre><code>0.5889546074455115
</code></pre>
<h4 id="sorting-with-argsort">Sorting with <code>argsort</code></h4>
<p>Which is the same as sort, but  shows index numbers instead of the values</p>
<pre><code class="language-python"># We set up an array

a = np.array([20,10,30,0])
</code></pre>
<pre><code class="language-python"># Sorted indices

np.argsort(a)
</code></pre>
<pre><code>array([3, 1, 0, 2], dtype=int64)
</code></pre>
<pre><code class="language-python"># Using the indices to get the sorted values

a[np.argsort(a)]
</code></pre>
<pre><code>array([ 0, 10, 20, 30])
</code></pre>
<pre><code class="language-python"># Descending sort indices

np.argsort(a)[::-1]
</code></pre>
<pre><code>array([2, 0, 1, 3], dtype=int64)
</code></pre>
<pre><code class="language-python"># Descending sort values

a[np.argsort(a)[::-1]]
</code></pre>
<pre><code>array([30, 20, 10,  0])
</code></pre>
<pre><code class="language-python">
</code></pre>
<h2 id="understanding-dataframes">Understanding DataFrames</h2>
<p>As we discussed in the prior section, understanding and manipulating arrays of numbers is fundamental to the data science process.  This is because nearly all ML and AI algorithms insist on being provided data arrays as inputs, and the NumPy library underpins almost all of data science.</p>
<p>As we discussed, a NumPy array is essentially a collection of numbers.  This collection is organized along ‘dimensions’.  So NumPy objects are n-dimensional array objects, or <em>ndarray</em>, a fast and efficient container for large datasets in Python.  </p>
<p>But arrays have several limitations.  One huge limitation is that they are raw containers with numbers, they don't have 'headers', or labels that describe the columns, rows, or the additional dimensions.  This means we need to track separately somewhere what each of the dimensions mean.  Another limitation is that after 3 dimensions, the additional dimensions are impossible toto visualize in the human mind.  For most practical purposes, humans like to think of data in the tabular form, with just rows and columns.  If there are more dimensions, one can have multiple tables.</p>
<p>This is where <em>pandas</em> steps in.  Pandas use dataframes, or a spreadsheet like construct where there are rows and columns, and these rows and columns can have names or headings.  Pandas dataframes are easily converted to NumPy arrays, and algorithms will mostly accept a dataframe as an input just as they would an array.</p>
<h3 id="exploring-tabular-data-with-pandas">Exploring Tabular Data with Pandas</h3>
<p>Tabular data is often the most common data type that is encountered, though ‘unstructured’ data is increasingly becoming common.  Tabular data is two dimensional data – with rows and columns.  The columns are defined and understood, and we generally understand what they contain.  </p>
<ul>
<li>Data is laid out as a 2-dimensional matrix, whether in a spreadsheet, or R/Python dataframes, or in a database table.  </li>
<li>Rows generally represent individual observations, while columns are the fields/variables.  </li>
<li>Variables can be numeric, or categorical.  </li>
<li>Numerical variables can be integers, floats etc, and are continuous.  </li>
<li>Categorical variables may be cardinal (eg, species, gender), or ordinal (eg, low, medium, high), and belong to a discrete set.  </li>
<li>Categorical variables are also called factors, and levels.  </li>
<li>Algorithms often require categorical variables to be converted to numerical variables.  </li>
</ul>
<p>Unstructured data includes audio, video and other kinds of data that is useful for problems of perception.  Unstructured data will almost invariably need to be converted into structured arrays with defined dimensions, but for the moment we will skip that.  </p>
<h3 id="reading-data-with-pandas">Reading data with Pandas</h3>
<p>Pandas offer several different functions for reading different types of data.</p>
<blockquote>
<p><code>read_csv</code> : Load comma separated files<br />
<code>read_table</code> : Load tab separated files<br />
<code>read_fwf</code> : Read data in fixed-width column format (i.e., no delimiters)<br />
<code>read_clipboard</code> Read data from the clipboard; useful for converting tables from web pages<br />
<code>read_excel</code> : Read Excel files<br />
<code>read_html</code> : Read all tables found in the given HTML document<br />
<code>read_json</code> : Read data from a JSON (JavaScript Object Notation) file<br />
<code>read_pickle</code> : Read a pickle file<br />
<code>read_sql</code> : Read results of an SQL query<br />
<code>read_sas</code> : Read SAS files  </p>
</blockquote>
<h2 id="other-data-types-in-python">Other data types in Python</h2>
<ul>
<li>Lists are represented as <code>[]</code>.  Lists are a changeable collection of elements, and the elements can be any Python data, eg strings, numbers, dictionaries, or even other lists.<br></li>
<li>Dictionaries are enclosed in <code>{}</code>.  These are 'key:value' pairs, where 'key' is almost like a name given to a 'value'.<br></li>
<li>Sets are also enclosed in <code>{}</code>, except they don't have the colons separating the key:value pairs.  These are collections of items, and they are unordered. <br></li>
<li>Tuples are collections of variables, and enclosed in <code>()</code>.  They are different from sets in that they are unchangeable.</li>
</ul>
<pre><code class="language-python"># Example - creating a list

empty_list = []
list1 = ['a', 2,4, 'python']
list1
</code></pre>
<pre><code>['a', 2, 4, 'python']
</code></pre>
<pre><code class="language-python"># Example - creating a dictionary

dict1 = {'first': ['John', 'Jane'], 'something_else': (1,2,3)}
dict1
</code></pre>
<pre><code>{'first': ['John', 'Jane'], 'something_else': (1, 2, 3)}
</code></pre>
<pre><code class="language-python">dict1['first']
</code></pre>
<pre><code>['John', 'Jane']
</code></pre>
<pre><code class="language-python">dict1['something_else']
</code></pre>
<pre><code>(1, 2, 3)
</code></pre>
<pre><code class="language-python"># Checking the data type of the new variable we created

type(dict1)
</code></pre>
<pre><code>dict
</code></pre>
<pre><code class="language-python"># Checking the data type

type(list1)
</code></pre>
<pre><code>list
</code></pre>
<pre><code class="language-python"># Set operations

set1 = {1,2,4,5} # Sets can do intersect, union and difference
</code></pre>
<pre><code class="language-python"># Tuple example
tuple1 = 1, 3, 4 # or
tuple1 = (1, 3, 4)
tuple1
</code></pre>
<pre><code>(1, 3, 4)
</code></pre>
<pre><code class="language-python">
</code></pre>
<h2 id="loading-built-in-data-sets-in-python">Loading built-in data sets in Python</h2>
<p>Before we move forward with getting into the details with EDA, we will first take a small digressive detour to talk about data sets.  </p>
<p>In order to experiment with EDA, we need some data.  We can bring our own data, but for exploration and experimentation, it is often easy to load up one of the many in-built datasets accessible through Python.  These datasets cover the spectrum - from really small datasets to those with many thousands of records, and include text data such as movie reviews and tweets.  </p>
<p>We will leverage these built in datasets for the rest of the discussion as they provide a good path to creating reproducible examples. These datasets are great for experimenting, testing, doing tutorials and exercises.</p>
<p>The next few headings will cover these in-built datasets.</p>
<ul>
<li>The Statsmodels library provides access to several interesting inbuilt datasets in Python.  </li>
<li>The datasets available in R can also be accessed through statsmodels.  </li>
<li>The Seaborn library has several toy datasets available to explore.  </li>
<li>The Scikit Learn (sklearn) library also has in-built datasets.   </li>
<li>Scikit Learn also provides a function to generate random datasets with described characteristics (<code>make_blobs</code> function)  </li>
</ul>
<p>In the rest of this discussion, we will use these data sets and explore the data.  </p>
<p>Some of these are described below, together with information on how to access and use such datasets.  </p>
<pre><code class="language-python"># Load the regular libraries
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
</code></pre>
<h3 id="loading-data-from-statsmodels">Loading data from Statsmodels</h3>
<p>Statsmodels allows access to several datasets for use in examples, model testing, tutorials, testing functions etc.  These can be accessed using <code>sm.datasets.macrodata.load_pandas()['data']</code>, where <code>macrodata</code> is just one example of a dataset.  Pressing <code>TAB</code> after <code>sm.datasets</code> should bring up a pick-list of datasets to choose from.  </p>
<p>The commands <code>print(sm.datasets.macrodata.DESCRLONG)</code> and <code>print(sm.datasets.macrodata.NOTE)</code> provide additional details on the datasets.</p>
<pre><code class="language-python"># Load macro economic data from Statsmodels

import statsmodels.api as sm
df = sm.datasets.macrodata.load_pandas()['data']
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>quarter</th>
      <th>realgdp</th>
      <th>realcons</th>
      <th>realinv</th>
      <th>realgovt</th>
      <th>realdpi</th>
      <th>cpi</th>
      <th>m1</th>
      <th>tbilrate</th>
      <th>unemp</th>
      <th>pop</th>
      <th>infl</th>
      <th>realint</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1959.0</td>
      <td>1.0</td>
      <td>2710.349</td>
      <td>1707.4</td>
      <td>286.898</td>
      <td>470.045</td>
      <td>1886.9</td>
      <td>28.980</td>
      <td>139.7</td>
      <td>2.82</td>
      <td>5.8</td>
      <td>177.146</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1959.0</td>
      <td>2.0</td>
      <td>2778.801</td>
      <td>1733.7</td>
      <td>310.859</td>
      <td>481.301</td>
      <td>1919.7</td>
      <td>29.150</td>
      <td>141.7</td>
      <td>3.08</td>
      <td>5.1</td>
      <td>177.830</td>
      <td>2.34</td>
      <td>0.74</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1959.0</td>
      <td>3.0</td>
      <td>2775.488</td>
      <td>1751.8</td>
      <td>289.226</td>
      <td>491.260</td>
      <td>1916.4</td>
      <td>29.350</td>
      <td>140.5</td>
      <td>3.82</td>
      <td>5.3</td>
      <td>178.657</td>
      <td>2.74</td>
      <td>1.09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1959.0</td>
      <td>4.0</td>
      <td>2785.204</td>
      <td>1753.7</td>
      <td>299.356</td>
      <td>484.052</td>
      <td>1931.3</td>
      <td>29.370</td>
      <td>140.0</td>
      <td>4.33</td>
      <td>5.6</td>
      <td>179.386</td>
      <td>0.27</td>
      <td>4.06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1960.0</td>
      <td>1.0</td>
      <td>2847.699</td>
      <td>1770.5</td>
      <td>331.722</td>
      <td>462.199</td>
      <td>1955.5</td>
      <td>29.540</td>
      <td>139.6</td>
      <td>3.50</td>
      <td>5.2</td>
      <td>180.007</td>
      <td>2.31</td>
      <td>1.19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>198</th>
      <td>2008.0</td>
      <td>3.0</td>
      <td>13324.600</td>
      <td>9267.7</td>
      <td>1990.693</td>
      <td>991.551</td>
      <td>9838.3</td>
      <td>216.889</td>
      <td>1474.7</td>
      <td>1.17</td>
      <td>6.0</td>
      <td>305.270</td>
      <td>-3.16</td>
      <td>4.33</td>
    </tr>
    <tr>
      <th>199</th>
      <td>2008.0</td>
      <td>4.0</td>
      <td>13141.920</td>
      <td>9195.3</td>
      <td>1857.661</td>
      <td>1007.273</td>
      <td>9920.4</td>
      <td>212.174</td>
      <td>1576.5</td>
      <td>0.12</td>
      <td>6.9</td>
      <td>305.952</td>
      <td>-8.79</td>
      <td>8.91</td>
    </tr>
    <tr>
      <th>200</th>
      <td>2009.0</td>
      <td>1.0</td>
      <td>12925.410</td>
      <td>9209.2</td>
      <td>1558.494</td>
      <td>996.287</td>
      <td>9926.4</td>
      <td>212.671</td>
      <td>1592.8</td>
      <td>0.22</td>
      <td>8.1</td>
      <td>306.547</td>
      <td>0.94</td>
      <td>-0.71</td>
    </tr>
    <tr>
      <th>201</th>
      <td>2009.0</td>
      <td>2.0</td>
      <td>12901.504</td>
      <td>9189.0</td>
      <td>1456.678</td>
      <td>1023.528</td>
      <td>10077.5</td>
      <td>214.469</td>
      <td>1653.6</td>
      <td>0.18</td>
      <td>9.2</td>
      <td>307.226</td>
      <td>3.37</td>
      <td>-3.19</td>
    </tr>
    <tr>
      <th>202</th>
      <td>2009.0</td>
      <td>3.0</td>
      <td>12990.341</td>
      <td>9256.0</td>
      <td>1486.398</td>
      <td>1044.088</td>
      <td>10040.6</td>
      <td>216.385</td>
      <td>1673.9</td>
      <td>0.12</td>
      <td>9.6</td>
      <td>308.013</td>
      <td>3.56</td>
      <td>-3.44</td>
    </tr>
  </tbody>
</table>
<p>203 rows × 14 columns</p>
</div>

<pre><code class="language-python"># Print the description of the data

print(sm.datasets.macrodata.DESCRLONG)
</code></pre>
<pre><code>US Macroeconomic Data for 1959Q1 - 2009Q3
</code></pre>
<pre><code class="language-python"># Print the data-dictionary for the different columns/fields in the data 

print(sm.datasets.macrodata.NOTE)
</code></pre>
<pre><code>::
    Number of Observations - 203

    Number of Variables - 14

    Variable name definitions::

        year      - 1959q1 - 2009q3
        quarter   - 1-4
        realgdp   - Real gross domestic product (Bil. of chained 2005 US$,
                    seasonally adjusted annual rate)
        realcons  - Real personal consumption expenditures (Bil. of chained
                    2005 US$, seasonally adjusted annual rate)
        realinv   - Real gross private domestic investment (Bil. of chained
                    2005 US$, seasonally adjusted annual rate)
        realgovt  - Real federal consumption expenditures &amp; gross investment
                    (Bil. of chained 2005 US$, seasonally adjusted annual rate)
        realdpi   - Real private disposable income (Bil. of chained 2005
                    US$, seasonally adjusted annual rate)
        cpi       - End of the quarter consumer price index for all urban
                    consumers: all items (1982-84 = 100, seasonally adjusted).
        m1        - End of the quarter M1 nominal money stock (Seasonally
                    adjusted)
        tbilrate  - Quarterly monthly average of the monthly 3-month
                    treasury bill: secondary market rate
        unemp     - Seasonally adjusted unemployment rate (%)
        pop       - End of the quarter total population: all ages incl. armed
                    forces over seas
        infl      - Inflation rate (ln(cpi_{t}/cpi_{t-1}) * 400)
        realint   - Real interest rate (tbilrate - infl)
</code></pre>
<hr />
<h3 id="importing-r-datasets-using-statsmodels">Importing R datasets using Statsmodels</h3>
<p>Datasets available in R can also be imported using the command <code>sm.datasets.get_rdataset('mtcars').data</code>, where <code>mtcards</code> can be replaced by the appropriate dataset name.</p>
<pre><code class="language-python"># Import the mtcars dataset which contains attributes for 32 models of cars

mtcars = sm.datasets.get_rdataset('mtcars').data
</code></pre>
<pre><code class="language-python">mtcars.to_excel('mtcars.xlsx')
</code></pre>
<pre><code class="language-python">mtcars.describe()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.000000</td>
      <td>32.0000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>20.090625</td>
      <td>6.187500</td>
      <td>230.721875</td>
      <td>146.687500</td>
      <td>3.596563</td>
      <td>3.217250</td>
      <td>17.848750</td>
      <td>0.437500</td>
      <td>0.406250</td>
      <td>3.687500</td>
      <td>2.8125</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.026948</td>
      <td>1.785922</td>
      <td>123.938694</td>
      <td>68.562868</td>
      <td>0.534679</td>
      <td>0.978457</td>
      <td>1.786943</td>
      <td>0.504016</td>
      <td>0.498991</td>
      <td>0.737804</td>
      <td>1.6152</td>
    </tr>
    <tr>
      <th>min</th>
      <td>10.400000</td>
      <td>4.000000</td>
      <td>71.100000</td>
      <td>52.000000</td>
      <td>2.760000</td>
      <td>1.513000</td>
      <td>14.500000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.0000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>15.425000</td>
      <td>4.000000</td>
      <td>120.825000</td>
      <td>96.500000</td>
      <td>3.080000</td>
      <td>2.581250</td>
      <td>16.892500</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>2.0000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>19.200000</td>
      <td>6.000000</td>
      <td>196.300000</td>
      <td>123.000000</td>
      <td>3.695000</td>
      <td>3.325000</td>
      <td>17.710000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>2.0000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>22.800000</td>
      <td>8.000000</td>
      <td>326.000000</td>
      <td>180.000000</td>
      <td>3.920000</td>
      <td>3.610000</td>
      <td>18.900000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>4.0000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>33.900000</td>
      <td>8.000000</td>
      <td>472.000000</td>
      <td>335.000000</td>
      <td>4.930000</td>
      <td>5.424000</td>
      <td>22.900000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>5.000000</td>
      <td>8.0000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Load the famous Iris dataset 
iris = sm.datasets.get_rdataset('iris').data
</code></pre>
<pre><code class="language-python">iris
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sepal.Length</th>
      <th>Sepal.Width</th>
      <th>Petal.Length</th>
      <th>Petal.Width</th>
      <th>Species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div>

<hr />
<h3 id="datasets-in-seaborn">Datasets in Seaborn</h3>
<p>Several datasets are accessible through the Seaborn library</p>
<pre><code class="language-python"># Get the names of all the datasets that are available through Seaborn

import seaborn as sns
sns.get_dataset_names()
</code></pre>
<pre><code>['anagrams',
 'anscombe',
 'attention',
 'brain_networks',
 'car_crashes',
 'diamonds',
 'dots',
 'dowjones',
 'exercise',
 'flights',
 'fmri',
 'geyser',
 'glue',
 'healthexp',
 'iris',
 'mpg',
 'penguins',
 'planets',
 'seaice',
 'taxis',
 'tips',
 'titanic']
</code></pre>
<pre><code class="language-python"># Load the diamonds dataset

diamonds = sns.load_dataset('diamonds')
</code></pre>
<pre><code class="language-python">diamonds.head(20)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.24</td>
      <td>Very Good</td>
      <td>J</td>
      <td>VVS2</td>
      <td>62.8</td>
      <td>57.0</td>
      <td>336</td>
      <td>3.94</td>
      <td>3.96</td>
      <td>2.48</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.24</td>
      <td>Very Good</td>
      <td>I</td>
      <td>VVS1</td>
      <td>62.3</td>
      <td>57.0</td>
      <td>336</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.47</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.26</td>
      <td>Very Good</td>
      <td>H</td>
      <td>SI1</td>
      <td>61.9</td>
      <td>55.0</td>
      <td>337</td>
      <td>4.07</td>
      <td>4.11</td>
      <td>2.53</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.22</td>
      <td>Fair</td>
      <td>E</td>
      <td>VS2</td>
      <td>65.1</td>
      <td>61.0</td>
      <td>337</td>
      <td>3.87</td>
      <td>3.78</td>
      <td>2.49</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.23</td>
      <td>Very Good</td>
      <td>H</td>
      <td>VS1</td>
      <td>59.4</td>
      <td>61.0</td>
      <td>338</td>
      <td>4.00</td>
      <td>4.05</td>
      <td>2.39</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.30</td>
      <td>Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>64.0</td>
      <td>55.0</td>
      <td>339</td>
      <td>4.25</td>
      <td>4.28</td>
      <td>2.73</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>J</td>
      <td>VS1</td>
      <td>62.8</td>
      <td>56.0</td>
      <td>340</td>
      <td>3.93</td>
      <td>3.90</td>
      <td>2.46</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.22</td>
      <td>Premium</td>
      <td>F</td>
      <td>SI1</td>
      <td>60.4</td>
      <td>61.0</td>
      <td>342</td>
      <td>3.88</td>
      <td>3.84</td>
      <td>2.33</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.31</td>
      <td>Ideal</td>
      <td>J</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>54.0</td>
      <td>344</td>
      <td>4.35</td>
      <td>4.37</td>
      <td>2.71</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.20</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI2</td>
      <td>60.2</td>
      <td>62.0</td>
      <td>345</td>
      <td>3.79</td>
      <td>3.75</td>
      <td>2.27</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.32</td>
      <td>Premium</td>
      <td>E</td>
      <td>I1</td>
      <td>60.9</td>
      <td>58.0</td>
      <td>345</td>
      <td>4.38</td>
      <td>4.42</td>
      <td>2.68</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.30</td>
      <td>Ideal</td>
      <td>I</td>
      <td>SI2</td>
      <td>62.0</td>
      <td>54.0</td>
      <td>348</td>
      <td>4.31</td>
      <td>4.34</td>
      <td>2.68</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.30</td>
      <td>Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>63.4</td>
      <td>54.0</td>
      <td>351</td>
      <td>4.23</td>
      <td>4.29</td>
      <td>2.70</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.30</td>
      <td>Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>63.8</td>
      <td>56.0</td>
      <td>351</td>
      <td>4.23</td>
      <td>4.26</td>
      <td>2.71</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.30</td>
      <td>Very Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>62.7</td>
      <td>59.0</td>
      <td>351</td>
      <td>4.21</td>
      <td>4.27</td>
      <td>2.66</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Load the mpg dataset from Seaborn.  This is similar to the mtcars dataset,
# but has a higher count of observations.

sns.load_dataset('mpg')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>model_year</th>
      <th>origin</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504</td>
      <td>12.0</td>
      <td>70</td>
      <td>usa</td>
      <td>chevrolet chevelle malibu</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693</td>
      <td>11.5</td>
      <td>70</td>
      <td>usa</td>
      <td>buick skylark 320</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436</td>
      <td>11.0</td>
      <td>70</td>
      <td>usa</td>
      <td>plymouth satellite</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>3433</td>
      <td>12.0</td>
      <td>70</td>
      <td>usa</td>
      <td>amc rebel sst</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>3449</td>
      <td>10.5</td>
      <td>70</td>
      <td>usa</td>
      <td>ford torino</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>393</th>
      <td>27.0</td>
      <td>4</td>
      <td>140.0</td>
      <td>86.0</td>
      <td>2790</td>
      <td>15.6</td>
      <td>82</td>
      <td>usa</td>
      <td>ford mustang gl</td>
    </tr>
    <tr>
      <th>394</th>
      <td>44.0</td>
      <td>4</td>
      <td>97.0</td>
      <td>52.0</td>
      <td>2130</td>
      <td>24.6</td>
      <td>82</td>
      <td>europe</td>
      <td>vw pickup</td>
    </tr>
    <tr>
      <th>395</th>
      <td>32.0</td>
      <td>4</td>
      <td>135.0</td>
      <td>84.0</td>
      <td>2295</td>
      <td>11.6</td>
      <td>82</td>
      <td>usa</td>
      <td>dodge rampage</td>
    </tr>
    <tr>
      <th>396</th>
      <td>28.0</td>
      <td>4</td>
      <td>120.0</td>
      <td>79.0</td>
      <td>2625</td>
      <td>18.6</td>
      <td>82</td>
      <td>usa</td>
      <td>ford ranger</td>
    </tr>
    <tr>
      <th>397</th>
      <td>31.0</td>
      <td>4</td>
      <td>119.0</td>
      <td>82.0</td>
      <td>2720</td>
      <td>19.4</td>
      <td>82</td>
      <td>usa</td>
      <td>chevy s-10</td>
    </tr>
  </tbody>
</table>
<p>398 rows × 9 columns</p>
</div>

<pre><code class="language-python"># Look at how many cars from each country in the mpg dataset

sns.load_dataset('mpg').origin.value_counts()
</code></pre>
<pre><code>usa       249
japan      79
europe     70
Name: origin, dtype: int64
</code></pre>
<pre><code class="language-python"># Build a histogram of the model year

sns.load_dataset('mpg').model_year.astype('category').hist();
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_140_0.png" /></p>
<pre><code class="language-python"># Create a random dataframe with random data
n = 25
df = pd.DataFrame(
    {'state': list(np.random.choice([&quot;New York&quot;, &quot;Florida&quot;, &quot;California&quot;], size=(n))), 
     'gender': list(np.random.choice([&quot;Male&quot;, &quot;Female&quot;], size=(n), p=[.4, .6])),
     'education': list(np.random.choice([&quot;High School&quot;, &quot;Undergrad&quot;, &quot;Grad&quot;], size=(n))),
     'housing': list(np.random.choice([&quot;Rent&quot;, &quot;Own&quot;], size=(n))),     
     'height': list(np.random.randint(140,200,n)),
     'weight': list(np.random.randint(100,150,n)),
     'income': list(np.random.randint(50,250,n)),
     'computers': list(np.random.randint(0,6,n))
    })
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>education</th>
      <th>housing</th>
      <th>height</th>
      <th>weight</th>
      <th>income</th>
      <th>computers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>California</td>
      <td>Female</td>
      <td>High School</td>
      <td>Own</td>
      <td>190</td>
      <td>119</td>
      <td>111</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>California</td>
      <td>Female</td>
      <td>High School</td>
      <td>Own</td>
      <td>140</td>
      <td>126</td>
      <td>232</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>Female</td>
      <td>High School</td>
      <td>Rent</td>
      <td>169</td>
      <td>123</td>
      <td>111</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>Female</td>
      <td>High School</td>
      <td>Own</td>
      <td>152</td>
      <td>147</td>
      <td>123</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>197</td>
      <td>111</td>
      <td>206</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>New York</td>
      <td>Male</td>
      <td>Grad</td>
      <td>Own</td>
      <td>187</td>
      <td>144</td>
      <td>87</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>California</td>
      <td>Female</td>
      <td>High School</td>
      <td>Own</td>
      <td>189</td>
      <td>115</td>
      <td>75</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>197</td>
      <td>117</td>
      <td>195</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Own</td>
      <td>146</td>
      <td>127</td>
      <td>244</td>
      <td>5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>194</td>
      <td>106</td>
      <td>138</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>181</td>
      <td>101</td>
      <td>206</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>California</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>156</td>
      <td>121</td>
      <td>243</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Grad</td>
      <td>Own</td>
      <td>184</td>
      <td>143</td>
      <td>129</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>New York</td>
      <td>Male</td>
      <td>Grad</td>
      <td>Own</td>
      <td>168</td>
      <td>106</td>
      <td>176</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>141</td>
      <td>112</td>
      <td>225</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>171</td>
      <td>105</td>
      <td>66</td>
      <td>5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Rent</td>
      <td>155</td>
      <td>126</td>
      <td>233</td>
      <td>5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>California</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>193</td>
      <td>106</td>
      <td>162</td>
      <td>4</td>
    </tr>
    <tr>
      <th>18</th>
      <td>New York</td>
      <td>Male</td>
      <td>High School</td>
      <td>Rent</td>
      <td>179</td>
      <td>107</td>
      <td>187</td>
      <td>5</td>
    </tr>
    <tr>
      <th>19</th>
      <td>California</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>186</td>
      <td>125</td>
      <td>79</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>California</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Own</td>
      <td>157</td>
      <td>102</td>
      <td>183</td>
      <td>4</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>174</td>
      <td>109</td>
      <td>94</td>
      <td>5</td>
    </tr>
    <tr>
      <th>22</th>
      <td>New York</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Own</td>
      <td>162</td>
      <td>107</td>
      <td>140</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>New York</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Rent</td>
      <td>198</td>
      <td>142</td>
      <td>193</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Florida</td>
      <td>Male</td>
      <td>High School</td>
      <td>Rent</td>
      <td>174</td>
      <td>115</td>
      <td>55</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Load the 'Old Faithful' eruption data

sns.load_dataset('geyser')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration</th>
      <th>waiting</th>
      <th>kind</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.600</td>
      <td>79</td>
      <td>long</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.800</td>
      <td>54</td>
      <td>short</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.333</td>
      <td>74</td>
      <td>long</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.283</td>
      <td>62</td>
      <td>short</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.533</td>
      <td>85</td>
      <td>long</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>267</th>
      <td>4.117</td>
      <td>81</td>
      <td>long</td>
    </tr>
    <tr>
      <th>268</th>
      <td>2.150</td>
      <td>46</td>
      <td>short</td>
    </tr>
    <tr>
      <th>269</th>
      <td>4.417</td>
      <td>90</td>
      <td>long</td>
    </tr>
    <tr>
      <th>270</th>
      <td>1.817</td>
      <td>46</td>
      <td>short</td>
    </tr>
    <tr>
      <th>271</th>
      <td>4.467</td>
      <td>74</td>
      <td>long</td>
    </tr>
  </tbody>
</table>
<p>272 rows × 3 columns</p>
</div>

<hr />
<h3 id="datasets-in-sklearn">Datasets in sklearn</h3>
<p>Scikit Learn has several datasets that are built-in as well that can be used to experiment with functions and algorithms.  Some are listed below:</p>
<p><code>load_boston(*[, return_X_y])</code> Load and return the boston house-prices dataset (regression).<br />
<code>load_iris(*[, return_X_y, as_frame])</code> Load and return the iris dataset (classification).<br />
<code>load_diabetes(*[, return_X_y, as_frame])</code> Load and return the diabetes dataset (regression). <br />
<code>load_digits(*[, n_class, return_X_y, as_frame])</code> Load and return the digits dataset (classification).<br />
<code>load_linnerud(*[, return_X_y, as_frame])</code> Load and return the physical excercise linnerud dataset.<br />
<code>load_wine(*[, return_X_y, as_frame])</code> Load and return the wine dataset (classification).<br />
<code>load_breast_cancer(*[, return_X_y, as_frame])</code> Load and return the breast cancer wisconsin dataset (classification).  </p>
<p>Let us import the <em>wine dataset</em> next, and the <em>California housing datset</em> after that.  </p>
<pre><code class="language-python">from sklearn import datasets

X = datasets.load_wine()['data']
y = datasets.load_wine()['target']
features = datasets.load_wine()['feature_names']
DESCR = datasets.load_wine()['DESCR']
classes = datasets.load_wine()['target_names']


wine_df = pd.DataFrame(X, columns = features)
wine_df.insert(0,'WineType', y)

# X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20)
</code></pre>
<pre><code class="language-python">df = wine_df[(wine_df['WineType'] != 2)]

</code></pre>
<pre><code class="language-python"># Let us look at the DESCR for the dataframe we just loaded

print(DESCR)
</code></pre>
<pre><code>.. _wine_dataset:

Wine recognition dataset
------------------------

**Data Set Characteristics:**

    :Number of Instances: 178
    :Number of Attributes: 13 numeric, predictive attributes and the class
    :Attribute Information:
        - Alcohol
        - Malic acid
        - Ash
        - Alcalinity of ash  
        - Magnesium
        - Total phenols
        - Flavanoids
        - Nonflavanoid phenols
        - Proanthocyanins
        - Color intensity
        - Hue
        - OD280/OD315 of diluted wines
        - Proline

    - class:
            - class_0
            - class_1
            - class_2

    :Summary Statistics:

    ============================= ==== ===== ======= =====
                                   Min   Max   Mean     SD
    ============================= ==== ===== ======= =====
    Alcohol:                      11.0  14.8    13.0   0.8
    Malic Acid:                   0.74  5.80    2.34  1.12
    Ash:                          1.36  3.23    2.36  0.27
    Alcalinity of Ash:            10.6  30.0    19.5   3.3
    Magnesium:                    70.0 162.0    99.7  14.3
    Total Phenols:                0.98  3.88    2.29  0.63
    Flavanoids:                   0.34  5.08    2.03  1.00
    Nonflavanoid Phenols:         0.13  0.66    0.36  0.12
    Proanthocyanins:              0.41  3.58    1.59  0.57
    Colour Intensity:              1.3  13.0     5.1   2.3
    Hue:                          0.48  1.71    0.96  0.23
    OD280/OD315 of diluted wines: 1.27  4.00    2.61  0.71
    Proline:                       278  1680     746   315
    ============================= ==== ===== ======= =====

    :Missing Attribute Values: None
    :Class Distribution: class_0 (59), class_1 (71), class_2 (48)
    :Creator: R.A. Fisher
    :Donor: Michael Marshall (MARSHALL%PLU@io.arc.nasa.gov)
    :Date: July, 1988

This is a copy of UCI ML Wine recognition datasets.
https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data

The data is the results of a chemical analysis of wines grown in the same
region in Italy by three different cultivators. There are thirteen different
measurements taken for different constituents found in the three types of
wine.

Original Owners:

Forina, M. et al, PARVUS - 
An Extendible Package for Data Exploration, Classification and Correlation. 
Institute of Pharmaceutical and Food Analysis and Technologies,
Via Brigata Salerno, 16147 Genoa, Italy.

Citation:

Lichman, M. (2013). UCI Machine Learning Repository
[https://archive.ics.uci.edu/ml]. Irvine, CA: University of California,
School of Information and Computer Science.

.. topic:: References

  (1) S. Aeberhard, D. Coomans and O. de Vel, 
  Comparison of Classifiers in High Dimensional Settings, 
  Tech. Rep. no. 92-02, (1992), Dept. of Computer Science and Dept. of  
  Mathematics and Statistics, James Cook University of North Queensland. 
  (Also submitted to Technometrics).

  The data was used with many others for comparing various 
  classifiers. The classes are separable, though only RDA 
  has achieved 100% correct classification. 
  (RDA : 100%, QDA 99.4%, LDA 98.9%, 1NN 96.1% (z-transformed data)) 
  (All results using the leave-one-out technique)

  (2) S. Aeberhard, D. Coomans and O. de Vel, 
  "THE CLASSIFICATION PERFORMANCE OF RDA" 
  Tech. Rep. no. 92-01, (1992), Dept. of Computer Science and Dept. of 
  Mathematics and Statistics, James Cook University of North Queensland. 
  (Also submitted to Journal of Chemometrics).
</code></pre>
<pre><code class="language-python"># California housing dataset. medv is the median value of the homes

from sklearn import datasets

X = datasets.fetch_california_housing()['data']
y = datasets.fetch_california_housing()['target']
features = datasets.fetch_california_housing()['feature_names']
DESCR = datasets.fetch_california_housing()['DESCR']

cali_df = pd.DataFrame(X, columns = features)
cali_df.insert(0,'medv', y)
cali_df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>medv</th>
      <th>MedInc</th>
      <th>HouseAge</th>
      <th>AveRooms</th>
      <th>AveBedrms</th>
      <th>Population</th>
      <th>AveOccup</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.526</td>
      <td>8.3252</td>
      <td>41.0</td>
      <td>6.984127</td>
      <td>1.023810</td>
      <td>322.0</td>
      <td>2.555556</td>
      <td>37.88</td>
      <td>-122.23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.585</td>
      <td>8.3014</td>
      <td>21.0</td>
      <td>6.238137</td>
      <td>0.971880</td>
      <td>2401.0</td>
      <td>2.109842</td>
      <td>37.86</td>
      <td>-122.22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.521</td>
      <td>7.2574</td>
      <td>52.0</td>
      <td>8.288136</td>
      <td>1.073446</td>
      <td>496.0</td>
      <td>2.802260</td>
      <td>37.85</td>
      <td>-122.24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.413</td>
      <td>5.6431</td>
      <td>52.0</td>
      <td>5.817352</td>
      <td>1.073059</td>
      <td>558.0</td>
      <td>2.547945</td>
      <td>37.85</td>
      <td>-122.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.422</td>
      <td>3.8462</td>
      <td>52.0</td>
      <td>6.281853</td>
      <td>1.081081</td>
      <td>565.0</td>
      <td>2.181467</td>
      <td>37.85</td>
      <td>-122.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20635</th>
      <td>0.781</td>
      <td>1.5603</td>
      <td>25.0</td>
      <td>5.045455</td>
      <td>1.133333</td>
      <td>845.0</td>
      <td>2.560606</td>
      <td>39.48</td>
      <td>-121.09</td>
    </tr>
    <tr>
      <th>20636</th>
      <td>0.771</td>
      <td>2.5568</td>
      <td>18.0</td>
      <td>6.114035</td>
      <td>1.315789</td>
      <td>356.0</td>
      <td>3.122807</td>
      <td>39.49</td>
      <td>-121.21</td>
    </tr>
    <tr>
      <th>20637</th>
      <td>0.923</td>
      <td>1.7000</td>
      <td>17.0</td>
      <td>5.205543</td>
      <td>1.120092</td>
      <td>1007.0</td>
      <td>2.325635</td>
      <td>39.43</td>
      <td>-121.22</td>
    </tr>
    <tr>
      <th>20638</th>
      <td>0.847</td>
      <td>1.8672</td>
      <td>18.0</td>
      <td>5.329513</td>
      <td>1.171920</td>
      <td>741.0</td>
      <td>2.123209</td>
      <td>39.43</td>
      <td>-121.32</td>
    </tr>
    <tr>
      <th>20639</th>
      <td>0.894</td>
      <td>2.3886</td>
      <td>16.0</td>
      <td>5.254717</td>
      <td>1.162264</td>
      <td>1387.0</td>
      <td>2.616981</td>
      <td>39.37</td>
      <td>-121.24</td>
    </tr>
  </tbody>
</table>
<p>20640 rows × 9 columns</p>
</div>

<pre><code class="language-python"># Again, we can look at what the various columns mean

print(DESCR)
</code></pre>
<pre><code>.. _california_housing_dataset:

California Housing dataset
--------------------------

**Data Set Characteristics:**

    :Number of Instances: 20640

    :Number of Attributes: 8 numeric, predictive attributes and the target

    :Attribute Information:
        - MedInc        median income in block group
        - HouseAge      median house age in block group
        - AveRooms      average number of rooms per household
        - AveBedrms     average number of bedrooms per household
        - Population    block group population
        - AveOccup      average number of household members
        - Latitude      block group latitude
        - Longitude     block group longitude

    :Missing Attribute Values: None

This dataset was obtained from the StatLib repository.
https://www.dcc.fc.up.pt/~ltorgo/Regression/cal_housing.html

The target variable is the median house value for California districts,
expressed in hundreds of thousands of dollars ($100,000).

This dataset was derived from the 1990 U.S. census, using one row per census
block group. A block group is the smallest geographical unit for which the U.S.
Census Bureau publishes sample data (a block group typically has a population
of 600 to 3,000 people).

An household is a group of people residing within a home. Since the average
number of rooms and bedrooms in this dataset are provided per household, these
columns may take surpinsingly large values for block groups with few households
and many empty houses, such as vacation resorts.

It can be downloaded/loaded using the
:func:`sklearn.datasets.fetch_california_housing` function.

.. topic:: References

    - Pace, R. Kelley and Ronald Barry, Sparse Spatial Autoregressions,
      Statistics and Probability Letters, 33 (1997) 291-297
</code></pre>
<hr />
<h3 id="create-artificial-data-using-sklearn">Create Artificial Data using sklearn</h3>
<p>In addition to the built-in datasets, it is possible to create artificial data of arbitrary size to test or explain different algorithms for solving classification (both binary and multi-class) as well as regression problems.</p>
<p>One example using the <code>make_blobs</code> function is provided below, but a great deal more detail is available at https://scikit-learn.org/stable/datasets/sample_generators.html#sample-generators</p>
<p><code>make_blobs</code> and <code>make_classification</code> can create multiclass datasets, and <code>make_regression</code> can be used for creating datasets with specified characteristics.  Refer to the sklearn documentation link above to learn more.</p>
<pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.datasets import make_blobs
X, y, centers = make_blobs(n_samples=1000, centers=3, n_features=2,
                      random_state=0, return_centers=True, center_box=(0,20),
                          cluster_std = 1.1)
</code></pre>
<pre><code class="language-python">df = pd.DataFrame(dict(x1=X[:,0], x2=X[:,1], label=y))
df = round(df,ndigits=2)
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9.26</td>
      <td>12.64</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.02</td>
      <td>14.14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.50</td>
      <td>13.12</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.93</td>
      <td>12.87</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.37</td>
      <td>11.82</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>11.94</td>
      <td>10.92</td>
      <td>1</td>
    </tr>
    <tr>
      <th>996</th>
      <td>9.40</td>
      <td>12.17</td>
      <td>2</td>
    </tr>
    <tr>
      <th>997</th>
      <td>10.25</td>
      <td>10.45</td>
      <td>1</td>
    </tr>
    <tr>
      <th>998</th>
      <td>7.37</td>
      <td>12.01</td>
      <td>2</td>
    </tr>
    <tr>
      <th>999</th>
      <td>11.01</td>
      <td>11.17</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 3 columns</p>
</div>

<pre><code class="language-python">plt.figure(figsize=(6,6))
sns.scatterplot(data = df, x = 'x1', y = 'x2', hue = 'label', 
                alpha = .8, palette=&quot;deep&quot;,edgecolor = 'None');
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_153_0.png" /></p>
<hr />
<h2 id="exploratory-data-analysis-using-python">Exploratory Data Analysis using Python</h2>
<p>After all of this lengthy introduction, we are finally ready to get started with actually performing some EDA.</p>
<p>As mentioned earlier, EDA is unstructured exploration, there is not a set of set activities you must perform.  Generally, you probe the data, and depending upon what you discover, you ask more questions.</p>
<p>Things we will do:</p>
<ul>
<li>Look at how to read different types of data  </li>
<li>Understand how to access in-built datasets in Python  </li>
<li>Calculate summary statistics covered in the prior class (refer list to the right)  </li>
<li>Perform basic graphing using Pandas to explore the data  </li>
<li>Understand group-by and pivoting functions (the split-apply-combine process)  </li>
<li>Look at pandas-profiling, a library that can perform many data exploration tasks  </li>
</ul>
<p>Pandas is a library we will be using often, and is something we will use to explore data and perform EDA.  We will also use NumPy and SciPy.  </p>
<pre><code class="language-python"># Load the regular libraries
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
</code></pre>
<h3 id="a-note-on-managing-working-directories">A note on managing working directories</h3>
<p>A very basic problem one runs into when trying to load datafiles is the file path - and if the file is not located in the current working directory for Python.  </p>
<p>Generally, reading a CSV file is simple - <code>pd.read_csv</code> and pointing to the filename does the trick.  If the file is there but pandas returns an error, that could be because the file may not be located in your working directory.  In such a case, enter the complete path to the file.  </p>
<p>Alternatively, you can bring the file to your working directory.  To check and change your working directory, use the following code:  </p>
<pre><code class="language-python">import os

# To check current working directory:
os.getcwd()
</code></pre>
<pre><code>'C:\\Users\\user\\Google Drive\\jupyter'
</code></pre>
<p>Or, you could type <code>pwd</code> in a cell.  Be aware that pwd should be on the first line of the cell!</p>
<pre><code class="language-python">pwd
</code></pre>
<pre><code>'C:\\Users\\user\\Google Drive\\jupyter'
</code></pre>
<pre><code class="language-python"># To change working directory

os.chdir(r'C:\Users\user\Google Drive\jupyter')
</code></pre>
<h3 id="eda-on-the-diamonds-dataset">EDA on the diamonds dataset</h3>
<h4 id="questions-we-might-like-answered">Questions we might like answered</h4>
<p>Below is a repeat of what was said in the introduction to this chapter, just to avoid having to go back to check what we are trying to do. When performing EDA, we want to explore data in an unstructured way, and try to get a 'feel' for the data.  The kinds of questions we may want to answer are:  </p>
<ul>
<li>How much data do we have - number of rows in the data?</li>
<li>How many columns, or fields do we have in the dataset?</li>
<li>Data types - which of the columns appear to be numeric, dates or strings?</li>
<li>Names of the columns, and do they tell us anything?</li>
<li>A visual review of a sample of the dataset</li>
<li>Completeness of the dataset, are missing values obvious?  Columns that are largely empty?</li>
<li>Unique values for columns that appear to be categorical, and how many observations of each category?</li>
<li>For numeric columns, the range of values (calculated from min and max values)</li>
<li>Distributions for the different columns, possibly graphed</li>
<li>Correlations between the different columns</li>
</ul>
<h4 id="load-data">Load data</h4>
<p>We will start our exploration with the diamonds dataset.  </p>
<p>The ‘diamonds’ has 50k+ records, each representing a single diamond.  The weight and other attributes are available, and so is the price.</p>
<p>The dataset allows us to experiment with a variety of prediction techniques and algorithms.  Below are the columns in the dataset, and their description.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>price</td>
<td>price in US dollars (\$326--\$18,823)</td>
</tr>
<tr>
<td>carat</td>
<td>weight of the diamond (0.2--5.01)</td>
</tr>
<tr>
<td>cut</td>
<td>quality of the cut (Fair, Good, Very Good, Premium, Ideal)</td>
</tr>
<tr>
<td>color</td>
<td>diamond colour, from J (worst) to D (best)</td>
</tr>
<tr>
<td>clarity</td>
<td>a measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best))</td>
</tr>
<tr>
<td>x</td>
<td>length in mm (0--10.74)</td>
</tr>
<tr>
<td>y</td>
<td>width in mm (0--58.9)</td>
</tr>
<tr>
<td>z</td>
<td>depth in mm (0--31.8)</td>
</tr>
<tr>
<td>depth</td>
<td>total depth percentage = z / mean(x, y) = 2 * z / (x + y) (43--79)</td>
</tr>
<tr>
<td>table</td>
<td>width of top of diamond relative to widest point (43--95)</td>
</tr>
</tbody>
</table>
<pre><code class="language-python"># Load data from seaborn

df = sns.load_dataset('diamonds')
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53935</th>
      <td>0.72</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI1</td>
      <td>60.8</td>
      <td>57.0</td>
      <td>2757</td>
      <td>5.75</td>
      <td>5.76</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>0.72</td>
      <td>Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>63.1</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.75</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>60.0</td>
      <td>2757</td>
      <td>5.66</td>
      <td>5.68</td>
      <td>3.56</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>2757</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>0.75</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.83</td>
      <td>5.87</td>
      <td>3.64</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>

<h4 id="descriptive-stats">Descriptive stats</h4>
<p>Pandas <code>describe()</code> function provides a variety of summary statistics.  Review the table below.  Notice the categorical variables were ignored.  This is because descriptive stats do not make sense for categorical variables.</p>
<pre><code class="language-python"># Let us look at some descriptive statistics for the numerical variables

df.describe()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.797940</td>
      <td>61.749405</td>
      <td>57.457184</td>
      <td>3932.799722</td>
      <td>5.731157</td>
      <td>5.734526</td>
      <td>3.538734</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.474011</td>
      <td>1.432621</td>
      <td>2.234491</td>
      <td>3989.439738</td>
      <td>1.121761</td>
      <td>1.142135</td>
      <td>0.705699</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.200000</td>
      <td>43.000000</td>
      <td>43.000000</td>
      <td>326.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.400000</td>
      <td>61.000000</td>
      <td>56.000000</td>
      <td>950.000000</td>
      <td>4.710000</td>
      <td>4.720000</td>
      <td>2.910000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.700000</td>
      <td>61.800000</td>
      <td>57.000000</td>
      <td>2401.000000</td>
      <td>5.700000</td>
      <td>5.710000</td>
      <td>3.530000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.040000</td>
      <td>62.500000</td>
      <td>59.000000</td>
      <td>5324.250000</td>
      <td>6.540000</td>
      <td>6.540000</td>
      <td>4.040000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.010000</td>
      <td>79.000000</td>
      <td>95.000000</td>
      <td>18823.000000</td>
      <td>10.740000</td>
      <td>58.900000</td>
      <td>31.800000</td>
    </tr>
  </tbody>
</table>
</div>

<p><code>df.info()</code> gives you information on the dataset</p>
<pre><code class="language-python">df.info()
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 53940 entries, 0 to 53939
Data columns (total 10 columns):
 #   Column   Non-Null Count  Dtype   
---  ------   --------------  -----   
 0   carat    53940 non-null  float64 
 1   cut      53940 non-null  category
 2   color    53940 non-null  category
 3   clarity  53940 non-null  category
 4   depth    53940 non-null  float64 
 5   table    53940 non-null  float64 
 6   price    53940 non-null  int64   
 7   x        53940 non-null  float64 
 8   y        53940 non-null  float64 
 9   z        53940 non-null  float64 
dtypes: category(3), float64(6), int64(1)
memory usage: 3.0 MB
</code></pre>
<p>Similarly, <code>df.shape</code> gives you a tuple with the counts of rows and columns.</p>
<p>Trivia:<br />
 - Note there is no <code>()</code> after <code>df.shape</code>, as it is a property. Properties are the 'attributes' of the object that can be set using methods.
 - Methods are like functions, but are inbuilt, and apply to an object.  They are part of the class definition for the object.</p>
<pre><code class="language-python">df.shape
</code></pre>
<pre><code>(53940, 10)
</code></pre>
<p><code>df.columns</code> gives you the names of the columns.</p>
<pre><code class="language-python">df.columns
</code></pre>
<pre><code>Index(['carat', 'cut', 'color', 'clarity', 'depth', 'table', 'price', 'x', 'y',
       'z'],
      dtype='object')
</code></pre>
<p><strong>Exploring individual columns</strong><br />
Pandas provide a large number of functions that allow us to explore several statistics relating to individual variables.</p>
<table>
<thead>
<tr>
<th>Measures</th>
<th>Function (from Pandas, unless otherwise stated)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Central Tendency</strong></td>
<td></td>
</tr>
<tr>
<td>Mean</td>
<td><code>mean()</code></td>
</tr>
<tr>
<td>Geometric Mean</td>
<td><code>gmean()</code> (from scipy.stats)</td>
</tr>
<tr>
<td>Median</td>
<td><code>median()</code></td>
</tr>
<tr>
<td>Mode</td>
<td><code>mode()</code></td>
</tr>
<tr>
<td><strong>Measures of Variability</strong></td>
<td></td>
</tr>
<tr>
<td>Range</td>
<td><code>max()</code> - <code>min()</code></td>
</tr>
<tr>
<td>Variance</td>
<td><code>var()</code></td>
</tr>
<tr>
<td>Standard Deviation</td>
<td><code>std()</code></td>
</tr>
<tr>
<td>Coefficient of Variation</td>
<td><code>std()</code> / <code>mean()</code></td>
</tr>
<tr>
<td><strong>Measures of Association</strong></td>
<td></td>
</tr>
<tr>
<td>Covariance</td>
<td><code>cov()</code></td>
</tr>
<tr>
<td>Correlation</td>
<td><code>corr()</code></td>
</tr>
<tr>
<td><strong>Analyzing Distributions</strong></td>
<td></td>
</tr>
<tr>
<td>Percentiles</td>
<td><code>quantile()</code></td>
</tr>
<tr>
<td>Quartiles</td>
<td><code>quantile()</code></td>
</tr>
<tr>
<td>Z-Scores</td>
<td><code>zscore</code> (from scipy)</td>
</tr>
</tbody>
</table>
<p>We examine many of these in action below.  </p>
<h4 id="functions-for-descriptive-stats">Functions for descriptive stats</h4>
<pre><code class="language-python"># Mean
df.mean(numeric_only=True)
</code></pre>
<pre><code>carat       0.797940
depth      61.749405
table      57.457184
price    3932.799722
x           5.731157
y           5.734526
z           3.538734
dtype: float64
</code></pre>
<pre><code class="language-python"># Median
df.median(numeric_only=True)
</code></pre>
<pre><code>carat       0.70
depth      61.80
table      57.00
price    2401.00
x           5.70
y           5.71
z           3.53
dtype: float64
</code></pre>
<pre><code class="language-python"># Mode
df.mode()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.3</td>
      <td>Ideal</td>
      <td>G</td>
      <td>SI1</td>
      <td>62.0</td>
      <td>56.0</td>
      <td>605</td>
      <td>4.37</td>
      <td>4.34</td>
      <td>2.7</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Min, also max works as well

df.min(numeric_only=True)
</code></pre>
<pre><code>carat      0.2
depth     43.0
table     43.0
price    326.0
x          0.0
y          0.0
z          0.0
dtype: float64
</code></pre>
<pre><code class="language-python"># Variance
df.var(numeric_only=True)
</code></pre>
<pre><code>carat    2.246867e-01
depth    2.052404e+00
table    4.992948e+00
price    1.591563e+07
x        1.258347e+00
y        1.304472e+00
z        4.980109e-01
dtype: float64
</code></pre>
<pre><code class="language-python"># Standard Deviation
df.std(numeric_only=True)
</code></pre>
<pre><code>carat       0.474011
depth       1.432621
table       2.234491
price    3989.439738
x           1.121761
y           1.142135
z           0.705699
dtype: float64
</code></pre>
<h4 id="some-quick-histograms">Some quick histograms</h4>
<p>Histograms allow us to look at the distribution of the data.  The <code>df.colname.hist()</code> function allows us to create quick histograms (or column charts in case of categorical variables).  </p>
<p>Visualization using Matplotlib is covered in a different chapter.  </p>
<pre><code class="language-python"># A quick histogram

df.carat.hist();
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_181_0.png" /></p>
<pre><code class="language-python">df.depth.hist();
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_182_0.png" /></p>
<pre><code class="language-python">df.cut.hist();
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_183_0.png" /></p>
<pre><code class="language-python"># All together
df.hist(figsize=(16,10));
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_184_0.png" /></p>
<h4 id="calculate-range">Calculate range</h4>
<pre><code class="language-python"># Let us calculate the range manually

df.depth.max() - df.depth.min()
</code></pre>
<pre><code>36.0
</code></pre>
<h4 id="covariance-and-correlations">Covariance and correlations</h4>
<pre><code class="language-python"># Let us do the covariance matrix, which is a one-liner with pandas

df.cov()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>carat</th>
      <td>0.224687</td>
      <td>0.019167</td>
      <td>0.192365</td>
      <td>1.742765e+03</td>
      <td>0.518484</td>
      <td>0.515248</td>
      <td>0.318917</td>
    </tr>
    <tr>
      <th>depth</th>
      <td>0.019167</td>
      <td>2.052404</td>
      <td>-0.946840</td>
      <td>-6.085371e+01</td>
      <td>-0.040641</td>
      <td>-0.048009</td>
      <td>0.095968</td>
    </tr>
    <tr>
      <th>table</th>
      <td>0.192365</td>
      <td>-0.946840</td>
      <td>4.992948</td>
      <td>1.133318e+03</td>
      <td>0.489643</td>
      <td>0.468972</td>
      <td>0.237996</td>
    </tr>
    <tr>
      <th>price</th>
      <td>1742.765364</td>
      <td>-60.853712</td>
      <td>1133.318064</td>
      <td>1.591563e+07</td>
      <td>3958.021491</td>
      <td>3943.270810</td>
      <td>2424.712613</td>
    </tr>
    <tr>
      <th>x</th>
      <td>0.518484</td>
      <td>-0.040641</td>
      <td>0.489643</td>
      <td>3.958021e+03</td>
      <td>1.258347</td>
      <td>1.248789</td>
      <td>0.768487</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0.515248</td>
      <td>-0.048009</td>
      <td>0.468972</td>
      <td>3.943271e+03</td>
      <td>1.248789</td>
      <td>1.304472</td>
      <td>0.767320</td>
    </tr>
    <tr>
      <th>z</th>
      <td>0.318917</td>
      <td>0.095968</td>
      <td>0.237996</td>
      <td>2.424713e+03</td>
      <td>0.768487</td>
      <td>0.767320</td>
      <td>0.498011</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Now the correlation matrix - another one-liner

df.corr()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>carat</th>
      <td>1.000000</td>
      <td>0.028224</td>
      <td>0.181618</td>
      <td>0.921591</td>
      <td>0.975094</td>
      <td>0.951722</td>
      <td>0.953387</td>
    </tr>
    <tr>
      <th>depth</th>
      <td>0.028224</td>
      <td>1.000000</td>
      <td>-0.295779</td>
      <td>-0.010647</td>
      <td>-0.025289</td>
      <td>-0.029341</td>
      <td>0.094924</td>
    </tr>
    <tr>
      <th>table</th>
      <td>0.181618</td>
      <td>-0.295779</td>
      <td>1.000000</td>
      <td>0.127134</td>
      <td>0.195344</td>
      <td>0.183760</td>
      <td>0.150929</td>
    </tr>
    <tr>
      <th>price</th>
      <td>0.921591</td>
      <td>-0.010647</td>
      <td>0.127134</td>
      <td>1.000000</td>
      <td>0.884435</td>
      <td>0.865421</td>
      <td>0.861249</td>
    </tr>
    <tr>
      <th>x</th>
      <td>0.975094</td>
      <td>-0.025289</td>
      <td>0.195344</td>
      <td>0.884435</td>
      <td>1.000000</td>
      <td>0.974701</td>
      <td>0.970772</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0.951722</td>
      <td>-0.029341</td>
      <td>0.183760</td>
      <td>0.865421</td>
      <td>0.974701</td>
      <td>1.000000</td>
      <td>0.952006</td>
    </tr>
    <tr>
      <th>z</th>
      <td>0.953387</td>
      <td>0.094924</td>
      <td>0.150929</td>
      <td>0.861249</td>
      <td>0.970772</td>
      <td>0.952006</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># We can also calculate the correlations individually between given variables

df[['carat', 'depth']].corr()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>carat</th>
      <td>1.000000</td>
      <td>0.028224</td>
    </tr>
    <tr>
      <th>depth</th>
      <td>0.028224</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># We can create a heatmap of correlations
</code></pre>
<pre><code class="language-python">plt.figure(figsize = (8,8))
sns.heatmap(df.corr(), annot=True);
plt.show()
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_192_0.png" /></p>
<pre><code class="language-python"># We can calculate phi-k correlations as well
import phik
X = df.phik_matrix()
X
</code></pre>
<pre><code>interval columns not set, guessing: ['carat', 'depth', 'table', 'price', 'x', 'y', 'z']
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>carat</th>
      <td>1.000000</td>
      <td>0.270726</td>
      <td>0.261376</td>
      <td>0.320729</td>
      <td>0.093835</td>
      <td>0.127877</td>
      <td>0.860178</td>
      <td>0.885596</td>
      <td>0.685737</td>
      <td>0.821934</td>
    </tr>
    <tr>
      <th>cut</th>
      <td>0.270726</td>
      <td>1.000000</td>
      <td>0.057308</td>
      <td>0.229186</td>
      <td>0.604758</td>
      <td>0.441720</td>
      <td>0.220674</td>
      <td>0.237591</td>
      <td>0.131938</td>
      <td>0.115199</td>
    </tr>
    <tr>
      <th>color</th>
      <td>0.261376</td>
      <td>0.057308</td>
      <td>1.000000</td>
      <td>0.146758</td>
      <td>0.040634</td>
      <td>0.039959</td>
      <td>0.183244</td>
      <td>0.238246</td>
      <td>0.191040</td>
      <td>0.140158</td>
    </tr>
    <tr>
      <th>clarity</th>
      <td>0.320729</td>
      <td>0.229186</td>
      <td>0.146758</td>
      <td>1.000000</td>
      <td>0.154796</td>
      <td>0.148489</td>
      <td>0.295205</td>
      <td>0.435204</td>
      <td>0.419662</td>
      <td>0.425129</td>
    </tr>
    <tr>
      <th>depth</th>
      <td>0.093835</td>
      <td>0.604758</td>
      <td>0.040634</td>
      <td>0.154796</td>
      <td>1.000000</td>
      <td>0.362929</td>
      <td>0.064652</td>
      <td>0.124055</td>
      <td>0.073533</td>
      <td>0.097474</td>
    </tr>
    <tr>
      <th>table</th>
      <td>0.127877</td>
      <td>0.441720</td>
      <td>0.039959</td>
      <td>0.148489</td>
      <td>0.362929</td>
      <td>1.000000</td>
      <td>0.115604</td>
      <td>0.187285</td>
      <td>0.190942</td>
      <td>0.121229</td>
    </tr>
    <tr>
      <th>price</th>
      <td>0.860178</td>
      <td>0.220674</td>
      <td>0.183244</td>
      <td>0.295205</td>
      <td>0.064652</td>
      <td>0.115604</td>
      <td>1.000000</td>
      <td>0.755270</td>
      <td>0.714089</td>
      <td>0.656248</td>
    </tr>
    <tr>
      <th>x</th>
      <td>0.885596</td>
      <td>0.237591</td>
      <td>0.238246</td>
      <td>0.435204</td>
      <td>0.124055</td>
      <td>0.187285</td>
      <td>0.755270</td>
      <td>1.000000</td>
      <td>0.822881</td>
      <td>0.882911</td>
    </tr>
    <tr>
      <th>y</th>
      <td>0.685737</td>
      <td>0.131938</td>
      <td>0.191040</td>
      <td>0.419662</td>
      <td>0.073533</td>
      <td>0.190942</td>
      <td>0.714089</td>
      <td>0.822881</td>
      <td>1.000000</td>
      <td>0.816241</td>
    </tr>
    <tr>
      <th>z</th>
      <td>0.821934</td>
      <td>0.115199</td>
      <td>0.140158</td>
      <td>0.425129</td>
      <td>0.097474</td>
      <td>0.121229</td>
      <td>0.656248</td>
      <td>0.882911</td>
      <td>0.816241</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">sns.heatmap(X, annot=True);
</code></pre>
<p><img alt="png" src="../02_Exploratory_Data_Analysis_files/02_Exploratory_Data_Analysis_194_0.png" /></p>
<p><strong>Detailed Phi-k correlation report</strong>  </p>
<pre><code class="language-python">from phik import report
phik.report.correlation_report(df)
</code></pre>
<h4 id="quantiles-to-analyze-the-distribution">Quantiles to analyze the distribution</h4>
<pre><code class="language-python"># Calculating quantiles
# Here we calculate the 30th quantile


df.quantile(0.30)
</code></pre>
<pre><code>carat       0.42
depth      61.20
table      56.00
price    1087.00
x           4.82
y           4.83
z           2.98
Name: 0.3, dtype: float64
</code></pre>
<pre><code class="language-python"># Calculating multiple quantiles

df.quantile([.1,.3,.5,.75])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.10</th>
      <td>0.31</td>
      <td>60.0</td>
      <td>55.0</td>
      <td>646.00</td>
      <td>4.36</td>
      <td>4.36</td>
      <td>2.69</td>
    </tr>
    <tr>
      <th>0.30</th>
      <td>0.42</td>
      <td>61.2</td>
      <td>56.0</td>
      <td>1087.00</td>
      <td>4.82</td>
      <td>4.83</td>
      <td>2.98</td>
    </tr>
    <tr>
      <th>0.50</th>
      <td>0.70</td>
      <td>61.8</td>
      <td>57.0</td>
      <td>2401.00</td>
      <td>5.70</td>
      <td>5.71</td>
      <td>3.53</td>
    </tr>
    <tr>
      <th>0.75</th>
      <td>1.04</td>
      <td>62.5</td>
      <td>59.0</td>
      <td>5324.25</td>
      <td>6.54</td>
      <td>6.54</td>
      <td>4.04</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="z-scores">Z-scores</h4>
<pre><code class="language-python"># Z-scores for two of the columns (x - mean(x))/std(x)

from scipy.stats import zscore

zscores = zscore(df[['carat', 'depth']])


# Verify z-scores have mean of 0 and standard deviation of 1:
print('Z-scores: \n', zscores, '\n')

print('Mean is: ', zscores.mean(axis = 0), '\n')

print('Std Deviation is: ', zscores.std(axis = 0), '\n')

</code></pre>
<pre><code>Z-scores: 
           carat     depth
0     -1.198168 -0.174092
1     -1.240361 -1.360738
2     -1.198168 -3.385019
3     -1.071587  0.454133
4     -1.029394  1.082358
...         ...       ...
53935 -0.164427 -0.662711
53936 -0.164427  0.942753
53937 -0.206621  0.733344
53938  0.130927 -0.523105
53939 -0.101137  0.314528

[53940 rows x 2 columns]

Mean is:  carat    2.889982e-14
depth   -3.658830e-15
dtype: float64

Std Deviation is:  carat    1.000009
depth    1.000009
dtype: float64
</code></pre>
<h4 id="dataframe-information">Dataframe information</h4>
<pre><code class="language-python"># Look at some dataframe information

df.info()
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 53940 entries, 0 to 53939
Data columns (total 10 columns):
 #   Column   Non-Null Count  Dtype   
---  ------   --------------  -----   
 0   carat    53940 non-null  float64 
 1   cut      53940 non-null  category
 2   color    53940 non-null  category
 3   clarity  53940 non-null  category
 4   depth    53940 non-null  float64 
 5   table    53940 non-null  float64 
 6   price    53940 non-null  int64   
 7   x        53940 non-null  float64 
 8   y        53940 non-null  float64 
 9   z        53940 non-null  float64 
dtypes: category(3), float64(6), int64(1)
memory usage: 3.0 MB
</code></pre>
<h4 id="names-of-columns">Names of columns</h4>
<pre><code class="language-python"># Column names
df.columns
</code></pre>
<pre><code>Index(['carat', 'cut', 'color', 'clarity', 'depth', 'table', 'price', 'x', 'y',
       'z'],
      dtype='object')
</code></pre>
<h4 id="other-useful-functions">Other useful functions</h4>
<blockquote>
<p>Sort: <code>df.sort_values(['price', 'table'], ascending = [False, True]).head()</code><br />
Unique values: <code>df.cut.unique()</code><br />
Count of unique values: <code>df.cut.nunique()</code><br />
Value Counts: <code>df.cut.value_counts()</code><br />
Take a sample from a dataframe: <code>diamonds.sample(4)</code> (or n=4)<br />
Rename columns: <code>df.rename(columns = {'price':'dollars'}, inplace = True)</code>  </p>
</blockquote>
<h2 id="split-apply-combine"><em>Split-Apply-Combine</em></h2>
<p>The phrase Split-Apply-Combine was made popular by Hadley Wickham, who is the author of the popular dplyr package in R.  His original paper on the topic can be downloaded at https://www.jstatsoft.org/article/download/v040i01/468</p>
<p>Conceptually, it involves:<br />
 - Splitting the data into sub-groups based on some filtering criteria<br />
 - Applying a function to each sub-group and obtaining a result<br />
 - Combining the results into one single dataframe.  </p>
<p>Split-Apply-Combine does not represent three separate steps in data analysis, but a way to think about solving problems by breaking them up into manageable pieces, operate on each piece independently, and put all the pieces back together.  </p>
<p>In Python, the Split-Apply-Combine operations are implemented using different functions such as pivot, pivot_table, crosstab, groupby and possibly others. </p>
<p><em>Ref: http://www.jstatsoft.org/v40/i01/</em></p>
<h3 id="stack">Stack</h3>
<p>Even though <code>stack</code> and <code>unstack</code> do not pivot data, they reshape a data in a fundamental way that deserves a reference alongside the standard split-apply-combine techniques.</p>
<p>What <em>stack</em> does is to completely flatten out a dataframe by bringing all columns down against the index.  The index becomes a multi-level index, and all the columns show up against every single row.  </p>
<p>The result is a pandas series, with as many rows as the rows times columns in the original dataset.</p>
<p>You can then move the index into the columns of a dataframe by doing <code>reset_index()</code>.</p>
<p>Let us first consider a simpler dataframe with just a few entries.  </p>
<p><strong>Example 1</strong>  </p>
<pre><code class="language-python">df = pd.DataFrame([[9, 10], [14, 30]],
                                    index=['cat', 'dog'],
                                    columns=['weight-lbs', 'height-in'])
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>weight-lbs</th>
      <th>height-in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cat</th>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>dog</th>
      <td>14</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df.stack()
</code></pre>
<pre><code>cat  weight-lbs     9
     height-in     10
dog  weight-lbs    14
     height-in     30
dtype: int64
</code></pre>
<pre><code class="language-python"># Convert this to a dataframe
pd.DataFrame(df.stack()).reset_index().rename({'level_0': 'animal', 'level_1':'measure', 0: 'value'}, axis=1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>animal</th>
      <th>measure</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cat</td>
      <td>weight-lbs</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>cat</td>
      <td>height-in</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>dog</td>
      <td>weight-lbs</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>dog</td>
      <td>height-in</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">
</code></pre>
<pre><code class="language-python">type(df.stack())
</code></pre>
<pre><code>pandas.core.series.Series
</code></pre>
<pre><code class="language-python">df.stack().index
</code></pre>
<pre><code>MultiIndex([('cat', 'weight-lbs'),
            ('cat',  'height-in'),
            ('dog', 'weight-lbs'),
            ('dog',  'height-in')],
           )
</code></pre>
<p><strong>Example 2:</strong><br />
Now we look at a larger dataframe.</p>
<pre><code class="language-python">import statsmodels.api as sm
iris = sm.datasets.get_rdataset('iris').data
</code></pre>
<pre><code class="language-python"># Let us look at the original data before we stack it
iris
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sepal.Length</th>
      <th>Sepal.Width</th>
      <th>Petal.Length</th>
      <th>Petal.Width</th>
      <th>Species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145</th>
      <td>6.7</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>146</th>
      <td>6.3</td>
      <td>2.5</td>
      <td>5.0</td>
      <td>1.9</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>147</th>
      <td>6.5</td>
      <td>3.0</td>
      <td>5.2</td>
      <td>2.0</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>6.2</td>
      <td>3.4</td>
      <td>5.4</td>
      <td>2.3</td>
      <td>virginica</td>
    </tr>
    <tr>
      <th>149</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
<p>150 rows × 5 columns</p>
</div>

<pre><code class="language-python">iris.stack()
</code></pre>
<pre><code>0    Sepal.Length          5.1
     Sepal.Width           3.5
     Petal.Length          1.4
     Petal.Width           0.2
     Species            setosa
                       ...    
149  Sepal.Length          5.9
     Sepal.Width           3.0
     Petal.Length          5.1
     Petal.Width           1.8
     Species         virginica
Length: 750, dtype: object
</code></pre>
<p>We had 150 rows and 5 columns in our original dataset, and we would therefore expect to have 150*5 = 750 items in our stacked series.  Which we can verify.</p>
<pre><code class="language-python">iris.shape[0] * iris.shape[1]
</code></pre>
<pre><code>750
</code></pre>
<p><strong>Example 3:</strong><br />
We stack the mtcars dataset.</p>
<pre><code class="language-python">mtcars = sm.datasets.get_rdataset('mtcars').data
</code></pre>
<pre><code class="language-python">mtcars
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>6</td>
      <td>225.0</td>
      <td>105</td>
      <td>2.76</td>
      <td>3.460</td>
      <td>20.22</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>8</td>
      <td>360.0</td>
      <td>245</td>
      <td>3.21</td>
      <td>3.570</td>
      <td>15.84</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>4</td>
      <td>146.7</td>
      <td>62</td>
      <td>3.69</td>
      <td>3.190</td>
      <td>20.00</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Merc 230</th>
      <td>22.8</td>
      <td>4</td>
      <td>140.8</td>
      <td>95</td>
      <td>3.92</td>
      <td>3.150</td>
      <td>22.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Merc 280</th>
      <td>19.2</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.30</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 280C</th>
      <td>17.8</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 450SE</th>
      <td>16.4</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>4.070</td>
      <td>17.40</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Merc 450SL</th>
      <td>17.3</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.730</td>
      <td>17.60</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Merc 450SLC</th>
      <td>15.2</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.780</td>
      <td>18.00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Cadillac Fleetwood</th>
      <td>10.4</td>
      <td>8</td>
      <td>472.0</td>
      <td>205</td>
      <td>2.93</td>
      <td>5.250</td>
      <td>17.98</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Lincoln Continental</th>
      <td>10.4</td>
      <td>8</td>
      <td>460.0</td>
      <td>215</td>
      <td>3.00</td>
      <td>5.424</td>
      <td>17.82</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Chrysler Imperial</th>
      <td>14.7</td>
      <td>8</td>
      <td>440.0</td>
      <td>230</td>
      <td>3.23</td>
      <td>5.345</td>
      <td>17.42</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Fiat 128</th>
      <td>32.4</td>
      <td>4</td>
      <td>78.7</td>
      <td>66</td>
      <td>4.08</td>
      <td>2.200</td>
      <td>19.47</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Honda Civic</th>
      <td>30.4</td>
      <td>4</td>
      <td>75.7</td>
      <td>52</td>
      <td>4.93</td>
      <td>1.615</td>
      <td>18.52</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Toyota Corolla</th>
      <td>33.9</td>
      <td>4</td>
      <td>71.1</td>
      <td>65</td>
      <td>4.22</td>
      <td>1.835</td>
      <td>19.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Toyota Corona</th>
      <td>21.5</td>
      <td>4</td>
      <td>120.1</td>
      <td>97</td>
      <td>3.70</td>
      <td>2.465</td>
      <td>20.01</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Dodge Challenger</th>
      <td>15.5</td>
      <td>8</td>
      <td>318.0</td>
      <td>150</td>
      <td>2.76</td>
      <td>3.520</td>
      <td>16.87</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>AMC Javelin</th>
      <td>15.2</td>
      <td>8</td>
      <td>304.0</td>
      <td>150</td>
      <td>3.15</td>
      <td>3.435</td>
      <td>17.30</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Camaro Z28</th>
      <td>13.3</td>
      <td>8</td>
      <td>350.0</td>
      <td>245</td>
      <td>3.73</td>
      <td>3.840</td>
      <td>15.41</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Pontiac Firebird</th>
      <td>19.2</td>
      <td>8</td>
      <td>400.0</td>
      <td>175</td>
      <td>3.08</td>
      <td>3.845</td>
      <td>17.05</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Fiat X1-9</th>
      <td>27.3</td>
      <td>4</td>
      <td>79.0</td>
      <td>66</td>
      <td>4.08</td>
      <td>1.935</td>
      <td>18.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Porsche 914-2</th>
      <td>26.0</td>
      <td>4</td>
      <td>120.3</td>
      <td>91</td>
      <td>4.43</td>
      <td>2.140</td>
      <td>16.70</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Lotus Europa</th>
      <td>30.4</td>
      <td>4</td>
      <td>95.1</td>
      <td>113</td>
      <td>3.77</td>
      <td>1.513</td>
      <td>16.90</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Ford Pantera L</th>
      <td>15.8</td>
      <td>8</td>
      <td>351.0</td>
      <td>264</td>
      <td>4.22</td>
      <td>3.170</td>
      <td>14.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Ferrari Dino</th>
      <td>19.7</td>
      <td>6</td>
      <td>145.0</td>
      <td>175</td>
      <td>3.62</td>
      <td>2.770</td>
      <td>15.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Maserati Bora</th>
      <td>15.0</td>
      <td>8</td>
      <td>301.0</td>
      <td>335</td>
      <td>3.54</td>
      <td>3.570</td>
      <td>14.60</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Volvo 142E</th>
      <td>21.4</td>
      <td>4</td>
      <td>121.0</td>
      <td>109</td>
      <td>4.11</td>
      <td>2.780</td>
      <td>18.60</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars.stack()
</code></pre>
<pre><code>Mazda RX4   mpg      21.0
            cyl       6.0
            disp    160.0
            hp      110.0
            drat      3.9
                    ...  
Volvo 142E  qsec     18.6
            vs        1.0
            am        1.0
            gear      4.0
            carb      2.0
Length: 352, dtype: float64
</code></pre>
<h3 id="unstack">Unstack</h3>
<p>Unstack is the same as the stack of the transpose of a dataframe.</p>
<p>So you flip the rows and columns of a database, and you then do a stack.</p>
<pre><code class="language-python">mtcars.transpose()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Mazda RX4</th>
      <th>Mazda RX4 Wag</th>
      <th>Datsun 710</th>
      <th>Hornet 4 Drive</th>
      <th>Hornet Sportabout</th>
      <th>Valiant</th>
      <th>Duster 360</th>
      <th>Merc 240D</th>
      <th>Merc 230</th>
      <th>Merc 280</th>
      <th>...</th>
      <th>AMC Javelin</th>
      <th>Camaro Z28</th>
      <th>Pontiac Firebird</th>
      <th>Fiat X1-9</th>
      <th>Porsche 914-2</th>
      <th>Lotus Europa</th>
      <th>Ford Pantera L</th>
      <th>Ferrari Dino</th>
      <th>Maserati Bora</th>
      <th>Volvo 142E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mpg</th>
      <td>21.00</td>
      <td>21.000</td>
      <td>22.80</td>
      <td>21.400</td>
      <td>18.70</td>
      <td>18.10</td>
      <td>14.30</td>
      <td>24.40</td>
      <td>22.80</td>
      <td>19.20</td>
      <td>...</td>
      <td>15.200</td>
      <td>13.30</td>
      <td>19.200</td>
      <td>27.300</td>
      <td>26.00</td>
      <td>30.400</td>
      <td>15.80</td>
      <td>19.70</td>
      <td>15.00</td>
      <td>21.40</td>
    </tr>
    <tr>
      <th>cyl</th>
      <td>6.00</td>
      <td>6.000</td>
      <td>4.00</td>
      <td>6.000</td>
      <td>8.00</td>
      <td>6.00</td>
      <td>8.00</td>
      <td>4.00</td>
      <td>4.00</td>
      <td>6.00</td>
      <td>...</td>
      <td>8.000</td>
      <td>8.00</td>
      <td>8.000</td>
      <td>4.000</td>
      <td>4.00</td>
      <td>4.000</td>
      <td>8.00</td>
      <td>6.00</td>
      <td>8.00</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th>disp</th>
      <td>160.00</td>
      <td>160.000</td>
      <td>108.00</td>
      <td>258.000</td>
      <td>360.00</td>
      <td>225.00</td>
      <td>360.00</td>
      <td>146.70</td>
      <td>140.80</td>
      <td>167.60</td>
      <td>...</td>
      <td>304.000</td>
      <td>350.00</td>
      <td>400.000</td>
      <td>79.000</td>
      <td>120.30</td>
      <td>95.100</td>
      <td>351.00</td>
      <td>145.00</td>
      <td>301.00</td>
      <td>121.00</td>
    </tr>
    <tr>
      <th>hp</th>
      <td>110.00</td>
      <td>110.000</td>
      <td>93.00</td>
      <td>110.000</td>
      <td>175.00</td>
      <td>105.00</td>
      <td>245.00</td>
      <td>62.00</td>
      <td>95.00</td>
      <td>123.00</td>
      <td>...</td>
      <td>150.000</td>
      <td>245.00</td>
      <td>175.000</td>
      <td>66.000</td>
      <td>91.00</td>
      <td>113.000</td>
      <td>264.00</td>
      <td>175.00</td>
      <td>335.00</td>
      <td>109.00</td>
    </tr>
    <tr>
      <th>drat</th>
      <td>3.90</td>
      <td>3.900</td>
      <td>3.85</td>
      <td>3.080</td>
      <td>3.15</td>
      <td>2.76</td>
      <td>3.21</td>
      <td>3.69</td>
      <td>3.92</td>
      <td>3.92</td>
      <td>...</td>
      <td>3.150</td>
      <td>3.73</td>
      <td>3.080</td>
      <td>4.080</td>
      <td>4.43</td>
      <td>3.770</td>
      <td>4.22</td>
      <td>3.62</td>
      <td>3.54</td>
      <td>4.11</td>
    </tr>
    <tr>
      <th>wt</th>
      <td>2.62</td>
      <td>2.875</td>
      <td>2.32</td>
      <td>3.215</td>
      <td>3.44</td>
      <td>3.46</td>
      <td>3.57</td>
      <td>3.19</td>
      <td>3.15</td>
      <td>3.44</td>
      <td>...</td>
      <td>3.435</td>
      <td>3.84</td>
      <td>3.845</td>
      <td>1.935</td>
      <td>2.14</td>
      <td>1.513</td>
      <td>3.17</td>
      <td>2.77</td>
      <td>3.57</td>
      <td>2.78</td>
    </tr>
    <tr>
      <th>qsec</th>
      <td>16.46</td>
      <td>17.020</td>
      <td>18.61</td>
      <td>19.440</td>
      <td>17.02</td>
      <td>20.22</td>
      <td>15.84</td>
      <td>20.00</td>
      <td>22.90</td>
      <td>18.30</td>
      <td>...</td>
      <td>17.300</td>
      <td>15.41</td>
      <td>17.050</td>
      <td>18.900</td>
      <td>16.70</td>
      <td>16.900</td>
      <td>14.50</td>
      <td>15.50</td>
      <td>14.60</td>
      <td>18.60</td>
    </tr>
    <tr>
      <th>vs</th>
      <td>0.00</td>
      <td>0.000</td>
      <td>1.00</td>
      <td>1.000</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>...</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>0.00</td>
      <td>1.000</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>am</th>
      <td>1.00</td>
      <td>1.000</td>
      <td>1.00</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>1.00</td>
      <td>1.000</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>gear</th>
      <td>4.00</td>
      <td>4.000</td>
      <td>4.00</td>
      <td>3.000</td>
      <td>3.00</td>
      <td>3.00</td>
      <td>3.00</td>
      <td>4.00</td>
      <td>4.00</td>
      <td>4.00</td>
      <td>...</td>
      <td>3.000</td>
      <td>3.00</td>
      <td>3.000</td>
      <td>4.000</td>
      <td>5.00</td>
      <td>5.000</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>5.00</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th>carb</th>
      <td>4.00</td>
      <td>4.000</td>
      <td>1.00</td>
      <td>1.000</td>
      <td>2.00</td>
      <td>1.00</td>
      <td>4.00</td>
      <td>2.00</td>
      <td>2.00</td>
      <td>4.00</td>
      <td>...</td>
      <td>2.000</td>
      <td>4.00</td>
      <td>2.000</td>
      <td>1.000</td>
      <td>2.00</td>
      <td>2.000</td>
      <td>4.00</td>
      <td>6.00</td>
      <td>8.00</td>
      <td>2.00</td>
    </tr>
  </tbody>
</table>
<p>11 rows × 32 columns</p>
</div>

<pre><code class="language-python">mtcars.unstack()
</code></pre>
<pre><code>mpg   Mazda RX4            21.0
      Mazda RX4 Wag        21.0
      Datsun 710           22.8
      Hornet 4 Drive       21.4
      Hornet Sportabout    18.7
                           ... 
carb  Lotus Europa          2.0
      Ford Pantera L        4.0
      Ferrari Dino          6.0
      Maserati Bora         8.0
      Volvo 142E            2.0
Length: 352, dtype: float64
</code></pre>
<pre><code class="language-python">mtcars.transpose().stack()
</code></pre>
<pre><code>mpg   Mazda RX4            21.0
      Mazda RX4 Wag        21.0
      Datsun 710           22.8
      Hornet 4 Drive       21.4
      Hornet Sportabout    18.7
                           ... 
carb  Lotus Europa          2.0
      Ford Pantera L        4.0
      Ferrari Dino          6.0
      Maserati Bora         8.0
      Volvo 142E            2.0
Length: 352, dtype: float64
</code></pre>
<pre><code class="language-python"># Check the row count
mtcars.stack().shape
</code></pre>
<pre><code>(352,)
</code></pre>
<pre><code class="language-python"># Expected row count in stack
mtcars.shape[0] * mtcars.shape[1]
</code></pre>
<pre><code>352
</code></pre>
<h3 id="pivot-table">Pivot table</h3>
<p>A powerful way the idea behind <em>split-apply_combine</em> is implemented is through pivot tables.  Pivot tables allow reshaping the data into useful summaries.  Pivot tables are widely used by Excel users, and you will find them used in reports, presentations and analysis of all types.  Pandas offers a great deal of flexibility for creating pivot tables using the pivot_table function.  </p>
<p>The pivot_table function is essentially a copy of the Excel functionality.  </p>
<ul>
<li><code>index</code> - On the left is the index, and you can specify multiple columns there.  Each unique value in that index column will have a separate line.  Under each of these lines, there will be a line for each value of the second column in the index, and so on. </li>
<li><code>columns</code> - On the top are the columns, again in the order in which specified in the parameters to the function.  The first column specified is on the top, and underneath will be all unique values of that column.  This is followed by the next column in the list, and so on.  </li>
<li><code>values</code> - Inside the table itself are values derived from the columns named in the <em>values</em> parameter.  The default for values is the mean of the value columns, but you can change it to other functions using aggfunc.  </li>
<li><code>aggfunc</code> - Next is aggfunc.  You can specify any function from any library that returns a single value.  </li>
</ul>
<p><strong>CAUTION</strong><br />
It is really easy to get pivot tables wrong and get something incomprehensible.  To create a sensible pivot table, it makes sense to:
- have categorical columns in both index and columns.  If you use numerical variables in either, the length of your columns/rows will explode unless the number of unique values is limited.<br />
- have columns in the values parameter that lend themselves to the aggregation function specified.  So if you specify a categorical column for values, and ask pandas to show the mean, you will be setting yourself up for disappointment.  If you are using a categorical column for values, be sure to use an appropriate aggregation function eg <code>count</code>.</p>
<pre><code class="language-python">mtcars.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Some transformations to help understand pivots better
mtcars.cyl = mtcars.cyl.replace({4: 'Four', 6: 'Six', 8: 'Eight'} )
mtcars.am = mtcars.am.replace({1: 'Automatic', 0: 'Manual'} )
</code></pre>
<pre><code class="language-python">mtcars = mtcars.head(8)
mtcars
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>Six</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>Automatic</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>Six</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>Automatic</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>Four</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>Automatic</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>Six</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>Manual</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>Eight</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>Manual</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>Six</td>
      <td>225.0</td>
      <td>105</td>
      <td>2.76</td>
      <td>3.460</td>
      <td>20.22</td>
      <td>1</td>
      <td>Manual</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>Eight</td>
      <td>360.0</td>
      <td>245</td>
      <td>3.21</td>
      <td>3.570</td>
      <td>15.84</td>
      <td>0</td>
      <td>Manual</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>Four</td>
      <td>146.7</td>
      <td>62</td>
      <td>3.69</td>
      <td>3.190</td>
      <td>20.00</td>
      <td>1</td>
      <td>Manual</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars.pivot_table(index = ['gear','cyl'],
                   values = ['wt'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>wt</th>
    </tr>
    <tr>
      <th>gear</th>
      <th>cyl</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>Eight</th>
      <td>3.5050</td>
    </tr>
    <tr>
      <th>Six</th>
      <td>3.3375</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>Four</th>
      <td>2.7550</td>
    </tr>
    <tr>
      <th>Six</th>
      <td>2.7475</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars.pivot_table(index = ['am', 'gear'],
                   columns = ['cyl'],
                   values = ['wt'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">wt</th>
    </tr>
    <tr>
      <th></th>
      <th>cyl</th>
      <th>Eight</th>
      <th>Four</th>
      <th>Six</th>
    </tr>
    <tr>
      <th>am</th>
      <th>gear</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Automatic</th>
      <th>4</th>
      <td>NaN</td>
      <td>2.32</td>
      <td>2.7475</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Manual</th>
      <th>3</th>
      <td>3.505</td>
      <td>NaN</td>
      <td>3.3375</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>3.19</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars.pivot_table(index = ['am', 'gear'],
                  columns = ['cyl'],
                  values = ['wt'],
                  aggfunc = ['mean', 'count', 'median', 'sum'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">mean</th>
      <th colspan="3" halign="left">count</th>
      <th colspan="3" halign="left">median</th>
      <th colspan="3" halign="left">sum</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">wt</th>
    </tr>
    <tr>
      <th></th>
      <th>cyl</th>
      <th>Eight</th>
      <th>Four</th>
      <th>Six</th>
      <th>Eight</th>
      <th>Four</th>
      <th>Six</th>
      <th>Eight</th>
      <th>Four</th>
      <th>Six</th>
      <th>Eight</th>
      <th>Four</th>
      <th>Six</th>
    </tr>
    <tr>
      <th>am</th>
      <th>gear</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Automatic</th>
      <th>4</th>
      <td>NaN</td>
      <td>2.32</td>
      <td>2.7475</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.32</td>
      <td>2.7475</td>
      <td>NaN</td>
      <td>2.32</td>
      <td>5.495</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Manual</th>
      <th>3</th>
      <td>3.505</td>
      <td>NaN</td>
      <td>3.3375</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.505</td>
      <td>NaN</td>
      <td>3.3375</td>
      <td>7.01</td>
      <td>NaN</td>
      <td>6.675</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>3.19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.19</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">diamonds = sns.load_dataset('diamonds')

diamonds.pivot_table(index = ['clarity', 'cut'],
              columns = ['color'],
              values = ['depth', 'price', 'x'],
              aggfunc = {'depth': np.mean,
                        'price': [min, max, np.median],
                        'x': np.median}
              )
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="7" halign="left">depth</th>
      <th colspan="7" halign="left">price</th>
      <th colspan="7" halign="left">x</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th colspan="7" halign="left">mean</th>
      <th colspan="3" halign="left">max</th>
      <th>...</th>
      <th colspan="3" halign="left">min</th>
      <th colspan="7" halign="left">median</th>
    </tr>
    <tr>
      <th></th>
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>...</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
    </tr>
    <tr>
      <th>clarity</th>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">IF</th>
      <th>Ideal</th>
      <td>61.496429</td>
      <td>61.716456</td>
      <td>61.614925</td>
      <td>61.663951</td>
      <td>61.557522</td>
      <td>61.751579</td>
      <td>61.956000</td>
      <td>17590.0</td>
      <td>18700.0</td>
      <td>18435.0</td>
      <td>...</td>
      <td>468.0</td>
      <td>587.0</td>
      <td>489.0</td>
      <td>5.315</td>
      <td>4.430</td>
      <td>4.400</td>
      <td>4.510</td>
      <td>4.610</td>
      <td>4.570</td>
      <td>4.710</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.070000</td>
      <td>60.859259</td>
      <td>61.112903</td>
      <td>60.904598</td>
      <td>61.290000</td>
      <td>61.078261</td>
      <td>61.458333</td>
      <td>18279.0</td>
      <td>17663.0</td>
      <td>18102.0</td>
      <td>...</td>
      <td>739.0</td>
      <td>631.0</td>
      <td>533.0</td>
      <td>6.100</td>
      <td>4.640</td>
      <td>4.390</td>
      <td>4.640</td>
      <td>4.440</td>
      <td>4.830</td>
      <td>6.570</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>61.513043</td>
      <td>61.160465</td>
      <td>61.123881</td>
      <td>61.470886</td>
      <td>61.858621</td>
      <td>61.278947</td>
      <td>61.387500</td>
      <td>18542.0</td>
      <td>12895.0</td>
      <td>18552.0</td>
      <td>...</td>
      <td>369.0</td>
      <td>673.0</td>
      <td>529.0</td>
      <td>6.170</td>
      <td>4.770</td>
      <td>4.730</td>
      <td>4.800</td>
      <td>4.710</td>
      <td>5.490</td>
      <td>4.715</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>60.877778</td>
      <td>61.811111</td>
      <td>60.620000</td>
      <td>61.509091</td>
      <td>61.975000</td>
      <td>62.150000</td>
      <td>62.466667</td>
      <td>17499.0</td>
      <td>6804.0</td>
      <td>9867.0</td>
      <td>...</td>
      <td>1440.0</td>
      <td>631.0</td>
      <td>827.0</td>
      <td>6.260</td>
      <td>4.280</td>
      <td>5.120</td>
      <td>5.025</td>
      <td>6.080</td>
      <td>4.755</td>
      <td>5.025</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>60.766667</td>
      <td>NaN</td>
      <td>58.925000</td>
      <td>61.300000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2211.0</td>
      <td>NaN</td>
      <td>3205.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.680</td>
      <td>NaN</td>
      <td>5.285</td>
      <td>4.905</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">VVS1</th>
      <th>Ideal</th>
      <td>61.710417</td>
      <td>61.608358</td>
      <td>61.649545</td>
      <td>61.667508</td>
      <td>61.720552</td>
      <td>61.794972</td>
      <td>61.844828</td>
      <td>16253.0</td>
      <td>16256.0</td>
      <td>18682.0</td>
      <td>...</td>
      <td>449.0</td>
      <td>414.0</td>
      <td>461.0</td>
      <td>4.730</td>
      <td>4.490</td>
      <td>4.670</td>
      <td>4.760</td>
      <td>4.765</td>
      <td>4.880</td>
      <td>4.890</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.182500</td>
      <td>61.219048</td>
      <td>61.121250</td>
      <td>61.060234</td>
      <td>61.353571</td>
      <td>61.627381</td>
      <td>61.754167</td>
      <td>17496.0</td>
      <td>14952.0</td>
      <td>14196.0</td>
      <td>...</td>
      <td>432.0</td>
      <td>414.0</td>
      <td>775.0</td>
      <td>4.775</td>
      <td>4.510</td>
      <td>4.825</td>
      <td>4.740</td>
      <td>4.430</td>
      <td>4.800</td>
      <td>7.145</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>61.675000</td>
      <td>61.504118</td>
      <td>61.545977</td>
      <td>61.586316</td>
      <td>61.980000</td>
      <td>62.165217</td>
      <td>61.684211</td>
      <td>17932.0</td>
      <td>15878.0</td>
      <td>18777.0</td>
      <td>...</td>
      <td>434.0</td>
      <td>336.0</td>
      <td>544.0</td>
      <td>4.685</td>
      <td>4.240</td>
      <td>4.505</td>
      <td>4.620</td>
      <td>4.690</td>
      <td>4.910</td>
      <td>5.700</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>61.653846</td>
      <td>61.525581</td>
      <td>62.291429</td>
      <td>61.987805</td>
      <td>62.477419</td>
      <td>62.990909</td>
      <td>63.500000</td>
      <td>8239.0</td>
      <td>10696.0</td>
      <td>11182.0</td>
      <td>...</td>
      <td>401.0</td>
      <td>552.0</td>
      <td>4633.0</td>
      <td>4.680</td>
      <td>4.450</td>
      <td>4.470</td>
      <td>4.860</td>
      <td>4.430</td>
      <td>5.295</td>
      <td>6.290</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>61.666667</td>
      <td>59.600000</td>
      <td>59.100000</td>
      <td>60.066667</td>
      <td>56.500000</td>
      <td>63.500000</td>
      <td>67.600000</td>
      <td>10752.0</td>
      <td>8529.0</td>
      <td>12648.0</td>
      <td>...</td>
      <td>4115.0</td>
      <td>4194.0</td>
      <td>1691.0</td>
      <td>4.920</td>
      <td>5.340</td>
      <td>4.850</td>
      <td>5.670</td>
      <td>6.380</td>
      <td>5.980</td>
      <td>5.560</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">VVS2</th>
      <th>Ideal</th>
      <td>61.584859</td>
      <td>61.681460</td>
      <td>61.646923</td>
      <td>61.692377</td>
      <td>61.753633</td>
      <td>61.883708</td>
      <td>61.759259</td>
      <td>16130.0</td>
      <td>18188.0</td>
      <td>18614.0</td>
      <td>...</td>
      <td>442.0</td>
      <td>412.0</td>
      <td>413.0</td>
      <td>4.770</td>
      <td>4.710</td>
      <td>5.120</td>
      <td>5.180</td>
      <td>4.670</td>
      <td>5.110</td>
      <td>5.760</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.024468</td>
      <td>61.076860</td>
      <td>61.277397</td>
      <td>61.297091</td>
      <td>61.496610</td>
      <td>61.446341</td>
      <td>61.435294</td>
      <td>17216.0</td>
      <td>17667.0</td>
      <td>17203.0</td>
      <td>...</td>
      <td>486.0</td>
      <td>526.0</td>
      <td>778.0</td>
      <td>4.860</td>
      <td>4.680</td>
      <td>5.165</td>
      <td>5.150</td>
      <td>4.570</td>
      <td>4.750</td>
      <td>7.115</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>61.328369</td>
      <td>61.497315</td>
      <td>61.541767</td>
      <td>61.821523</td>
      <td>61.895862</td>
      <td>61.957746</td>
      <td>62.410345</td>
      <td>17545.0</td>
      <td>17689.0</td>
      <td>17317.0</td>
      <td>...</td>
      <td>378.0</td>
      <td>427.0</td>
      <td>336.0</td>
      <td>4.570</td>
      <td>4.280</td>
      <td>4.830</td>
      <td>5.100</td>
      <td>4.670</td>
      <td>5.600</td>
      <td>6.860</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>62.284000</td>
      <td>62.192308</td>
      <td>61.824000</td>
      <td>62.625333</td>
      <td>62.562222</td>
      <td>62.500000</td>
      <td>61.661538</td>
      <td>8943.0</td>
      <td>17449.0</td>
      <td>14654.0</td>
      <td>...</td>
      <td>440.0</td>
      <td>579.0</td>
      <td>375.0</td>
      <td>4.740</td>
      <td>4.895</td>
      <td>5.300</td>
      <td>5.060</td>
      <td>5.220</td>
      <td>5.625</td>
      <td>6.340</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>61.677778</td>
      <td>60.623077</td>
      <td>62.610000</td>
      <td>64.376471</td>
      <td>63.600000</td>
      <td>63.400000</td>
      <td>66.000000</td>
      <td>10562.0</td>
      <td>7918.0</td>
      <td>16364.0</td>
      <td>...</td>
      <td>922.0</td>
      <td>1401.0</td>
      <td>2998.0</td>
      <td>4.950</td>
      <td>5.270</td>
      <td>5.200</td>
      <td>5.430</td>
      <td>6.030</td>
      <td>5.780</td>
      <td>6.290</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">VS1</th>
      <th>Ideal</th>
      <td>61.620228</td>
      <td>61.638449</td>
      <td>61.660065</td>
      <td>61.696642</td>
      <td>61.789293</td>
      <td>61.813971</td>
      <td>61.835323</td>
      <td>17659.0</td>
      <td>18729.0</td>
      <td>18780.0</td>
      <td>...</td>
      <td>423.0</td>
      <td>358.0</td>
      <td>340.0</td>
      <td>4.880</td>
      <td>4.770</td>
      <td>5.280</td>
      <td>5.310</td>
      <td>5.230</td>
      <td>5.750</td>
      <td>6.150</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.132824</td>
      <td>61.119863</td>
      <td>61.197241</td>
      <td>61.419965</td>
      <td>61.398512</td>
      <td>61.297285</td>
      <td>61.565359</td>
      <td>17936.0</td>
      <td>17552.0</td>
      <td>18598.0</td>
      <td>...</td>
      <td>382.0</td>
      <td>355.0</td>
      <td>394.0</td>
      <td>5.630</td>
      <td>5.135</td>
      <td>5.730</td>
      <td>5.270</td>
      <td>5.695</td>
      <td>6.500</td>
      <td>6.880</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>61.553143</td>
      <td>61.593174</td>
      <td>61.495222</td>
      <td>61.701620</td>
      <td>62.004669</td>
      <td>61.947805</td>
      <td>62.024167</td>
      <td>16750.0</td>
      <td>16988.0</td>
      <td>17685.0</td>
      <td>...</td>
      <td>338.0</td>
      <td>397.0</td>
      <td>394.0</td>
      <td>5.120</td>
      <td>5.200</td>
      <td>5.560</td>
      <td>5.295</td>
      <td>5.750</td>
      <td>6.120</td>
      <td>6.175</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>61.597674</td>
      <td>61.602247</td>
      <td>61.317424</td>
      <td>62.446711</td>
      <td>62.277922</td>
      <td>62.369903</td>
      <td>62.528846</td>
      <td>17111.0</td>
      <td>17400.0</td>
      <td>17330.0</td>
      <td>...</td>
      <td>435.0</td>
      <td>457.0</td>
      <td>394.0</td>
      <td>5.610</td>
      <td>5.670</td>
      <td>5.330</td>
      <td>5.915</td>
      <td>5.670</td>
      <td>6.060</td>
      <td>5.705</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>63.160000</td>
      <td>61.371429</td>
      <td>62.430303</td>
      <td>63.353333</td>
      <td>63.309375</td>
      <td>62.796000</td>
      <td>63.675000</td>
      <td>7083.0</td>
      <td>15584.0</td>
      <td>17995.0</td>
      <td>...</td>
      <td>1134.0</td>
      <td>735.0</td>
      <td>949.0</td>
      <td>5.560</td>
      <td>5.435</td>
      <td>5.940</td>
      <td>5.620</td>
      <td>6.100</td>
      <td>6.000</td>
      <td>6.210</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">VS2</th>
      <th>Ideal</th>
      <td>61.688478</td>
      <td>61.717077</td>
      <td>61.726394</td>
      <td>61.726813</td>
      <td>61.804317</td>
      <td>61.778082</td>
      <td>61.734914</td>
      <td>18318.0</td>
      <td>17825.0</td>
      <td>18421.0</td>
      <td>...</td>
      <td>367.0</td>
      <td>371.0</td>
      <td>384.0</td>
      <td>4.815</td>
      <td>5.090</td>
      <td>5.170</td>
      <td>5.655</td>
      <td>5.690</td>
      <td>5.920</td>
      <td>6.480</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.146313</td>
      <td>61.259459</td>
      <td>61.303231</td>
      <td>61.287933</td>
      <td>61.324624</td>
      <td>61.296825</td>
      <td>61.381683</td>
      <td>16921.0</td>
      <td>18342.0</td>
      <td>18791.0</td>
      <td>...</td>
      <td>471.0</td>
      <td>334.0</td>
      <td>368.0</td>
      <td>5.120</td>
      <td>5.170</td>
      <td>5.390</td>
      <td>5.860</td>
      <td>6.495</td>
      <td>6.920</td>
      <td>6.900</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>61.968285</td>
      <td>61.782903</td>
      <td>61.807082</td>
      <td>61.901670</td>
      <td>61.913564</td>
      <td>61.715693</td>
      <td>61.868478</td>
      <td>17153.0</td>
      <td>18557.0</td>
      <td>18430.0</td>
      <td>...</td>
      <td>376.0</td>
      <td>379.0</td>
      <td>357.0</td>
      <td>5.160</td>
      <td>5.300</td>
      <td>5.640</td>
      <td>5.870</td>
      <td>6.125</td>
      <td>6.285</td>
      <td>6.560</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>62.758654</td>
      <td>61.877500</td>
      <td>62.487500</td>
      <td>62.365104</td>
      <td>62.675362</td>
      <td>62.107273</td>
      <td>62.346667</td>
      <td>17760.0</td>
      <td>15385.0</td>
      <td>17597.0</td>
      <td>...</td>
      <td>470.0</td>
      <td>435.0</td>
      <td>368.0</td>
      <td>5.560</td>
      <td>5.685</td>
      <td>5.685</td>
      <td>6.015</td>
      <td>6.025</td>
      <td>6.310</td>
      <td>6.525</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>62.684000</td>
      <td>64.476190</td>
      <td>63.577358</td>
      <td>63.880000</td>
      <td>63.960976</td>
      <td>62.384375</td>
      <td>63.973913</td>
      <td>15152.0</td>
      <td>12829.0</td>
      <td>13853.0</td>
      <td>...</td>
      <td>704.0</td>
      <td>855.0</td>
      <td>416.0</td>
      <td>6.040</td>
      <td>5.430</td>
      <td>5.820</td>
      <td>6.080</td>
      <td>6.090</td>
      <td>6.045</td>
      <td>6.080</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">SI1</th>
      <th>Ideal</th>
      <td>61.736179</td>
      <td>61.713708</td>
      <td>61.669079</td>
      <td>61.717424</td>
      <td>61.763041</td>
      <td>61.791468</td>
      <td>61.849794</td>
      <td>16575.0</td>
      <td>18193.0</td>
      <td>18306.0</td>
      <td>...</td>
      <td>357.0</td>
      <td>382.0</td>
      <td>367.0</td>
      <td>5.160</td>
      <td>5.375</td>
      <td>5.730</td>
      <td>5.720</td>
      <td>6.420</td>
      <td>6.470</td>
      <td>6.640</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.254317</td>
      <td>61.229153</td>
      <td>61.346875</td>
      <td>61.340106</td>
      <td>61.332824</td>
      <td>61.318256</td>
      <td>61.306699</td>
      <td>17776.0</td>
      <td>16957.0</td>
      <td>18735.0</td>
      <td>...</td>
      <td>421.0</td>
      <td>394.0</td>
      <td>363.0</td>
      <td>5.300</td>
      <td>5.680</td>
      <td>5.940</td>
      <td>6.160</td>
      <td>6.580</td>
      <td>6.780</td>
      <td>6.880</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>61.822470</td>
      <td>61.947764</td>
      <td>61.942039</td>
      <td>61.963502</td>
      <td>61.990676</td>
      <td>62.075978</td>
      <td>61.873626</td>
      <td>16286.0</td>
      <td>18731.0</td>
      <td>18759.0</td>
      <td>...</td>
      <td>337.0</td>
      <td>382.0</td>
      <td>351.0</td>
      <td>5.650</td>
      <td>5.660</td>
      <td>5.780</td>
      <td>5.695</td>
      <td>6.350</td>
      <td>6.425</td>
      <td>6.460</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>62.755696</td>
      <td>62.754085</td>
      <td>62.499267</td>
      <td>62.896618</td>
      <td>62.585957</td>
      <td>62.825455</td>
      <td>62.496591</td>
      <td>18468.0</td>
      <td>18027.0</td>
      <td>18376.0</td>
      <td>...</td>
      <td>402.0</td>
      <td>377.0</td>
      <td>339.0</td>
      <td>5.590</td>
      <td>5.600</td>
      <td>5.750</td>
      <td>6.070</td>
      <td>6.180</td>
      <td>6.230</td>
      <td>6.430</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>64.634483</td>
      <td>63.226154</td>
      <td>63.230120</td>
      <td>64.513043</td>
      <td>64.488000</td>
      <td>63.883333</td>
      <td>63.010714</td>
      <td>16386.0</td>
      <td>15330.0</td>
      <td>16280.0</td>
      <td>...</td>
      <td>659.0</td>
      <td>1697.0</td>
      <td>497.0</td>
      <td>6.080</td>
      <td>6.060</td>
      <td>6.060</td>
      <td>6.070</td>
      <td>6.260</td>
      <td>6.365</td>
      <td>6.535</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">SI2</th>
      <th>Ideal</th>
      <td>61.673876</td>
      <td>61.680171</td>
      <td>61.708830</td>
      <td>61.732510</td>
      <td>61.627111</td>
      <td>61.751095</td>
      <td>61.883636</td>
      <td>18693.0</td>
      <td>18128.0</td>
      <td>18578.0</td>
      <td>...</td>
      <td>362.0</td>
      <td>348.0</td>
      <td>344.0</td>
      <td>5.730</td>
      <td>6.100</td>
      <td>6.130</td>
      <td>6.330</td>
      <td>6.600</td>
      <td>6.920</td>
      <td>6.835</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.099287</td>
      <td>61.095376</td>
      <td>61.174761</td>
      <td>61.183943</td>
      <td>61.219194</td>
      <td>61.305128</td>
      <td>61.280745</td>
      <td>18575.0</td>
      <td>18477.0</td>
      <td>18784.0</td>
      <td>...</td>
      <td>368.0</td>
      <td>500.0</td>
      <td>405.0</td>
      <td>6.320</td>
      <td>6.340</td>
      <td>6.420</td>
      <td>6.550</td>
      <td>6.810</td>
      <td>7.000</td>
      <td>7.360</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>61.743631</td>
      <td>61.764719</td>
      <td>61.782216</td>
      <td>62.011009</td>
      <td>62.006997</td>
      <td>61.935500</td>
      <td>61.835938</td>
      <td>18526.0</td>
      <td>18128.0</td>
      <td>18692.0</td>
      <td>...</td>
      <td>393.0</td>
      <td>383.0</td>
      <td>430.0</td>
      <td>6.290</td>
      <td>6.180</td>
      <td>6.270</td>
      <td>6.330</td>
      <td>6.620</td>
      <td>6.790</td>
      <td>6.795</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>62.063229</td>
      <td>61.986634</td>
      <td>62.250746</td>
      <td>62.544172</td>
      <td>62.391139</td>
      <td>62.365432</td>
      <td>62.388679</td>
      <td>17094.0</td>
      <td>18236.0</td>
      <td>18686.0</td>
      <td>...</td>
      <td>368.0</td>
      <td>351.0</td>
      <td>335.0</td>
      <td>6.110</td>
      <td>6.040</td>
      <td>6.320</td>
      <td>6.320</td>
      <td>6.410</td>
      <td>6.910</td>
      <td>6.750</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>64.703571</td>
      <td>63.448718</td>
      <td>63.834831</td>
      <td>64.573750</td>
      <td>64.931868</td>
      <td>65.564444</td>
      <td>64.511111</td>
      <td>16086.0</td>
      <td>15540.0</td>
      <td>17405.0</td>
      <td>...</td>
      <td>1059.0</td>
      <td>1625.0</td>
      <td>1362.0</td>
      <td>6.130</td>
      <td>6.280</td>
      <td>6.260</td>
      <td>6.325</td>
      <td>6.650</td>
      <td>7.050</td>
      <td>6.560</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">I1</th>
      <th>Ideal</th>
      <td>61.453846</td>
      <td>61.850000</td>
      <td>61.588095</td>
      <td>61.400000</td>
      <td>61.657895</td>
      <td>61.729412</td>
      <td>63.500000</td>
      <td>13156.0</td>
      <td>9072.0</td>
      <td>10685.0</td>
      <td>...</td>
      <td>3080.0</td>
      <td>2239.0</td>
      <td>2370.0</td>
      <td>6.730</td>
      <td>6.510</td>
      <td>6.560</td>
      <td>6.765</td>
      <td>6.925</td>
      <td>6.820</td>
      <td>7.665</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>61.900000</td>
      <td>60.806667</td>
      <td>61.150000</td>
      <td>61.113043</td>
      <td>61.247826</td>
      <td>61.291667</td>
      <td>61.300000</td>
      <td>6300.0</td>
      <td>10453.0</td>
      <td>9967.0</td>
      <td>...</td>
      <td>452.0</td>
      <td>1107.0</td>
      <td>945.0</td>
      <td>6.645</td>
      <td>6.525</td>
      <td>6.465</td>
      <td>6.645</td>
      <td>6.620</td>
      <td>7.100</td>
      <td>6.900</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>62.200000</td>
      <td>61.481818</td>
      <td>61.561538</td>
      <td>61.943750</td>
      <td>61.816667</td>
      <td>62.100000</td>
      <td>61.737500</td>
      <td>3816.0</td>
      <td>10340.0</td>
      <td>9789.0</td>
      <td>...</td>
      <td>2850.0</td>
      <td>1235.0</td>
      <td>2048.0</td>
      <td>6.180</td>
      <td>6.500</td>
      <td>6.740</td>
      <td>6.430</td>
      <td>7.290</td>
      <td>7.050</td>
      <td>7.060</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>61.350000</td>
      <td>61.660870</td>
      <td>62.889474</td>
      <td>62.568421</td>
      <td>61.757143</td>
      <td>61.622222</td>
      <td>61.650000</td>
      <td>6088.0</td>
      <td>11548.0</td>
      <td>6686.0</td>
      <td>...</td>
      <td>1134.0</td>
      <td>1111.0</td>
      <td>1945.0</td>
      <td>6.720</td>
      <td>7.010</td>
      <td>6.090</td>
      <td>6.640</td>
      <td>6.400</td>
      <td>6.930</td>
      <td>6.950</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>65.600000</td>
      <td>65.644444</td>
      <td>65.657143</td>
      <td>65.333962</td>
      <td>65.759615</td>
      <td>65.729412</td>
      <td>66.460870</td>
      <td>15964.0</td>
      <td>3692.0</td>
      <td>7294.0</td>
      <td>...</td>
      <td>1058.0</td>
      <td>1014.0</td>
      <td>1066.0</td>
      <td>7.325</td>
      <td>6.180</td>
      <td>5.640</td>
      <td>6.170</td>
      <td>6.930</td>
      <td>6.660</td>
      <td>7.430</td>
    </tr>
  </tbody>
</table>
<p>40 rows × 35 columns</p>
</div>

<pre><code class="language-python"># Let us create a dataframe with random variables
np.random.seed(1)
n = 2500
df = pd.DataFrame(
    {'state': list(np.random.choice([&quot;New York&quot;, &quot;Florida&quot;, &quot;California&quot;], size=(n))), 
     'gender': list(np.random.choice([&quot;Male&quot;, &quot;Female&quot;], size=(n), p=[.4, .6])),
     'education': list(np.random.choice([&quot;High School&quot;, &quot;Undergrad&quot;, &quot;Grad&quot;], size=(n))),
     'housing': list(np.random.choice([&quot;Rent&quot;, &quot;Own&quot;], size=(n))),     
     'height': list(np.random.randint(140,200,n)),
     'weight': list(np.random.randint(100,150,n)),
     'income': list(np.random.randint(50,250,n)),
     'computers': list(np.random.randint(0,6,n))
    })
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>education</th>
      <th>housing</th>
      <th>height</th>
      <th>weight</th>
      <th>income</th>
      <th>computers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Female</td>
      <td>High School</td>
      <td>Own</td>
      <td>159</td>
      <td>102</td>
      <td>96</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>High School</td>
      <td>Rent</td>
      <td>164</td>
      <td>125</td>
      <td>76</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>Male</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>165</td>
      <td>144</td>
      <td>113</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>188</td>
      <td>128</td>
      <td>136</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Rent</td>
      <td>183</td>
      <td>117</td>
      <td>170</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>New York</td>
      <td>Male</td>
      <td>High School</td>
      <td>Rent</td>
      <td>168</td>
      <td>122</td>
      <td>132</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>New York</td>
      <td>Male</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>156</td>
      <td>139</td>
      <td>161</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>California</td>
      <td>Male</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>144</td>
      <td>113</td>
      <td>242</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>186</td>
      <td>136</td>
      <td>172</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>167</td>
      <td>109</td>
      <td>161</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 8 columns</p>
</div>

<pre><code class="language-python">df.pivot_table(index = ['gender'],
               columns = ['education'],
               values = ['income'],
               aggfunc = ['mean'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">mean</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="3" halign="left">income</th>
    </tr>
    <tr>
      <th>education</th>
      <th>Grad</th>
      <th>High School</th>
      <th>Undergrad</th>
    </tr>
    <tr>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Female</th>
      <td>152.045161</td>
      <td>147.530364</td>
      <td>150.780622</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>150.782609</td>
      <td>151.890625</td>
      <td>151.585227</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df.pivot_table(index = ['state'],
               columns = ['education', 'housing'],
               values = ['gender', 'computers'],
               aggfunc = {'gender': [len], 'computers': [np.median, 'mean']})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="12" halign="left">computers</th>
      <th colspan="6" halign="left">gender</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="6" halign="left">mean</th>
      <th colspan="6" halign="left">median</th>
      <th colspan="6" halign="left">len</th>
    </tr>
    <tr>
      <th>education</th>
      <th colspan="2" halign="left">Grad</th>
      <th colspan="2" halign="left">High School</th>
      <th colspan="2" halign="left">Undergrad</th>
      <th colspan="2" halign="left">Grad</th>
      <th colspan="2" halign="left">High School</th>
      <th colspan="2" halign="left">Undergrad</th>
      <th colspan="2" halign="left">Grad</th>
      <th colspan="2" halign="left">High School</th>
      <th colspan="2" halign="left">Undergrad</th>
    </tr>
    <tr>
      <th>housing</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
      <th>Own</th>
      <th>Rent</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>2.659574</td>
      <td>2.527778</td>
      <td>2.550000</td>
      <td>2.446667</td>
      <td>2.335484</td>
      <td>2.634615</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>141</td>
      <td>144</td>
      <td>120</td>
      <td>150</td>
      <td>155</td>
      <td>156</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>2.344538</td>
      <td>2.647059</td>
      <td>2.414815</td>
      <td>2.365672</td>
      <td>2.674242</td>
      <td>2.246377</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>119</td>
      <td>136</td>
      <td>135</td>
      <td>134</td>
      <td>132</td>
      <td>138</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>2.524194</td>
      <td>2.317073</td>
      <td>2.291667</td>
      <td>2.564885</td>
      <td>2.520270</td>
      <td>2.505882</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>124</td>
      <td>123</td>
      <td>144</td>
      <td>131</td>
      <td>148</td>
      <td>170</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="pivot">Pivot</h3>
<p>Pivot is a simpler version of pivot_table.  It cannot do any aggregation function, it just shows the values of the 'value' columns at the intersection of the 'index' and the 'columns'.</p>
<p>There are three parameters for pivot:
1. index - which columns in the dataframe should be the index.  This is optional. If not specified, it uses the index of the dataframe.<br />
2. columns - which dataframe columns should appear on the top as columns in the result.  For each entry in the column parameter, it will create a separate column for each unique value of that column.  So if 'carb' can be 1, 2 or 4, it will show 1, 2 and 4 on the top.
3. values - which column's values to show at the intersection of index and columns.  If there is more than one value (even if the multiple values are identical), pivot will throw an error. (for example, in mtcars_small, if yuou put cyl 4,6,8 on the left as index, and am 0,1 on the top as columns, and mpg as values, you have two cars at their intersection.)</p>
<p>Pivot can be better than pivot_table as it brings in the value at the intersection of index and columns as-is, which is what you need sometimes without having to add, mean, or count them.</p>
<pre><code class="language-python">mtcars = sm.datasets.get_rdataset('mtcars').data
</code></pre>
<pre><code class="language-python">mtcars.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars = mtcars.reset_index().rename(columns={'index': 'car'})
mtcars
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>car</th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mazda RX4</td>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mazda RX4 Wag</td>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Datsun 710</td>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hornet 4 Drive</td>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hornet Sportabout</td>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Valiant</td>
      <td>18.1</td>
      <td>6</td>
      <td>225.0</td>
      <td>105</td>
      <td>2.76</td>
      <td>3.460</td>
      <td>20.22</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Duster 360</td>
      <td>14.3</td>
      <td>8</td>
      <td>360.0</td>
      <td>245</td>
      <td>3.21</td>
      <td>3.570</td>
      <td>15.84</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Merc 240D</td>
      <td>24.4</td>
      <td>4</td>
      <td>146.7</td>
      <td>62</td>
      <td>3.69</td>
      <td>3.190</td>
      <td>20.00</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Merc 230</td>
      <td>22.8</td>
      <td>4</td>
      <td>140.8</td>
      <td>95</td>
      <td>3.92</td>
      <td>3.150</td>
      <td>22.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Merc 280</td>
      <td>19.2</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.30</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Merc 280C</td>
      <td>17.8</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Merc 450SE</td>
      <td>16.4</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>4.070</td>
      <td>17.40</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Merc 450SL</td>
      <td>17.3</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.730</td>
      <td>17.60</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Merc 450SLC</td>
      <td>15.2</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.780</td>
      <td>18.00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Cadillac Fleetwood</td>
      <td>10.4</td>
      <td>8</td>
      <td>472.0</td>
      <td>205</td>
      <td>2.93</td>
      <td>5.250</td>
      <td>17.98</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Lincoln Continental</td>
      <td>10.4</td>
      <td>8</td>
      <td>460.0</td>
      <td>215</td>
      <td>3.00</td>
      <td>5.424</td>
      <td>17.82</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Chrysler Imperial</td>
      <td>14.7</td>
      <td>8</td>
      <td>440.0</td>
      <td>230</td>
      <td>3.23</td>
      <td>5.345</td>
      <td>17.42</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Fiat 128</td>
      <td>32.4</td>
      <td>4</td>
      <td>78.7</td>
      <td>66</td>
      <td>4.08</td>
      <td>2.200</td>
      <td>19.47</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Honda Civic</td>
      <td>30.4</td>
      <td>4</td>
      <td>75.7</td>
      <td>52</td>
      <td>4.93</td>
      <td>1.615</td>
      <td>18.52</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Toyota Corolla</td>
      <td>33.9</td>
      <td>4</td>
      <td>71.1</td>
      <td>65</td>
      <td>4.22</td>
      <td>1.835</td>
      <td>19.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Toyota Corona</td>
      <td>21.5</td>
      <td>4</td>
      <td>120.1</td>
      <td>97</td>
      <td>3.70</td>
      <td>2.465</td>
      <td>20.01</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Dodge Challenger</td>
      <td>15.5</td>
      <td>8</td>
      <td>318.0</td>
      <td>150</td>
      <td>2.76</td>
      <td>3.520</td>
      <td>16.87</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>AMC Javelin</td>
      <td>15.2</td>
      <td>8</td>
      <td>304.0</td>
      <td>150</td>
      <td>3.15</td>
      <td>3.435</td>
      <td>17.30</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Camaro Z28</td>
      <td>13.3</td>
      <td>8</td>
      <td>350.0</td>
      <td>245</td>
      <td>3.73</td>
      <td>3.840</td>
      <td>15.41</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Pontiac Firebird</td>
      <td>19.2</td>
      <td>8</td>
      <td>400.0</td>
      <td>175</td>
      <td>3.08</td>
      <td>3.845</td>
      <td>17.05</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Fiat X1-9</td>
      <td>27.3</td>
      <td>4</td>
      <td>79.0</td>
      <td>66</td>
      <td>4.08</td>
      <td>1.935</td>
      <td>18.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Porsche 914-2</td>
      <td>26.0</td>
      <td>4</td>
      <td>120.3</td>
      <td>91</td>
      <td>4.43</td>
      <td>2.140</td>
      <td>16.70</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Lotus Europa</td>
      <td>30.4</td>
      <td>4</td>
      <td>95.1</td>
      <td>113</td>
      <td>3.77</td>
      <td>1.513</td>
      <td>16.90</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Ford Pantera L</td>
      <td>15.8</td>
      <td>8</td>
      <td>351.0</td>
      <td>264</td>
      <td>4.22</td>
      <td>3.170</td>
      <td>14.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Ferrari Dino</td>
      <td>19.7</td>
      <td>6</td>
      <td>145.0</td>
      <td>175</td>
      <td>3.62</td>
      <td>2.770</td>
      <td>15.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Maserati Bora</td>
      <td>15.0</td>
      <td>8</td>
      <td>301.0</td>
      <td>335</td>
      <td>3.54</td>
      <td>3.570</td>
      <td>14.60</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Volvo 142E</td>
      <td>21.4</td>
      <td>4</td>
      <td>121.0</td>
      <td>109</td>
      <td>4.11</td>
      <td>2.780</td>
      <td>18.60</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars_small = mtcars.iloc[1:8, [0, 1, 2, 4, 8 , 9]]
mtcars_small
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>car</th>
      <th>mpg</th>
      <th>cyl</th>
      <th>hp</th>
      <th>vs</th>
      <th>am</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Mazda RX4 Wag</td>
      <td>21.0</td>
      <td>6</td>
      <td>110</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Datsun 710</td>
      <td>22.8</td>
      <td>4</td>
      <td>93</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hornet 4 Drive</td>
      <td>21.4</td>
      <td>6</td>
      <td>110</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hornet Sportabout</td>
      <td>18.7</td>
      <td>8</td>
      <td>175</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Valiant</td>
      <td>18.1</td>
      <td>6</td>
      <td>105</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Duster 360</td>
      <td>14.3</td>
      <td>8</td>
      <td>245</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Merc 240D</td>
      <td>24.4</td>
      <td>4</td>
      <td>62</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars_small.pivot(index = 'car', columns = 'cyl', values = 'mpg')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>cyl</th>
      <th>4</th>
      <th>6</th>
      <th>8</th>
    </tr>
    <tr>
      <th>car</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.3</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>NaN</td>
      <td>21.4</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.7</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>NaN</td>
      <td>21.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>NaN</td>
      <td>18.1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars_small.pivot(index = 'car', columns = 'cyl')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">mpg</th>
      <th colspan="3" halign="left">hp</th>
      <th colspan="3" halign="left">vs</th>
      <th colspan="3" halign="left">am</th>
    </tr>
    <tr>
      <th>cyl</th>
      <th>4</th>
      <th>6</th>
      <th>8</th>
      <th>4</th>
      <th>6</th>
      <th>8</th>
      <th>4</th>
      <th>6</th>
      <th>8</th>
      <th>4</th>
      <th>6</th>
      <th>8</th>
    </tr>
    <tr>
      <th>car</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>93.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>245.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>NaN</td>
      <td>21.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>175.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>NaN</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>62.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>NaN</td>
      <td>18.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>105.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars_small.pivot(index = 'car', columns = ['am'], values=['mpg', 'vs'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mpg</th>
      <th colspan="2" halign="left">vs</th>
    </tr>
    <tr>
      <th>am</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>car</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Datsun 710</th>
      <td>NaN</td>
      <td>22.8</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>NaN</td>
      <td>21.0</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>Sometimes you may wish to use the index of a dataframe directly, as opposed to moving it into its own column first.</strong></p>
<pre><code class="language-python">df = pd.DataFrame([[0, 1, 2], [2, 3, 5], [6,7,8],],
                                    index=['cat', 'dog', 'cow'],
                                    columns=['weight', 'height', 'age'])
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>weight</th>
      <th>height</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cat</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>dog</th>
      <td>2</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>cow</th>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df.pivot(index = [ 'weight'], columns = ['height'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">age</th>
    </tr>
    <tr>
      <th>height</th>
      <th>1</th>
      <th>3</th>
      <th>7</th>
    </tr>
    <tr>
      <th>weight</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Now also use the native index of the dataframe

df.pivot(index = [df.index, 'weight'], columns = ['height'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">age</th>
    </tr>
    <tr>
      <th></th>
      <th>height</th>
      <th>1</th>
      <th>3</th>
      <th>7</th>
    </tr>
    <tr>
      <th></th>
      <th>weight</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cat</th>
      <th>0</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>cow</th>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>dog</th>
      <th>2</th>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>Now the same thing fails if there are duplicates</p>
<pre><code class="language-python">df = pd.DataFrame([['cat', 0, 1, 2], ['dog', 2, 3, 5], ['cow', 6,7,8], ['pig', 6,7,8],],
                                    columns=['animal', 'weight', 'height', 'age'])
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>animal</th>
      <th>weight</th>
      <th>height</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cat</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>dog</td>
      <td>2</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>cow</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pig</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>

<p>The below will fail as there are duplicates.</p>
<pre><code class="language-python">df.pivot(index = [ 'weight'], columns = ['height'])
</code></pre>
<pre><code class="language-python"># We consider only the first 3 rows of this new dataframe.
# Look how in the values we have a categorical variable.

df.iloc[:3].pivot(index = 'weight', columns = 'height', values = 'animal')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>height</th>
      <th>1</th>
      <th>3</th>
      <th>7</th>
    </tr>
    <tr>
      <th>weight</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cat</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>dog</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>cow</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="crosstab">Crosstab</h3>
<p>Cross computes a frequency table given an index and columns of categorical variables (as a data frame column, series, or numpy array).  However it is possible to specify an aggfunc as well, that makes it like a pivot_table.  </p>
<p>You can pass normalize = True, or index, or columns, and it will normalize based on totals, or by the rows or by the columns.</p>
<pre><code class="language-python">df = sns.load_dataset('diamonds')
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53935</th>
      <td>0.72</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI1</td>
      <td>60.8</td>
      <td>57.0</td>
      <td>2757</td>
      <td>5.75</td>
      <td>5.76</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>0.72</td>
      <td>Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>63.1</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.75</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>60.0</td>
      <td>2757</td>
      <td>5.66</td>
      <td>5.68</td>
      <td>3.56</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>2757</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>0.75</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.83</td>
      <td>5.87</td>
      <td>3.64</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>

<pre><code class="language-python"># Basic
pd.crosstab(df.cut, df.color)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>2834</td>
      <td>3903</td>
      <td>3826</td>
      <td>4884</td>
      <td>3115</td>
      <td>2093</td>
      <td>896</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>1603</td>
      <td>2337</td>
      <td>2331</td>
      <td>2924</td>
      <td>2360</td>
      <td>1428</td>
      <td>808</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>1513</td>
      <td>2400</td>
      <td>2164</td>
      <td>2299</td>
      <td>1824</td>
      <td>1204</td>
      <td>678</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>662</td>
      <td>933</td>
      <td>909</td>
      <td>871</td>
      <td>702</td>
      <td>522</td>
      <td>307</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>163</td>
      <td>224</td>
      <td>312</td>
      <td>314</td>
      <td>303</td>
      <td>175</td>
      <td>119</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># With margins
pd.crosstab(df.cut, df.color, margins = True)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>All</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>2834</td>
      <td>3903</td>
      <td>3826</td>
      <td>4884</td>
      <td>3115</td>
      <td>2093</td>
      <td>896</td>
      <td>21551</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>1603</td>
      <td>2337</td>
      <td>2331</td>
      <td>2924</td>
      <td>2360</td>
      <td>1428</td>
      <td>808</td>
      <td>13791</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>1513</td>
      <td>2400</td>
      <td>2164</td>
      <td>2299</td>
      <td>1824</td>
      <td>1204</td>
      <td>678</td>
      <td>12082</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>662</td>
      <td>933</td>
      <td>909</td>
      <td>871</td>
      <td>702</td>
      <td>522</td>
      <td>307</td>
      <td>4906</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>163</td>
      <td>224</td>
      <td>312</td>
      <td>314</td>
      <td>303</td>
      <td>175</td>
      <td>119</td>
      <td>1610</td>
    </tr>
    <tr>
      <th>All</th>
      <td>6775</td>
      <td>9797</td>
      <td>9542</td>
      <td>11292</td>
      <td>8304</td>
      <td>5422</td>
      <td>2808</td>
      <td>53940</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># With margins and normalized
pd.crosstab(df.cut, df.color, margins = True, normalize = True)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>All</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>0.052540</td>
      <td>0.072358</td>
      <td>0.070931</td>
      <td>0.090545</td>
      <td>0.057749</td>
      <td>0.038802</td>
      <td>0.016611</td>
      <td>0.399537</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>0.029718</td>
      <td>0.043326</td>
      <td>0.043215</td>
      <td>0.054208</td>
      <td>0.043752</td>
      <td>0.026474</td>
      <td>0.014980</td>
      <td>0.255673</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>0.028050</td>
      <td>0.044494</td>
      <td>0.040119</td>
      <td>0.042621</td>
      <td>0.033815</td>
      <td>0.022321</td>
      <td>0.012570</td>
      <td>0.223990</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>0.012273</td>
      <td>0.017297</td>
      <td>0.016852</td>
      <td>0.016148</td>
      <td>0.013014</td>
      <td>0.009677</td>
      <td>0.005692</td>
      <td>0.090953</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>0.003022</td>
      <td>0.004153</td>
      <td>0.005784</td>
      <td>0.005821</td>
      <td>0.005617</td>
      <td>0.003244</td>
      <td>0.002206</td>
      <td>0.029848</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.125603</td>
      <td>0.181628</td>
      <td>0.176900</td>
      <td>0.209344</td>
      <td>0.153949</td>
      <td>0.100519</td>
      <td>0.052058</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Normalized by index.  Rows total to 1.  See how the total column 'All' has 
# disappeared from rows.  But it has remained for the columns
pd.crosstab(df.cut, df.color, margins = True, normalize = 'index')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>0.131502</td>
      <td>0.181105</td>
      <td>0.177532</td>
      <td>0.226625</td>
      <td>0.144541</td>
      <td>0.097118</td>
      <td>0.041576</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>0.116235</td>
      <td>0.169458</td>
      <td>0.169023</td>
      <td>0.212022</td>
      <td>0.171126</td>
      <td>0.103546</td>
      <td>0.058589</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>0.125228</td>
      <td>0.198643</td>
      <td>0.179109</td>
      <td>0.190283</td>
      <td>0.150968</td>
      <td>0.099652</td>
      <td>0.056117</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>0.134937</td>
      <td>0.190175</td>
      <td>0.185283</td>
      <td>0.177538</td>
      <td>0.143090</td>
      <td>0.106400</td>
      <td>0.062576</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>0.101242</td>
      <td>0.139130</td>
      <td>0.193789</td>
      <td>0.195031</td>
      <td>0.188199</td>
      <td>0.108696</td>
      <td>0.073913</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.125603</td>
      <td>0.181628</td>
      <td>0.176900</td>
      <td>0.209344</td>
      <td>0.153949</td>
      <td>0.100519</td>
      <td>0.052058</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Normalized by columns
pd.crosstab(df.cut, df.color, margins = True, normalize = 'columns')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>All</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>0.418303</td>
      <td>0.398387</td>
      <td>0.400964</td>
      <td>0.432519</td>
      <td>0.375120</td>
      <td>0.386020</td>
      <td>0.319088</td>
      <td>0.399537</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>0.236605</td>
      <td>0.238542</td>
      <td>0.244288</td>
      <td>0.258944</td>
      <td>0.284200</td>
      <td>0.263371</td>
      <td>0.287749</td>
      <td>0.255673</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>0.223321</td>
      <td>0.244973</td>
      <td>0.226787</td>
      <td>0.203595</td>
      <td>0.219653</td>
      <td>0.222058</td>
      <td>0.241453</td>
      <td>0.223990</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>0.097712</td>
      <td>0.095233</td>
      <td>0.095263</td>
      <td>0.077134</td>
      <td>0.084538</td>
      <td>0.096274</td>
      <td>0.109330</td>
      <td>0.090953</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>0.024059</td>
      <td>0.022864</td>
      <td>0.032698</td>
      <td>0.027807</td>
      <td>0.036488</td>
      <td>0.032276</td>
      <td>0.042379</td>
      <td>0.029848</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># You can also pass multiple series for both the index and columns
pd.crosstab([df.cut, df.color], [df.clarity])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>clarity</th>
      <th>IF</th>
      <th>VVS1</th>
      <th>VVS2</th>
      <th>VS1</th>
      <th>VS2</th>
      <th>SI1</th>
      <th>SI2</th>
      <th>I1</th>
    </tr>
    <tr>
      <th>cut</th>
      <th>color</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">Ideal</th>
      <th>D</th>
      <td>28</td>
      <td>144</td>
      <td>284</td>
      <td>351</td>
      <td>920</td>
      <td>738</td>
      <td>356</td>
      <td>13</td>
    </tr>
    <tr>
      <th>E</th>
      <td>79</td>
      <td>335</td>
      <td>507</td>
      <td>593</td>
      <td>1136</td>
      <td>766</td>
      <td>469</td>
      <td>18</td>
    </tr>
    <tr>
      <th>F</th>
      <td>268</td>
      <td>440</td>
      <td>520</td>
      <td>616</td>
      <td>879</td>
      <td>608</td>
      <td>453</td>
      <td>42</td>
    </tr>
    <tr>
      <th>G</th>
      <td>491</td>
      <td>594</td>
      <td>774</td>
      <td>953</td>
      <td>910</td>
      <td>660</td>
      <td>486</td>
      <td>16</td>
    </tr>
    <tr>
      <th>H</th>
      <td>226</td>
      <td>326</td>
      <td>289</td>
      <td>467</td>
      <td>556</td>
      <td>763</td>
      <td>450</td>
      <td>38</td>
    </tr>
    <tr>
      <th>I</th>
      <td>95</td>
      <td>179</td>
      <td>178</td>
      <td>408</td>
      <td>438</td>
      <td>504</td>
      <td>274</td>
      <td>17</td>
    </tr>
    <tr>
      <th>J</th>
      <td>25</td>
      <td>29</td>
      <td>54</td>
      <td>201</td>
      <td>232</td>
      <td>243</td>
      <td>110</td>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Premium</th>
      <th>D</th>
      <td>10</td>
      <td>40</td>
      <td>94</td>
      <td>131</td>
      <td>339</td>
      <td>556</td>
      <td>421</td>
      <td>12</td>
    </tr>
    <tr>
      <th>E</th>
      <td>27</td>
      <td>105</td>
      <td>121</td>
      <td>292</td>
      <td>629</td>
      <td>614</td>
      <td>519</td>
      <td>30</td>
    </tr>
    <tr>
      <th>F</th>
      <td>31</td>
      <td>80</td>
      <td>146</td>
      <td>290</td>
      <td>619</td>
      <td>608</td>
      <td>523</td>
      <td>34</td>
    </tr>
    <tr>
      <th>G</th>
      <td>87</td>
      <td>171</td>
      <td>275</td>
      <td>566</td>
      <td>721</td>
      <td>566</td>
      <td>492</td>
      <td>46</td>
    </tr>
    <tr>
      <th>H</th>
      <td>40</td>
      <td>112</td>
      <td>118</td>
      <td>336</td>
      <td>532</td>
      <td>655</td>
      <td>521</td>
      <td>46</td>
    </tr>
    <tr>
      <th>I</th>
      <td>23</td>
      <td>84</td>
      <td>82</td>
      <td>221</td>
      <td>315</td>
      <td>367</td>
      <td>312</td>
      <td>24</td>
    </tr>
    <tr>
      <th>J</th>
      <td>12</td>
      <td>24</td>
      <td>34</td>
      <td>153</td>
      <td>202</td>
      <td>209</td>
      <td>161</td>
      <td>13</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Very Good</th>
      <th>D</th>
      <td>23</td>
      <td>52</td>
      <td>141</td>
      <td>175</td>
      <td>309</td>
      <td>494</td>
      <td>314</td>
      <td>5</td>
    </tr>
    <tr>
      <th>E</th>
      <td>43</td>
      <td>170</td>
      <td>298</td>
      <td>293</td>
      <td>503</td>
      <td>626</td>
      <td>445</td>
      <td>22</td>
    </tr>
    <tr>
      <th>F</th>
      <td>67</td>
      <td>174</td>
      <td>249</td>
      <td>293</td>
      <td>466</td>
      <td>559</td>
      <td>343</td>
      <td>13</td>
    </tr>
    <tr>
      <th>G</th>
      <td>79</td>
      <td>190</td>
      <td>302</td>
      <td>432</td>
      <td>479</td>
      <td>474</td>
      <td>327</td>
      <td>16</td>
    </tr>
    <tr>
      <th>H</th>
      <td>29</td>
      <td>115</td>
      <td>145</td>
      <td>257</td>
      <td>376</td>
      <td>547</td>
      <td>343</td>
      <td>12</td>
    </tr>
    <tr>
      <th>I</th>
      <td>19</td>
      <td>69</td>
      <td>71</td>
      <td>205</td>
      <td>274</td>
      <td>358</td>
      <td>200</td>
      <td>8</td>
    </tr>
    <tr>
      <th>J</th>
      <td>8</td>
      <td>19</td>
      <td>29</td>
      <td>120</td>
      <td>184</td>
      <td>182</td>
      <td>128</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Good</th>
      <th>D</th>
      <td>9</td>
      <td>13</td>
      <td>25</td>
      <td>43</td>
      <td>104</td>
      <td>237</td>
      <td>223</td>
      <td>8</td>
    </tr>
    <tr>
      <th>E</th>
      <td>9</td>
      <td>43</td>
      <td>52</td>
      <td>89</td>
      <td>160</td>
      <td>355</td>
      <td>202</td>
      <td>23</td>
    </tr>
    <tr>
      <th>F</th>
      <td>15</td>
      <td>35</td>
      <td>50</td>
      <td>132</td>
      <td>184</td>
      <td>273</td>
      <td>201</td>
      <td>19</td>
    </tr>
    <tr>
      <th>G</th>
      <td>22</td>
      <td>41</td>
      <td>75</td>
      <td>152</td>
      <td>192</td>
      <td>207</td>
      <td>163</td>
      <td>19</td>
    </tr>
    <tr>
      <th>H</th>
      <td>4</td>
      <td>31</td>
      <td>45</td>
      <td>77</td>
      <td>138</td>
      <td>235</td>
      <td>158</td>
      <td>14</td>
    </tr>
    <tr>
      <th>I</th>
      <td>6</td>
      <td>22</td>
      <td>26</td>
      <td>103</td>
      <td>110</td>
      <td>165</td>
      <td>81</td>
      <td>9</td>
    </tr>
    <tr>
      <th>J</th>
      <td>6</td>
      <td>1</td>
      <td>13</td>
      <td>52</td>
      <td>90</td>
      <td>88</td>
      <td>53</td>
      <td>4</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Fair</th>
      <th>D</th>
      <td>3</td>
      <td>3</td>
      <td>9</td>
      <td>5</td>
      <td>25</td>
      <td>58</td>
      <td>56</td>
      <td>4</td>
    </tr>
    <tr>
      <th>E</th>
      <td>0</td>
      <td>3</td>
      <td>13</td>
      <td>14</td>
      <td>42</td>
      <td>65</td>
      <td>78</td>
      <td>9</td>
    </tr>
    <tr>
      <th>F</th>
      <td>4</td>
      <td>5</td>
      <td>10</td>
      <td>33</td>
      <td>53</td>
      <td>83</td>
      <td>89</td>
      <td>35</td>
    </tr>
    <tr>
      <th>G</th>
      <td>2</td>
      <td>3</td>
      <td>17</td>
      <td>45</td>
      <td>45</td>
      <td>69</td>
      <td>80</td>
      <td>53</td>
    </tr>
    <tr>
      <th>H</th>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>32</td>
      <td>41</td>
      <td>75</td>
      <td>91</td>
      <td>52</td>
    </tr>
    <tr>
      <th>I</th>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>25</td>
      <td>32</td>
      <td>30</td>
      <td>45</td>
      <td>34</td>
    </tr>
    <tr>
      <th>J</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
      <td>23</td>
      <td>28</td>
      <td>27</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="melt">Melt</h3>
<p>Melt is similar to Stack() but unlike stack it returns a dataframe, not a series with a multi-level index.  A huge advantage is that unlike stack, you can <em>freeze</em> some of the columbns and stack the rest.  </p>
<p>In melt, you specify id_vars (index variables) - these are the columns that stay untouched, and then the value_vars, that get stacked.  If value_vars are not specified, all columns other than id_vars get stacked.</p>
<p><strong>Opposite of melt is pivot.  Pivot applies no aggfunc, just lists the values at the intersection of categorical vars it picks up from a melted dataset.</strong></p>
<pre><code class="language-python"># Let us create a dataframe with random variables
np.random.seed(1)
n = 10
df = pd.DataFrame(
    {'state': list(np.random.choice([&quot;New York&quot;, &quot;Florida&quot;, &quot;California&quot;], size=(n))), 
     'gender': list(np.random.choice([&quot;Male&quot;, &quot;Female&quot;], size=(n), p=[.4, .6])),
     'education': list(np.random.choice([&quot;High School&quot;, &quot;Undergrad&quot;, &quot;Grad&quot;], size=(n))),
     'housing': list(np.random.choice([&quot;Rent&quot;, &quot;Own&quot;], size=(n))),     
     'height': list(np.random.randint(140,200,n)),
     'weight': list(np.random.randint(100,150,n)),
     'income': list(np.random.randint(50,250,n)),
     'computers': list(np.random.randint(0,6,n))
    })
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>education</th>
      <th>housing</th>
      <th>height</th>
      <th>weight</th>
      <th>income</th>
      <th>computers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>197</td>
      <td>104</td>
      <td>65</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Rent</td>
      <td>148</td>
      <td>124</td>
      <td>114</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>Female</td>
      <td>High School</td>
      <td>Rent</td>
      <td>170</td>
      <td>149</td>
      <td>246</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Grad</td>
      <td>Own</td>
      <td>147</td>
      <td>143</td>
      <td>75</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>143</td>
      <td>112</td>
      <td>161</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>New York</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>146</td>
      <td>126</td>
      <td>185</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>New York</td>
      <td>Male</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>161</td>
      <td>116</td>
      <td>76</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>189</td>
      <td>145</td>
      <td>203</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>New York</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Own</td>
      <td>197</td>
      <td>141</td>
      <td>154</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>143</td>
      <td>118</td>
      <td>72</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Just to demonstrate, melt-ing the first five rows of the df
df.head().melt(id_vars = ['state', 'gender'], value_vars = ['computers', 'income'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Female</td>
      <td>computers</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Female</td>
      <td>computers</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>Female</td>
      <td>computers</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>computers</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Female</td>
      <td>computers</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Florida</td>
      <td>Female</td>
      <td>income</td>
      <td>65</td>
    </tr>
    <tr>
      <th>6</th>
      <td>New York</td>
      <td>Female</td>
      <td>income</td>
      <td>114</td>
    </tr>
    <tr>
      <th>7</th>
      <td>New York</td>
      <td>Female</td>
      <td>income</td>
      <td>246</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Male</td>
      <td>income</td>
      <td>75</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Florida</td>
      <td>Female</td>
      <td>income</td>
      <td>161</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="groupby">Groupby</h3>
<p>Groupby returns a groupby object, to which other agg functions can be applied.  </p>
<ul>
<li>
<p>Groupby does the 'split' part in the split-apply-combine framework.</p>
</li>
<li>
<p>You do the 'apply' using an aggregation function against the groupby object.  </p>
</li>
<li>
<p>'Combine' doesn't need to be done separately as it is done automatically after the aggregation function is applied.</p>
</li>
</ul>
<pre><code class="language-python"># Simple example

df.groupby(['state', 'gender']).agg({&quot;height&quot;: &quot;mean&quot;, &quot;weight&quot;: &quot;sum&quot;, &quot;housing&quot;: &quot;count&quot;, &quot;education&quot;: &quot;count&quot;})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>height</th>
      <th>weight</th>
      <th>housing</th>
      <th>education</th>
    </tr>
    <tr>
      <th>state</th>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Florida</th>
      <th>Female</th>
      <td>168.00</td>
      <td>479</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>147.00</td>
      <td>143</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New York</th>
      <th>Female</th>
      <td>165.25</td>
      <td>540</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>161.00</td>
      <td>116</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Aggregation is done only for the columns for which an aggregation function is specified

df.groupby(['state', 'gender']).agg({&quot;height&quot;: &quot;mean&quot;, &quot;weight&quot;: &quot;sum&quot;, &quot;housing&quot;: &quot;count&quot;})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>height</th>
      <th>weight</th>
      <th>housing</th>
    </tr>
    <tr>
      <th>state</th>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Florida</th>
      <th>Female</th>
      <td>168.00</td>
      <td>479</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>147.00</td>
      <td>143</td>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New York</th>
      <th>Female</th>
      <td>165.25</td>
      <td>540</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>161.00</td>
      <td>116</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df.groupby(['state', 'gender']).head(1).agg({&quot;height&quot;: &quot;mean&quot;, &quot;weight&quot;: &quot;sum&quot;, &quot;housing&quot;: &quot;count&quot;, &quot;education&quot;: &quot;count&quot;})
</code></pre>
<pre><code>height       163.25
weight       487.00
housing        4.00
education      4.00
dtype: float64
</code></pre>
<pre><code class="language-python">group = df.groupby(['state', 'gender'])
</code></pre>
<pre><code class="language-python"># How to look at groups in a groupby:
list(group)
</code></pre>
<pre><code>[(('Florida', 'Female'),
       state  gender  education housing  height  weight  income  computers
  0  Florida  Female  Undergrad     Own     197     104      65          1
  4  Florida  Female  Undergrad    Rent     143     112     161          3
  7  Florida  Female  Undergrad     Own     189     145     203          3
  9  Florida  Female  Undergrad    Rent     143     118      72          0),
 (('Florida', 'Male'),
       state gender education housing  height  weight  income  computers
  3  Florida   Male      Grad     Own     147     143      75          4),
 (('New York', 'Female'),
        state  gender    education housing  height  weight  income  computers
  1  New York  Female         Grad    Rent     148     124     114          3
  2  New York  Female  High School    Rent     170     149     246          5
  5  New York  Female    Undergrad    Rent     146     126     185          5
  8  New York  Female         Grad     Own     197     141     154          0),
 (('New York', 'Male'),
        state gender  education housing  height  weight  income  computers
  6  New York   Male  Undergrad     Own     161     116      76          1)]
</code></pre>
<pre><code class="language-python">list(group)[0][1]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>education</th>
      <th>housing</th>
      <th>height</th>
      <th>weight</th>
      <th>income</th>
      <th>computers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>197</td>
      <td>104</td>
      <td>65</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>143</td>
      <td>112</td>
      <td>161</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>189</td>
      <td>145</td>
      <td>203</td>
      <td>3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Rent</td>
      <td>143</td>
      <td>118</td>
      <td>72</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">type(group)
</code></pre>
<pre><code>pandas.core.groupby.generic.DataFrameGroupBy
</code></pre>
<pre><code class="language-python"># Look at groups in a groupby - more elegant version:
for group_name, combined in group:
    print(group_name)
    print(combined)
    print('\n')
</code></pre>
<pre><code>('Florida', 'Female')
     state  gender  education housing  height  weight  income  computers
0  Florida  Female  Undergrad     Own     197     104      65          1
4  Florida  Female  Undergrad    Rent     143     112     161          3
7  Florida  Female  Undergrad     Own     189     145     203          3
9  Florida  Female  Undergrad    Rent     143     118      72          0


('Florida', 'Male')
     state gender education housing  height  weight  income  computers
3  Florida   Male      Grad     Own     147     143      75          4


('New York', 'Female')
      state  gender    education housing  height  weight  income  computers
1  New York  Female         Grad    Rent     148     124     114          3
2  New York  Female  High School    Rent     170     149     246          5
5  New York  Female    Undergrad    Rent     146     126     185          5
8  New York  Female         Grad     Own     197     141     154          0


('New York', 'Male')
      state gender  education housing  height  weight  income  computers
6  New York   Male  Undergrad     Own     161     116      76          1
</code></pre>
<pre><code class="language-python"># How to look at a specific group - the group categorical values have to be entered as a tuple
group.get_group(('New York', 'Male'))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>education</th>
      <th>housing</th>
      <th>height</th>
      <th>weight</th>
      <th>income</th>
      <th>computers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>New York</td>
      <td>Male</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>161</td>
      <td>116</td>
      <td>76</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># get the first row of each group

group.first()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>education</th>
      <th>housing</th>
      <th>height</th>
      <th>weight</th>
      <th>income</th>
      <th>computers</th>
    </tr>
    <tr>
      <th>state</th>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Florida</th>
      <th>Female</th>
      <td>Undergrad</td>
      <td>Own</td>
      <td>197</td>
      <td>104</td>
      <td>65</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>Grad</td>
      <td>Own</td>
      <td>147</td>
      <td>143</td>
      <td>75</td>
      <td>4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New York</th>
      <th>Female</th>
      <td>Grad</td>
      <td>Rent</td>
      <td>148</td>
      <td>124</td>
      <td>114</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>Undergrad</td>
      <td>Own</td>
      <td>161</td>
      <td>116</td>
      <td>76</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Get the first record of each group.
# For this to be useful, sort the original df by the right columns before groupby.

group.head(1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>education</th>
      <th>housing</th>
      <th>height</th>
      <th>weight</th>
      <th>income</th>
      <th>computers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Female</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>197</td>
      <td>104</td>
      <td>65</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Female</td>
      <td>Grad</td>
      <td>Rent</td>
      <td>148</td>
      <td>124</td>
      <td>114</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Grad</td>
      <td>Own</td>
      <td>147</td>
      <td>143</td>
      <td>75</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>New York</td>
      <td>Male</td>
      <td>Undergrad</td>
      <td>Own</td>
      <td>161</td>
      <td>116</td>
      <td>76</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Summary stats for all groups

group.describe()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="8" halign="left">height</th>
      <th colspan="2" halign="left">weight</th>
      <th>...</th>
      <th colspan="2" halign="left">income</th>
      <th colspan="8" halign="left">computers</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>...</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>state</th>
      <th>gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Florida</th>
      <th>Female</th>
      <td>4.0</td>
      <td>168.00</td>
      <td>29.051678</td>
      <td>143.0</td>
      <td>143.0</td>
      <td>166.0</td>
      <td>191.00</td>
      <td>197.0</td>
      <td>4.0</td>
      <td>119.75</td>
      <td>...</td>
      <td>171.50</td>
      <td>203.0</td>
      <td>4.0</td>
      <td>1.75</td>
      <td>1.500000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>1.0</td>
      <td>147.00</td>
      <td>NaN</td>
      <td>147.0</td>
      <td>147.0</td>
      <td>147.0</td>
      <td>147.00</td>
      <td>147.0</td>
      <td>1.0</td>
      <td>143.00</td>
      <td>...</td>
      <td>75.00</td>
      <td>75.0</td>
      <td>1.0</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.00</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New York</th>
      <th>Female</th>
      <td>4.0</td>
      <td>165.25</td>
      <td>23.796008</td>
      <td>146.0</td>
      <td>147.5</td>
      <td>159.0</td>
      <td>176.75</td>
      <td>197.0</td>
      <td>4.0</td>
      <td>135.00</td>
      <td>...</td>
      <td>200.25</td>
      <td>246.0</td>
      <td>4.0</td>
      <td>3.25</td>
      <td>2.362908</td>
      <td>0.0</td>
      <td>2.25</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Male</th>
      <td>1.0</td>
      <td>161.00</td>
      <td>NaN</td>
      <td>161.0</td>
      <td>161.0</td>
      <td>161.0</td>
      <td>161.00</td>
      <td>161.0</td>
      <td>1.0</td>
      <td>116.00</td>
      <td>...</td>
      <td>76.00</td>
      <td>76.0</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 32 columns</p>
</div>

<pre><code class="language-python"># Or, if you prefer this

group.describe().reset_index()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th colspan="8" halign="left">height</th>
      <th>...</th>
      <th colspan="2" halign="left">income</th>
      <th colspan="8" halign="left">computers</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>...</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Female</td>
      <td>4.0</td>
      <td>168.00</td>
      <td>29.051678</td>
      <td>143.0</td>
      <td>143.0</td>
      <td>166.0</td>
      <td>191.00</td>
      <td>197.0</td>
      <td>...</td>
      <td>171.50</td>
      <td>203.0</td>
      <td>4.0</td>
      <td>1.75</td>
      <td>1.500000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>Male</td>
      <td>1.0</td>
      <td>147.00</td>
      <td>NaN</td>
      <td>147.0</td>
      <td>147.0</td>
      <td>147.0</td>
      <td>147.00</td>
      <td>147.0</td>
      <td>...</td>
      <td>75.00</td>
      <td>75.0</td>
      <td>1.0</td>
      <td>4.00</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.00</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>Female</td>
      <td>4.0</td>
      <td>165.25</td>
      <td>23.796008</td>
      <td>146.0</td>
      <td>147.5</td>
      <td>159.0</td>
      <td>176.75</td>
      <td>197.0</td>
      <td>...</td>
      <td>200.25</td>
      <td>246.0</td>
      <td>4.0</td>
      <td>3.25</td>
      <td>2.362908</td>
      <td>0.0</td>
      <td>2.25</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>New York</td>
      <td>Male</td>
      <td>1.0</td>
      <td>161.00</td>
      <td>NaN</td>
      <td>161.0</td>
      <td>161.0</td>
      <td>161.0</td>
      <td>161.00</td>
      <td>161.0</td>
      <td>...</td>
      <td>76.00</td>
      <td>76.0</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 34 columns</p>
</div>

<pre><code class="language-python"># Get the count of rows in each group.
# You can pd.DataFrame it, and reset_index() to clean up

group.size()
</code></pre>
<pre><code>state     gender
Florida   Female    4
          Male      1
New York  Female    4
          Male      1
dtype: int64
</code></pre>
<pre><code class="language-python"># Getting min and max values in each group using groupby

mtcars = sm.datasets.get_rdataset('mtcars').data
</code></pre>
<pre><code class="language-python">mtcars
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>6</td>
      <td>225.0</td>
      <td>105</td>
      <td>2.76</td>
      <td>3.460</td>
      <td>20.22</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>8</td>
      <td>360.0</td>
      <td>245</td>
      <td>3.21</td>
      <td>3.570</td>
      <td>15.84</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>4</td>
      <td>146.7</td>
      <td>62</td>
      <td>3.69</td>
      <td>3.190</td>
      <td>20.00</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Merc 230</th>
      <td>22.8</td>
      <td>4</td>
      <td>140.8</td>
      <td>95</td>
      <td>3.92</td>
      <td>3.150</td>
      <td>22.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Merc 280</th>
      <td>19.2</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.30</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 280C</th>
      <td>17.8</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 450SE</th>
      <td>16.4</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>4.070</td>
      <td>17.40</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Merc 450SL</th>
      <td>17.3</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.730</td>
      <td>17.60</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Merc 450SLC</th>
      <td>15.2</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.780</td>
      <td>18.00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Cadillac Fleetwood</th>
      <td>10.4</td>
      <td>8</td>
      <td>472.0</td>
      <td>205</td>
      <td>2.93</td>
      <td>5.250</td>
      <td>17.98</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Lincoln Continental</th>
      <td>10.4</td>
      <td>8</td>
      <td>460.0</td>
      <td>215</td>
      <td>3.00</td>
      <td>5.424</td>
      <td>17.82</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Chrysler Imperial</th>
      <td>14.7</td>
      <td>8</td>
      <td>440.0</td>
      <td>230</td>
      <td>3.23</td>
      <td>5.345</td>
      <td>17.42</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Fiat 128</th>
      <td>32.4</td>
      <td>4</td>
      <td>78.7</td>
      <td>66</td>
      <td>4.08</td>
      <td>2.200</td>
      <td>19.47</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Honda Civic</th>
      <td>30.4</td>
      <td>4</td>
      <td>75.7</td>
      <td>52</td>
      <td>4.93</td>
      <td>1.615</td>
      <td>18.52</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Toyota Corolla</th>
      <td>33.9</td>
      <td>4</td>
      <td>71.1</td>
      <td>65</td>
      <td>4.22</td>
      <td>1.835</td>
      <td>19.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Toyota Corona</th>
      <td>21.5</td>
      <td>4</td>
      <td>120.1</td>
      <td>97</td>
      <td>3.70</td>
      <td>2.465</td>
      <td>20.01</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Dodge Challenger</th>
      <td>15.5</td>
      <td>8</td>
      <td>318.0</td>
      <td>150</td>
      <td>2.76</td>
      <td>3.520</td>
      <td>16.87</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>AMC Javelin</th>
      <td>15.2</td>
      <td>8</td>
      <td>304.0</td>
      <td>150</td>
      <td>3.15</td>
      <td>3.435</td>
      <td>17.30</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Camaro Z28</th>
      <td>13.3</td>
      <td>8</td>
      <td>350.0</td>
      <td>245</td>
      <td>3.73</td>
      <td>3.840</td>
      <td>15.41</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Pontiac Firebird</th>
      <td>19.2</td>
      <td>8</td>
      <td>400.0</td>
      <td>175</td>
      <td>3.08</td>
      <td>3.845</td>
      <td>17.05</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Fiat X1-9</th>
      <td>27.3</td>
      <td>4</td>
      <td>79.0</td>
      <td>66</td>
      <td>4.08</td>
      <td>1.935</td>
      <td>18.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Porsche 914-2</th>
      <td>26.0</td>
      <td>4</td>
      <td>120.3</td>
      <td>91</td>
      <td>4.43</td>
      <td>2.140</td>
      <td>16.70</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Lotus Europa</th>
      <td>30.4</td>
      <td>4</td>
      <td>95.1</td>
      <td>113</td>
      <td>3.77</td>
      <td>1.513</td>
      <td>16.90</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Ford Pantera L</th>
      <td>15.8</td>
      <td>8</td>
      <td>351.0</td>
      <td>264</td>
      <td>4.22</td>
      <td>3.170</td>
      <td>14.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Ferrari Dino</th>
      <td>19.7</td>
      <td>6</td>
      <td>145.0</td>
      <td>175</td>
      <td>3.62</td>
      <td>2.770</td>
      <td>15.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Maserati Bora</th>
      <td>15.0</td>
      <td>8</td>
      <td>301.0</td>
      <td>335</td>
      <td>3.54</td>
      <td>3.570</td>
      <td>14.60</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Volvo 142E</th>
      <td>21.4</td>
      <td>4</td>
      <td>121.0</td>
      <td>109</td>
      <td>4.11</td>
      <td>2.780</td>
      <td>18.60</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars.groupby(['cyl']).agg('mean')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>cyl</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>26.663636</td>
      <td>105.136364</td>
      <td>82.636364</td>
      <td>4.070909</td>
      <td>2.285727</td>
      <td>19.137273</td>
      <td>0.909091</td>
      <td>0.727273</td>
      <td>4.090909</td>
      <td>1.545455</td>
    </tr>
    <tr>
      <th>6</th>
      <td>19.742857</td>
      <td>183.314286</td>
      <td>122.285714</td>
      <td>3.585714</td>
      <td>3.117143</td>
      <td>17.977143</td>
      <td>0.571429</td>
      <td>0.428571</td>
      <td>3.857143</td>
      <td>3.428571</td>
    </tr>
    <tr>
      <th>8</th>
      <td>15.100000</td>
      <td>353.100000</td>
      <td>209.214286</td>
      <td>3.229286</td>
      <td>3.999214</td>
      <td>16.772143</td>
      <td>0.000000</td>
      <td>0.142857</td>
      <td>3.285714</td>
      <td>3.500000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># See which rows have the min values in each column of a groupby.  The index of the row is returned
# Which in this case is happily the car name, not an integer

mtcars.groupby(['cyl']).idxmin()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>cyl</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Volvo 142E</td>
      <td>Toyota Corolla</td>
      <td>Honda Civic</td>
      <td>Merc 240D</td>
      <td>Lotus Europa</td>
      <td>Porsche 914-2</td>
      <td>Porsche 914-2</td>
      <td>Merc 240D</td>
      <td>Toyota Corona</td>
      <td>Datsun 710</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Merc 280C</td>
      <td>Ferrari Dino</td>
      <td>Valiant</td>
      <td>Valiant</td>
      <td>Mazda RX4</td>
      <td>Ferrari Dino</td>
      <td>Mazda RX4</td>
      <td>Hornet 4 Drive</td>
      <td>Hornet 4 Drive</td>
      <td>Hornet 4 Drive</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Cadillac Fleetwood</td>
      <td>Merc 450SE</td>
      <td>Dodge Challenger</td>
      <td>Dodge Challenger</td>
      <td>Ford Pantera L</td>
      <td>Ford Pantera L</td>
      <td>Hornet Sportabout</td>
      <td>Hornet Sportabout</td>
      <td>Hornet Sportabout</td>
      <td>Hornet Sportabout</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars.groupby(['cyl']).idxmax()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>cyl</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Toyota Corolla</td>
      <td>Merc 240D</td>
      <td>Lotus Europa</td>
      <td>Honda Civic</td>
      <td>Merc 240D</td>
      <td>Merc 230</td>
      <td>Datsun 710</td>
      <td>Datsun 710</td>
      <td>Porsche 914-2</td>
      <td>Merc 240D</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Hornet 4 Drive</td>
      <td>Hornet 4 Drive</td>
      <td>Ferrari Dino</td>
      <td>Merc 280</td>
      <td>Valiant</td>
      <td>Valiant</td>
      <td>Hornet 4 Drive</td>
      <td>Mazda RX4</td>
      <td>Ferrari Dino</td>
      <td>Ferrari Dino</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Pontiac Firebird</td>
      <td>Cadillac Fleetwood</td>
      <td>Maserati Bora</td>
      <td>Ford Pantera L</td>
      <td>Lincoln Continental</td>
      <td>Merc 450SLC</td>
      <td>Hornet Sportabout</td>
      <td>Ford Pantera L</td>
      <td>Ford Pantera L</td>
      <td>Maserati Bora</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong><code>rename</code> columns with Groupby</strong></p>
<pre><code class="language-python"># We continue the above examples to rename the aggregated columns we created using groupby

diamonds.groupby('cut').agg({&quot;price&quot;: &quot;sum&quot;, 
                             &quot;clarity&quot;: &quot;count&quot;}).rename(columns = {&quot;price&quot;: &quot;total_price&quot;, &quot;clarity&quot;: &quot;diamond_count&quot;})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_price</th>
      <th>diamond_count</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>74513487</td>
      <td>21551</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>63221498</td>
      <td>13791</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>48107623</td>
      <td>12082</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>19275009</td>
      <td>4906</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>7017600</td>
      <td>1610</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="pandas-profiling">Pandas Profiling</h2>
<h3 id="profiling-our-toy-dataframe">Profiling our toy dataframe</h3>
<pre><code class="language-python">import ydata_profiling
profile = ydata_profiling.ProfileReport(df, title = 'My EDA', minimal=True).to_file(&quot;output.html&quot;)
</code></pre>
<pre><code>Summarize dataset:   0%|          | 0/5 [00:00&lt;?, ?it/s]



Generate report structure:   0%|          | 0/1 [00:00&lt;?, ?it/s]



Render HTML:   0%|          | 0/1 [00:00&lt;?, ?it/s]



Export report to file:   0%|          | 0/1 [00:00&lt;?, ?it/s]
</code></pre>
<p>--  </p>
<p>Now check out output.html in your folder.  You can right click and open output.html in the browser.</p>
<h3 id="pandas-profiling-on-the-diamonds-dataset">Pandas Profiling on the Diamonds Dataset</h3>
<pre><code class="language-python"># Import libraries and the diamonds dataset
import pandas as pd
import numpy as np
import seaborn as sns
import os
import ydata_profiling
import phik
import matplotlib.pyplot as plt

df = sns.load_dataset('diamonds')
</code></pre>
<pre><code class="language-python">profile = ydata_profiling.ProfileReport(df, title = 'My EDA', minimal=True).to_file(&quot;output.html&quot;)
</code></pre>
<pre><code>Summarize dataset:   0%|          | 0/5 [00:00&lt;?, ?it/s]



Generate report structure:   0%|          | 0/1 [00:00&lt;?, ?it/s]



Render HTML:   0%|          | 0/1 [00:00&lt;?, ?it/s]



Export report to file:   0%|          | 0/1 [00:00&lt;?, ?it/s]
</code></pre>
<hr />
<p>With this, we end our discussion on EDA.  We have seen how we can analyze data, get statistics, distributions and identify key themes.  Since this is a problem that has to be solved for every day by lots of analysts, there are many libraries devoted to EDA that automate much of the work.  We looked at one - <code>pandas_profiling</code>.  If you search, you will find several more, and may even find something that work best for your use case.</p>
<p>If you have been able to follow thus far, you are all set to explore any numerical data in a tabular form.   </p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Introduction to Business Analytics"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../03_Visualization_Basics/" class="btn btn-neutral float-right" title="Visualization Basics">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../03_Visualization_Basics/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
