<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Data Preparation - Business Analytics, Mukul Pareek</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Data Preparation";
        var mkdocs_page_input_path = "04_Data_Preparation.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Business Analytics, Mukul Pareek
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Introduction to Business Analytics</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../02_Exploratory_Data_Analysis/">Exploratory Data Analysis</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../03_Visualization_Basics/">Visualization Basics</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Data Preparation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#data-manipulation-transformation-and-cleaning">Data Manipulation, Transformation and Cleaning</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#reshaping-data">Reshaping Data</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#the-setup">The Setup</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#create-a-dataframe">Create a DataFrame</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#read-the-diamonds-and-mtcars-dataframes">Read the diamonds and mtcars dataframes</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#selecting-columns">Selecting columns</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#select-rows-queries">Select rows (queries)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#subsetting-with-loc-and-iloc">Subsetting with loc and iloc</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#understanding-data-types">Understanding Data Types</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#change-column-to-categorical">Change column to categorical</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#how-to-list-categories">How to list categories</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#get-column-names">Get column names</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#add-columns">Add Columns</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#add-column-with-insert">Add column with insert</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#add-column-with-assign">Add column with assign</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#delete-columns">Delete Columns</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#reordering-columns">Reordering Columns</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sorting-values">Sorting Values</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#renaming-columns">Renaming Columns</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#removing-duplicates">Removing Duplicates</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#replacing-values">Replacing Values</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#binning-using-pandas-cut-function">Binning using Pandas cut Function</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#binning-into-quantiles-using-qcut">Binning into Quantiles using qcut</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#select-a-random-sample-of-data">Select a random sample of data</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#string-operations-with-pandas">String operations with Pandas</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#value-counts">Value Counts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#extract-unique-values">Extract unique values</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#groupby">Groupby</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#rename-columns-with-groupby">rename columns with Groupby</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#joining-data-with-merge">Joining Data with Merge</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#left-join">Left Join</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#right-join">Right Join</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#inner-join">Inner Join</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#outer-join">Outer Join</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#concatenation">Concatenation</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#concatenation-example">Concatenation example</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dealing-with-missing-values">Dealing with Missing Values</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#understanding-the-extent-of-missing-values">Understanding the extent of missing values</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#how-to-think-about-missing-values">How to think about missing values</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#drop-missing-values">Drop Missing Values</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#fill-missing-data">Fill Missing Data</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#forward-and-backward-fill">Forward and Backward Fill</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#imputation-using-sklearn">Imputation using sklearn</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#iterative-imputer-sklearn">Iterative Imputer (sklearn)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#knn-imputer">KNN Imputer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#list-comprehension-and-other-useful-tricks">List Comprehension and Other Useful Tricks</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../05_Introduction_to_Modeling/">Introduction to Modeling</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../06_Recommender_Systems/">Recommender Systems</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../07_Regression/">Regression</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../08_Feature_Engineering/">Feature Engineering</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../09_Machine_Learning/">Machine Learning</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../10_Deep_Learning/">Deep Learning</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../11_Time_Series/">Time Series</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../12_Text_Data/">Text as Data</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../13.1_Transformers_and_LLMs/">Transformers and LLMs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../13.2_OpenAI/">OpenAI</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../13.3_Local_LLMs/">Local LLMs</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Business Analytics, Mukul Pareek</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Data Preparation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="data-preparation">Data Preparation</h1>
<h2 id="data-manipulation-transformation-and-cleaning">Data Manipulation, Transformation and Cleaning</h2>
<h2 id="reshaping-data">Reshaping Data</h2>
<p>A significant challenge with analytics is that the required data is rarely collected with a view to perform analytics.  It is mostly intended to support transaction processing, or managing operations. Data is often ‘dirty’, meaning data can be missing, duplicated, in the wrong formats, in different data sources/files, have character-set issues, require additional mappings, and so on.</p>
<p>Data analysts spend a great deal of time cleaning and preparing data for analysis.  In traditional business intelligence contexts, data cleaning and transformations are referred to as ETL processes (Extract-Transfer-Load).</p>
<p>Data scientists often set up defined ‘data pipelines’ – a series of data processing steps that ingest and bring data to a desired format and shape.  </p>
<p>During the rest of this chapter, we will see how we can select and filter data, understand data types, add and delete columns in tabular data, replace values, deal with missing values, and more.  We will do all of this primarily using <em>pandas</em>, and also a few other libraries.  </p>
<p>So what is it that we do when we reshape and clean data?  While of course this would almost always depend upon the data and what shape we are trying to get it to, there are several common actions that we have to perform that we should know about.  </p>
<ul>
<li>
<p><strong>Select columns</strong>: with a view to reducing the number of data fields we have to deal with by dropping the un-needed columns and retaining only the rest.</p>
</li>
<li>
<p><strong>Selecting rows</strong>: filter out observations based on some criteria as to retain only the observations of relevance to us.</p>
</li>
<li>
<p><strong>Change data types</strong>: Dates or numbers may be formatted as strings, or categories may appear as numbers.  We may need to change the data types to suit our needs.  </p>
</li>
<li>
<p><strong>Add columns</strong>: We may need to insert new calculated columns, or bring in data from other data sources as additional features or columns to our dataset.  </p>
</li>
<li>
<p><strong>Reorder or sort columns and rows</strong>: We may need to rearrange the columns and rows in our data to support understanding and presentation.</p>
</li>
<li>
<p><strong>Rename fields</strong>: to remove spaces, special characters, or renaming them as to be more humanly readable.  </p>
</li>
<li>
<p><strong>Remove duplicates</strong>: We may need to remove duplicate observations.</p>
</li>
<li>
<p><strong>Replace values</strong>: Often we may have a need to change one value in the data for another, for example, replace United Kingdom with the letters UK.</p>
</li>
<li>
<p><strong>Bin numerical data</strong>: We may need to convert numerical data to categories by grouping them into bins.  For example, we may like to call homes with 4 to 6 bedromms as 'Large', converting a numerical column to a binned category.</p>
</li>
<li>
<p><strong>Extract unique values</strong>: to understand the data better.  </p>
</li>
<li>
<p><strong>Combine</strong>: with other data sources as to enrich the information we already have.  </p>
</li>
<li>
<p><strong>Missing values</strong>: We might like to fill in missing values for a more complete dataset, or remove data with missing values from our dataset.</p>
</li>
<li>
<p><strong>Summarize</strong>: using groupby or pivot functions to summarize or 'elongate' the data as to make it more suitable for use in subsequent analysis.  (Also called melting and casting)  </p>
</li>
</ul>
<p>In the end, we want to have the capability to twist and shape data in the way we need it for our analysis.  Python provides us tools and libraries that give us incredible flexibility in being able to do so.  </p>
<p>Missing values deserve a special mention.  We will also look at length on missing values, where we don't have all the data for every observation.  What are we to do in such a case?  Should we ignore the observations that are missing any data, and risk losing the data that we have, or try to compensate for the missing data using some smart thinking as to keep the available information?</p>
<p>In the rest of this discussion, we will cover some of these techniques.  This is of course not a complete list of everything a data analyst is able to do to reshape and reformat data, for such a list would be impossible.  Data manipulation is also closely related to feature engineering, which is discussed in a subsequent chapter.</p>
<p>Before we get started, we will create a random dataframe to play with.  </p>
<h2 id="the-setup">The Setup</h2>
<p><strong>Usual library imports</strong></p>
<pre><code class="language-python">import seaborn as sns
import pandas as pd
import numpy as np
import statsmodels.api as sm
import os
</code></pre>
<h3 id="create-a-dataframe">Create a DataFrame</h3>
<p>We start with creating a dataframe, which is akin to a spreadsheet.</p>
<p>There are many ways to create a dataframe.  When you read a datafile using pandas (for example, using <code>pd.read_csv</code>), a dataframe is automatically created.  </p>
<p>But sometimes you may not have a datafile, and you may need to create a dataframe using code.  The below examples describe several different ways of doing so.  The basic construct is <code>pd.DataFrame(data, index, columns)</code>.  <code>data</code> can be a list, or a dictionary, an array etc.  <code>index</code> refers to the names you want to give to the rows.  If you don't specify index, pandas will just number them starting with 0.  <code>columns</code> means the names of the columns that you want to see, and if you leave them blank, pandas will just use numbers starting with zero.</p>
<p>Some examples of creating a dataframe appear below.  You can modify them to your use case as required.  </p>
<pre><code class="language-python"># Here we create a dataframe from a dictionary.  First, we define a dictionary.
# Then we supply the dictionary as data to pd.DataFrame.

data = {'state': ['New York', 'Florida', 'Arizona'],
        'year': ['1999', '2000', '2001'],
        'pop': [100, 121, 132]}
</code></pre>
<pre><code class="language-python">#Check the data type

type(data)
</code></pre>
<pre><code>dict
</code></pre>
<pre><code class="language-python">## Convert it to a dataframe

mydf = pd.DataFrame(data)
mydf
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New York</td>
      <td>1999</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>2000</td>
      <td>121</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arizona</td>
      <td>2001</td>
      <td>132</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## or another way...

df = pd.DataFrame(np.random.randint(0,100,size=(100, 4)), columns=list('ABCD'))
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>95</td>
      <td>71</td>
      <td>21</td>
      <td>95</td>
    </tr>
    <tr>
      <th>1</th>
      <td>55</td>
      <td>6</td>
      <td>35</td>
      <td>53</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29</td>
      <td>98</td>
      <td>82</td>
      <td>11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>46</td>
      <td>16</td>
      <td>94</td>
      <td>84</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>74</td>
      <td>53</td>
      <td>51</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>9</td>
      <td>40</td>
      <td>23</td>
      <td>80</td>
    </tr>
    <tr>
      <th>96</th>
      <td>54</td>
      <td>11</td>
      <td>33</td>
      <td>38</td>
    </tr>
    <tr>
      <th>97</th>
      <td>51</td>
      <td>68</td>
      <td>29</td>
      <td>40</td>
    </tr>
    <tr>
      <th>98</th>
      <td>61</td>
      <td>64</td>
      <td>3</td>
      <td>51</td>
    </tr>
    <tr>
      <th>99</th>
      <td>17</td>
      <td>10</td>
      <td>91</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 4 columns</p>
</div>

<p><strong>Multiple ways to create the same dataframe</strong>  </p>
<p>Imagine we have the population of the five boroughs of New York in 2020 as follows:</p>
<table>
<thead>
<tr>
<th>Borough</th>
<th>Population</th>
</tr>
</thead>
<tbody>
<tr>
<td>BRONX</td>
<td>1446788</td>
</tr>
<tr>
<td>BROOKLYN</td>
<td>2648452</td>
</tr>
<tr>
<td>MANHATTAN</td>
<td>1638281</td>
</tr>
<tr>
<td>QUEENS</td>
<td>2330295</td>
</tr>
<tr>
<td>STATEN ISLAND</td>
<td>487155</td>
</tr>
</tbody>
</table>
<p>We want this information as a dataframe so we can join it with other information we might have on the boroughs.</p>
<p>Try to create a dataframe from the above data.  Several ways to do so listed below.  </p>
<pre><code class="language-python"># See here that we are specifying the index
pop = pd.DataFrame(data = [1446788, 2648452, 1638281, 2330295, 487155], 
             index = ['BRONX', 'BROOKLYN', 'MANHATTAN', 'QUEENS', 'STATEN ISLAND'], 
             columns = ['population'])

pop
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>1446788</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>2648452</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1638281</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>2330295</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>487155</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Same thing, but here we keep the borough name as a column
pop = pd.DataFrame(data = {'population': [1446788, 2648452, 1638281, 2330295, 487155], 
             'BOROUGH': ['BRONX', 'BROOKLYN', 'MANHATTAN', 'QUEENS', 'STATEN ISLAND']},) 

pop
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>BOROUGH</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1446788</td>
      <td>BRONX</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2648452</td>
      <td>BROOKLYN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1638281</td>
      <td>MANHATTAN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2330295</td>
      <td>QUEENS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>487155</td>
      <td>STATEN ISLAND</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Yet another way of creating the same dataframe

pop = pd.DataFrame({'population': {'BRONX': 1446788,
  'BROOKLYN': 2648452,
  'MANHATTAN': 1638281,
  'QUEENS': 2330295,
  'STATEN ISLAND': 487155}})
pop
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>1446788</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>2648452</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1638281</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>2330295</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>487155</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Same thing as earlier, but with borough name in the index
pop = pd.DataFrame({'population': [1446788, 2648452, 1638281, 2330295, 487155]}, 
                   index = ['BRONX', 'BROOKLYN', 'MANHATTAN', 'QUEENS', 'STATEN ISLAND'],)
pop
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BRONX</th>
      <td>1446788</td>
    </tr>
    <tr>
      <th>BROOKLYN</th>
      <td>2648452</td>
    </tr>
    <tr>
      <th>MANHATTAN</th>
      <td>1638281</td>
    </tr>
    <tr>
      <th>QUEENS</th>
      <td>2330295</td>
    </tr>
    <tr>
      <th>STATEN ISLAND</th>
      <td>487155</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Get the current working directory

os.getcwd()
</code></pre>
<pre><code>'C:\\Users\\user\\Google Drive\\jupyter'
</code></pre>
<h3 id="read-the-diamonds-and-mtcars-dataframes">Read the diamonds and mtcars dataframes</h3>
<p>The ‘diamonds’ has 50k+ records, each representing a single diamond.  The weight and other attributes are available, and so is the price.</p>
<p>The dataset allows us to experiment with a variety of prediction techniques and algorithms.  Below are the columns in the dataset, and their description.</p>
<table>
<thead>
<tr>
<th>Col</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>price</td>
<td>price in US dollars (\$326--\$18,823)</td>
</tr>
<tr>
<td>carat</td>
<td>weight of the diamond (0.2--5.01)</td>
</tr>
<tr>
<td>cut</td>
<td>quality of the cut (Fair, Good, Very Good, Premium, Ideal)</td>
</tr>
<tr>
<td>color</td>
<td>diamond colour, from J (worst) to D (best)</td>
</tr>
<tr>
<td>clarity</td>
<td>a measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best))</td>
</tr>
<tr>
<td>x</td>
<td>length in mm (0--10.74)</td>
</tr>
<tr>
<td>y</td>
<td>width in mm (0--58.9)</td>
</tr>
<tr>
<td>z</td>
<td>depth in mm (0--31.8)</td>
</tr>
<tr>
<td>depth</td>
<td>total depth percentage = z / mean(x, y) = 2 * z / (x + y) (43--79)</td>
</tr>
<tr>
<td>table</td>
<td>width of top of diamond relative to widest point (43--95)</td>
</tr>
</tbody>
</table>
<pre><code class="language-python">diamonds = sns.load_dataset(&quot;diamonds&quot;)
</code></pre>
<p><strong>We also load the mtcars dataset</strong>    </p>
<p><em>Description</em><br />
The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models).</p>
<p><em>Format</em><br />
A data frame with 32 observations on 11 (numeric) variables.</p>
<pre><code>[, 1]   mpg     Miles/(US) gallon
[, 2]   cyl     Number of cylinders
[, 3]   disp    Displacement (cu.in.)
[, 4]   hp      Gross horsepower
[, 5]   drat    Rear axle ratio
[, 6]   wt      Weight (1000 lbs)
[, 7]   qsec    1/4 mile time
[, 8]   vs      Engine (0 = V-shaped, 1 = straight)
[, 9]   am      Transmission (0 = automatic, 1 = manual)
[,10]   gear    Number of forward gears
[,11]   carb    Number of carburetors
</code></pre>
<p><em>Source: https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html</em></p>
<pre><code class="language-python"># Load the dataset

mtcars = sm.datasets.get_rdataset('mtcars').data
</code></pre>
<pre><code class="language-python">mtcars.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>rownames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="selecting-columns">Selecting columns</h2>
<p>Datasets may sometimes have hundreds of columns, or features.  Many features may be redundant, or unrelated to our analytical needs.  Many columns may have too many null values to be of practical use.</p>
<p>Several ways to select columns with Pandas:<br />
- Select a single column with: <code>df['column_name']</code>
- Or multiple columns using: <code>df[['col1', 'col2', 'col3’]]</code>
- Or look for a string in a column name <code>df[col for col in df.columns if 'string' in col]</code>
- Or select based on column positions with <code>df.iloc[:, 2:3]</code> etc.</p>
<pre><code class="language-python">diamonds[['carat', 'price', 'color']]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>price</th>
      <th>color</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>326</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>326</td>
      <td>E</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>327</td>
      <td>E</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>334</td>
      <td>I</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>335</td>
      <td>J</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53935</th>
      <td>0.72</td>
      <td>2757</td>
      <td>D</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>0.72</td>
      <td>2757</td>
      <td>D</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>0.70</td>
      <td>2757</td>
      <td>D</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>2757</td>
      <td>H</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>0.75</td>
      <td>2757</td>
      <td>D</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 3 columns</p>
</div>

<pre><code class="language-python">mtcars[['mpg', 'cyl', 'disp', 'hp', 'wt']]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>wt</th>
    </tr>
    <tr>
      <th>rownames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>2.620</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>2.875</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>2.320</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.215</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.440</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>6</td>
      <td>225.0</td>
      <td>105</td>
      <td>3.460</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>8</td>
      <td>360.0</td>
      <td>245</td>
      <td>3.570</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>4</td>
      <td>146.7</td>
      <td>62</td>
      <td>3.190</td>
    </tr>
    <tr>
      <th>Merc 230</th>
      <td>22.8</td>
      <td>4</td>
      <td>140.8</td>
      <td>95</td>
      <td>3.150</td>
    </tr>
    <tr>
      <th>Merc 280</th>
      <td>19.2</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.440</td>
    </tr>
    <tr>
      <th>Merc 280C</th>
      <td>17.8</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.440</td>
    </tr>
    <tr>
      <th>Merc 450SE</th>
      <td>16.4</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>4.070</td>
    </tr>
    <tr>
      <th>Merc 450SL</th>
      <td>17.3</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.730</td>
    </tr>
    <tr>
      <th>Merc 450SLC</th>
      <td>15.2</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.780</td>
    </tr>
    <tr>
      <th>Cadillac Fleetwood</th>
      <td>10.4</td>
      <td>8</td>
      <td>472.0</td>
      <td>205</td>
      <td>5.250</td>
    </tr>
    <tr>
      <th>Lincoln Continental</th>
      <td>10.4</td>
      <td>8</td>
      <td>460.0</td>
      <td>215</td>
      <td>5.424</td>
    </tr>
    <tr>
      <th>Chrysler Imperial</th>
      <td>14.7</td>
      <td>8</td>
      <td>440.0</td>
      <td>230</td>
      <td>5.345</td>
    </tr>
    <tr>
      <th>Fiat 128</th>
      <td>32.4</td>
      <td>4</td>
      <td>78.7</td>
      <td>66</td>
      <td>2.200</td>
    </tr>
    <tr>
      <th>Honda Civic</th>
      <td>30.4</td>
      <td>4</td>
      <td>75.7</td>
      <td>52</td>
      <td>1.615</td>
    </tr>
    <tr>
      <th>Toyota Corolla</th>
      <td>33.9</td>
      <td>4</td>
      <td>71.1</td>
      <td>65</td>
      <td>1.835</td>
    </tr>
    <tr>
      <th>Toyota Corona</th>
      <td>21.5</td>
      <td>4</td>
      <td>120.1</td>
      <td>97</td>
      <td>2.465</td>
    </tr>
    <tr>
      <th>Dodge Challenger</th>
      <td>15.5</td>
      <td>8</td>
      <td>318.0</td>
      <td>150</td>
      <td>3.520</td>
    </tr>
    <tr>
      <th>AMC Javelin</th>
      <td>15.2</td>
      <td>8</td>
      <td>304.0</td>
      <td>150</td>
      <td>3.435</td>
    </tr>
    <tr>
      <th>Camaro Z28</th>
      <td>13.3</td>
      <td>8</td>
      <td>350.0</td>
      <td>245</td>
      <td>3.840</td>
    </tr>
    <tr>
      <th>Pontiac Firebird</th>
      <td>19.2</td>
      <td>8</td>
      <td>400.0</td>
      <td>175</td>
      <td>3.845</td>
    </tr>
    <tr>
      <th>Fiat X1-9</th>
      <td>27.3</td>
      <td>4</td>
      <td>79.0</td>
      <td>66</td>
      <td>1.935</td>
    </tr>
    <tr>
      <th>Porsche 914-2</th>
      <td>26.0</td>
      <td>4</td>
      <td>120.3</td>
      <td>91</td>
      <td>2.140</td>
    </tr>
    <tr>
      <th>Lotus Europa</th>
      <td>30.4</td>
      <td>4</td>
      <td>95.1</td>
      <td>113</td>
      <td>1.513</td>
    </tr>
    <tr>
      <th>Ford Pantera L</th>
      <td>15.8</td>
      <td>8</td>
      <td>351.0</td>
      <td>264</td>
      <td>3.170</td>
    </tr>
    <tr>
      <th>Ferrari Dino</th>
      <td>19.7</td>
      <td>6</td>
      <td>145.0</td>
      <td>175</td>
      <td>2.770</td>
    </tr>
    <tr>
      <th>Maserati Bora</th>
      <td>15.0</td>
      <td>8</td>
      <td>301.0</td>
      <td>335</td>
      <td>3.570</td>
    </tr>
    <tr>
      <th>Volvo 142E</th>
      <td>21.4</td>
      <td>4</td>
      <td>121.0</td>
      <td>109</td>
      <td>2.780</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="select-rows-queries">Select rows (queries)</h2>
<p>Row selection is generally more complex, as we need to apply conditions to only select certain rows.
Multiple conditions can be applied simultaneously.</p>
<p>Two approaches in Pandas:
- The more reliable but verbose method: <code>df[(df.Col1 == 1) &amp; (df.col2 == 6)]</code>. This method allows greater flexibility, particularly when doing string searches inside rows.
- Use <code>.query</code>:  <code>df.query('conditions separated by &amp; or |')</code>.  This method works for most common situations, and the query is easier to construct
- Use <code>!=</code> for not-equal-to</p>
<pre><code class="language-python">diamonds.query('carat &gt; 3 &amp; cut == &quot;Premium&quot;')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19339</th>
      <td>3.01</td>
      <td>Premium</td>
      <td>I</td>
      <td>I1</td>
      <td>62.7</td>
      <td>58.0</td>
      <td>8040</td>
      <td>9.10</td>
      <td>8.97</td>
      <td>5.67</td>
    </tr>
    <tr>
      <th>21862</th>
      <td>3.01</td>
      <td>Premium</td>
      <td>F</td>
      <td>I1</td>
      <td>62.2</td>
      <td>56.0</td>
      <td>9925</td>
      <td>9.24</td>
      <td>9.13</td>
      <td>5.73</td>
    </tr>
    <tr>
      <th>22428</th>
      <td>3.05</td>
      <td>Premium</td>
      <td>E</td>
      <td>I1</td>
      <td>60.9</td>
      <td>58.0</td>
      <td>10453</td>
      <td>9.26</td>
      <td>9.25</td>
      <td>5.66</td>
    </tr>
    <tr>
      <th>24131</th>
      <td>3.24</td>
      <td>Premium</td>
      <td>H</td>
      <td>I1</td>
      <td>62.1</td>
      <td>58.0</td>
      <td>12300</td>
      <td>9.44</td>
      <td>9.40</td>
      <td>5.85</td>
    </tr>
    <tr>
      <th>25460</th>
      <td>3.01</td>
      <td>Premium</td>
      <td>G</td>
      <td>SI2</td>
      <td>59.8</td>
      <td>58.0</td>
      <td>14220</td>
      <td>9.44</td>
      <td>9.37</td>
      <td>5.62</td>
    </tr>
    <tr>
      <th>25998</th>
      <td>4.01</td>
      <td>Premium</td>
      <td>I</td>
      <td>I1</td>
      <td>61.0</td>
      <td>61.0</td>
      <td>15223</td>
      <td>10.14</td>
      <td>10.10</td>
      <td>6.17</td>
    </tr>
    <tr>
      <th>25999</th>
      <td>4.01</td>
      <td>Premium</td>
      <td>J</td>
      <td>I1</td>
      <td>62.5</td>
      <td>62.0</td>
      <td>15223</td>
      <td>10.02</td>
      <td>9.94</td>
      <td>6.24</td>
    </tr>
    <tr>
      <th>26534</th>
      <td>3.67</td>
      <td>Premium</td>
      <td>I</td>
      <td>I1</td>
      <td>62.4</td>
      <td>56.0</td>
      <td>16193</td>
      <td>9.86</td>
      <td>9.81</td>
      <td>6.13</td>
    </tr>
    <tr>
      <th>27514</th>
      <td>3.01</td>
      <td>Premium</td>
      <td>I</td>
      <td>SI2</td>
      <td>60.2</td>
      <td>59.0</td>
      <td>18242</td>
      <td>9.36</td>
      <td>9.31</td>
      <td>5.62</td>
    </tr>
    <tr>
      <th>27638</th>
      <td>3.04</td>
      <td>Premium</td>
      <td>I</td>
      <td>SI2</td>
      <td>59.3</td>
      <td>60.0</td>
      <td>18559</td>
      <td>9.51</td>
      <td>9.46</td>
      <td>5.62</td>
    </tr>
    <tr>
      <th>27679</th>
      <td>3.51</td>
      <td>Premium</td>
      <td>J</td>
      <td>VS2</td>
      <td>62.5</td>
      <td>59.0</td>
      <td>18701</td>
      <td>9.66</td>
      <td>9.63</td>
      <td>6.03</td>
    </tr>
    <tr>
      <th>27684</th>
      <td>3.01</td>
      <td>Premium</td>
      <td>J</td>
      <td>SI2</td>
      <td>60.7</td>
      <td>59.0</td>
      <td>18710</td>
      <td>9.35</td>
      <td>9.22</td>
      <td>5.64</td>
    </tr>
    <tr>
      <th>27685</th>
      <td>3.01</td>
      <td>Premium</td>
      <td>J</td>
      <td>SI2</td>
      <td>59.7</td>
      <td>58.0</td>
      <td>18710</td>
      <td>9.41</td>
      <td>9.32</td>
      <td>5.59</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## You can combine the column selection and the row filter.:

diamonds[['carat', 'cut']].query('carat &gt; 3').head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19339</th>
      <td>3.01</td>
      <td>Premium</td>
    </tr>
    <tr>
      <th>21758</th>
      <td>3.11</td>
      <td>Fair</td>
    </tr>
    <tr>
      <th>21862</th>
      <td>3.01</td>
      <td>Premium</td>
    </tr>
    <tr>
      <th>22428</th>
      <td>3.05</td>
      <td>Premium</td>
    </tr>
    <tr>
      <th>22540</th>
      <td>3.02</td>
      <td>Fair</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Perform some queries on the data.
## The following query applies multiple conditions 
## simultaneously to give us the observations 
## we are interested in.


diamonds.query('cut == &quot;Good&quot; \
               and color ==&quot;E&quot; and clarity ==&quot;VVS2&quot; \
               and price &gt; 10000')

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24630</th>
      <td>1.30</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>62.8</td>
      <td>59.0</td>
      <td>12967</td>
      <td>6.95</td>
      <td>6.99</td>
      <td>4.38</td>
    </tr>
    <tr>
      <th>25828</th>
      <td>1.41</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>59.9</td>
      <td>61.0</td>
      <td>14853</td>
      <td>7.21</td>
      <td>7.37</td>
      <td>4.37</td>
    </tr>
    <tr>
      <th>27177</th>
      <td>1.50</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>64.3</td>
      <td>58.0</td>
      <td>17449</td>
      <td>7.20</td>
      <td>7.13</td>
      <td>4.61</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Same query using the more verbose method

diamonds[(diamonds[&quot;cut&quot;] == &quot;Good&quot;) 
         &amp; (diamonds[&quot;color&quot;] == &quot;E&quot;) &amp; (diamonds[&quot;clarity&quot;] == &quot;VVS2&quot;) 
         &amp; (diamonds[&quot;price&quot;] &gt; 10000)]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24630</th>
      <td>1.30</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>62.8</td>
      <td>59.0</td>
      <td>12967</td>
      <td>6.95</td>
      <td>6.99</td>
      <td>4.38</td>
    </tr>
    <tr>
      <th>25828</th>
      <td>1.41</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>59.9</td>
      <td>61.0</td>
      <td>14853</td>
      <td>7.21</td>
      <td>7.37</td>
      <td>4.37</td>
    </tr>
    <tr>
      <th>27177</th>
      <td>1.50</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>64.3</td>
      <td>58.0</td>
      <td>17449</td>
      <td>7.20</td>
      <td>7.13</td>
      <td>4.61</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Query using string searches

diamonds[(diamonds[&quot;cut&quot;] == &quot;Good&quot;) &amp; (diamonds[&quot;clarity&quot;].str.startswith(&quot;V&quot;))]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0.23</td>
      <td>Good</td>
      <td>F</td>
      <td>VS1</td>
      <td>58.2</td>
      <td>59.0</td>
      <td>402</td>
      <td>4.06</td>
      <td>4.08</td>
      <td>2.37</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>64.1</td>
      <td>59.0</td>
      <td>402</td>
      <td>3.83</td>
      <td>3.85</td>
      <td>2.46</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.26</td>
      <td>Good</td>
      <td>D</td>
      <td>VS2</td>
      <td>65.2</td>
      <td>56.0</td>
      <td>403</td>
      <td>3.99</td>
      <td>4.02</td>
      <td>2.61</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0.26</td>
      <td>Good</td>
      <td>D</td>
      <td>VS1</td>
      <td>58.4</td>
      <td>63.0</td>
      <td>403</td>
      <td>4.19</td>
      <td>4.24</td>
      <td>2.46</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53840</th>
      <td>0.71</td>
      <td>Good</td>
      <td>H</td>
      <td>VVS2</td>
      <td>60.4</td>
      <td>63.0</td>
      <td>2738</td>
      <td>5.69</td>
      <td>5.74</td>
      <td>3.45</td>
    </tr>
    <tr>
      <th>53886</th>
      <td>0.70</td>
      <td>Good</td>
      <td>D</td>
      <td>VS2</td>
      <td>58.0</td>
      <td>62.0</td>
      <td>2749</td>
      <td>5.78</td>
      <td>5.87</td>
      <td>3.38</td>
    </tr>
    <tr>
      <th>53895</th>
      <td>0.70</td>
      <td>Good</td>
      <td>F</td>
      <td>VS1</td>
      <td>57.8</td>
      <td>61.0</td>
      <td>2751</td>
      <td>5.83</td>
      <td>5.79</td>
      <td>3.36</td>
    </tr>
    <tr>
      <th>53913</th>
      <td>0.80</td>
      <td>Good</td>
      <td>G</td>
      <td>VS2</td>
      <td>64.2</td>
      <td>58.0</td>
      <td>2753</td>
      <td>5.84</td>
      <td>5.81</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53914</th>
      <td>0.84</td>
      <td>Good</td>
      <td>I</td>
      <td>VS1</td>
      <td>63.7</td>
      <td>59.0</td>
      <td>2753</td>
      <td>5.94</td>
      <td>5.90</td>
      <td>3.77</td>
    </tr>
  </tbody>
</table>
<p>2098 rows × 10 columns</p>
</div>

<pre><code class="language-python">## Another example

diamonds.query('cut == &quot;Good&quot; \
and color == &quot;E&quot; and clarity == &quot;VVS2&quot; \
and price &gt; 10000')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24630</th>
      <td>1.30</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>62.8</td>
      <td>59.0</td>
      <td>12967</td>
      <td>6.95</td>
      <td>6.99</td>
      <td>4.38</td>
    </tr>
    <tr>
      <th>25828</th>
      <td>1.41</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>59.9</td>
      <td>61.0</td>
      <td>14853</td>
      <td>7.21</td>
      <td>7.37</td>
      <td>4.37</td>
    </tr>
    <tr>
      <th>27177</th>
      <td>1.50</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>64.3</td>
      <td>58.0</td>
      <td>17449</td>
      <td>7.20</td>
      <td>7.13</td>
      <td>4.61</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Another example

diamonds[(diamonds['cut'] == 'Good') 
       &amp; (diamonds['color'] == 'E')
         &amp; (diamonds['clarity'] == 'VVS2')
           &amp; (diamonds['price'] &gt;10000)]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24630</th>
      <td>1.30</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>62.8</td>
      <td>59.0</td>
      <td>12967</td>
      <td>6.95</td>
      <td>6.99</td>
      <td>4.38</td>
    </tr>
    <tr>
      <th>25828</th>
      <td>1.41</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>59.9</td>
      <td>61.0</td>
      <td>14853</td>
      <td>7.21</td>
      <td>7.37</td>
      <td>4.37</td>
    </tr>
    <tr>
      <th>27177</th>
      <td>1.50</td>
      <td>Good</td>
      <td>E</td>
      <td>VVS2</td>
      <td>64.3</td>
      <td>58.0</td>
      <td>17449</td>
      <td>7.20</td>
      <td>7.13</td>
      <td>4.61</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="subsetting-with-loc-and-iloc">Subsetting with <code>loc</code> and <code>iloc</code></h2>
<p><strong>- subsetting a data frame</strong> <br>
<code>loc</code> is label based, ie based on the row index and column names <br>
<code>iloc</code> is row and column number based <br></p>
<p>Separate the row and column selections by commas.  If no comma, then the entire entry is assumed to be for the rows.</p>
<pre><code class="language-python">diamonds.iloc[:3] ## only for iloc, the range excludes the right hand number.  Here the row with index 3 is excluded.
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">diamonds.iloc[1,2]
</code></pre>
<pre><code>'E'
</code></pre>
<pre><code class="language-python">diamonds.loc[1,'cut']
</code></pre>
<pre><code>'Premium'
</code></pre>
<pre><code class="language-python">diamonds.loc[1:3, ['cut','depth']] ## Note here you need the square brackets, in the next one you don't
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cut</th>
      <th>depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Premium</td>
      <td>59.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Good</td>
      <td>56.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Premium</td>
      <td>62.4</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">diamonds.loc[1:3, 'cut':'depth']
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">diamonds.iloc[1:3,2:4] #See the rows and columns that were excluded
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>clarity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>E</td>
      <td>SI1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>VS1</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="understanding-data-types">Understanding Data Types</h2>
<p>A ‘data type’ is an internal representation of how Python treats and manipulates data.
Python and Pandas can be quite forgiving about data types, but incorrect data types can give you incorrect or unpredictable results, or outright errors.
Following are the data types used in Pandas:</p>
<table>
<thead>
<tr>
<th>Pandas data type</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>bool</td>
<td>True/False values</td>
</tr>
<tr>
<td>category</td>
<td>Levels, or factors, ie, a determinate list of categorical values</td>
</tr>
<tr>
<td>datetime64</td>
<td>Date &amp; time representations</td>
</tr>
<tr>
<td>float64</td>
<td>Floating point numbers (ie numbers with decimals)</td>
</tr>
<tr>
<td>int64</td>
<td>Integers</td>
</tr>
<tr>
<td>object</td>
<td>Text, or mixed numeric and non-numeric values</td>
</tr>
<tr>
<td>timedelta[ns]</td>
<td>Difference between two datetimes</td>
</tr>
</tbody>
</table>
<p>Consider the <code>mtcars</code> dataset.</p>
<p>Examining the data types of different columns, we see that cyl (number of cylinders) is an integer.
But this feature has only three discrete values, and can be considered a category.</p>
<p>We can convert this column to a category.</p>
<p>Dates often require a similar consideration</p>
<pre><code class="language-python">mtcars.info()
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 32 entries, Mazda RX4 to Volvo 142E
Data columns (total 11 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   mpg     32 non-null     float64
 1   cyl     32 non-null     int64  
 2   disp    32 non-null     float64
 3   hp      32 non-null     int64  
 4   drat    32 non-null     float64
 5   wt      32 non-null     float64
 6   qsec    32 non-null     float64
 7   vs      32 non-null     int64  
 8   am      32 non-null     int64  
 9   gear    32 non-null     int64  
 10  carb    32 non-null     int64  
dtypes: float64(5), int64(6)
memory usage: 3.0+ KB
</code></pre>
<h2 id="change-column-to-categorical">Change column to categorical</h2>
<pre><code class="language-python">x = diamonds[['carat', 'cut']].query('carat &gt; 3')
x.info()

</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 32 entries, 19339 to 27685
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype   
---  ------  --------------  -----   
 0   carat   32 non-null     float64 
 1   cut     32 non-null     category
dtypes: category(1), float64(1)
memory usage: 756.0 bytes
</code></pre>
<pre><code class="language-python">diamonds['cut'] = diamonds['cut'].astype('category')
diamonds.info()

</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 53940 entries, 0 to 53939
Data columns (total 10 columns):
 #   Column   Non-Null Count  Dtype   
---  ------   --------------  -----   
 0   carat    53940 non-null  float64 
 1   cut      53940 non-null  category
 2   color    53940 non-null  category
 3   clarity  53940 non-null  category
 4   depth    53940 non-null  float64 
 5   table    53940 non-null  float64 
 6   price    53940 non-null  int64   
 7   x        53940 non-null  float64 
 8   y        53940 non-null  float64 
 9   z        53940 non-null  float64 
dtypes: category(3), float64(6), int64(1)
memory usage: 3.0 MB
</code></pre>
<pre><code class="language-python">diamonds['cut'].cat.categories
</code></pre>
<pre><code>Index(['Ideal', 'Premium', 'Very Good', 'Good', 'Fair'], dtype='object')
</code></pre>
<h3 id="how-to-list-categories">How to list categories</h3>
<pre><code class="language-python">list(enumerate(diamonds['cut'].cat.categories))
</code></pre>
<pre><code>[(0, 'Ideal'), (1, 'Premium'), (2, 'Very Good'), (3, 'Good'), (4, 'Fair')]
</code></pre>
<pre><code class="language-python"> dict(enumerate(diamonds['cut'].cat.categories))
</code></pre>
<pre><code>{0: 'Ideal', 1: 'Premium', 2: 'Very Good', 3: 'Good', 4: 'Fair'}
</code></pre>
<pre><code class="language-python">pd.DataFrame(enumerate(diamonds['cut'].cat.categories))
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Ideal</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Premium</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Very Good</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Good</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Fair</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">mtcars.info()
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 32 entries, Mazda RX4 to Volvo 142E
Data columns (total 11 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   mpg     32 non-null     float64
 1   cyl     32 non-null     int64  
 2   disp    32 non-null     float64
 3   hp      32 non-null     int64  
 4   drat    32 non-null     float64
 5   wt      32 non-null     float64
 6   qsec    32 non-null     float64
 7   vs      32 non-null     int64  
 8   am      32 non-null     int64  
 9   gear    32 non-null     int64  
 10  carb    32 non-null     int64  
dtypes: float64(5), int64(6)
memory usage: 3.0+ KB
</code></pre>
<pre><code class="language-python">mtcars['cyl'] = mtcars['cyl'].astype('category')
</code></pre>
<pre><code class="language-python">mtcars.info()
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 32 entries, Mazda RX4 to Volvo 142E
Data columns (total 11 columns):
 #   Column  Non-Null Count  Dtype   
---  ------  --------------  -----   
 0   mpg     32 non-null     float64 
 1   cyl     32 non-null     category
 2   disp    32 non-null     float64 
 3   hp      32 non-null     int64   
 4   drat    32 non-null     float64 
 5   wt      32 non-null     float64 
 6   qsec    32 non-null     float64 
 7   vs      32 non-null     int64   
 8   am      32 non-null     int64   
 9   gear    32 non-null     int64   
 10  carb    32 non-null     int64   
dtypes: category(1), float64(5), int64(5)
memory usage: 2.9+ KB
</code></pre>
<h2 id="get-column-names">Get column names</h2>
<p>You can list columns using <code>df.columns</code></p>
<pre><code class="language-python"># List the column names in the diamonds dataset

diamonds.columns
</code></pre>
<pre><code>Index(['carat', 'cut', 'color', 'clarity', 'depth', 'table', 'price', 'x', 'y',
       'z'],
      dtype='object')
</code></pre>
<pre><code class="language-python">## Or, list it for a cleaner list

list(diamonds.columns)
</code></pre>
<pre><code>['carat', 'cut', 'color', 'clarity', 'depth', 'table', 'price', 'x', 'y', 'z']
</code></pre>
<pre><code class="language-python">diamonds.columns.tolist()
## same thing as above
</code></pre>
<pre><code>['carat', 'cut', 'color', 'clarity', 'depth', 'table', 'price', 'x', 'y', 'z']
</code></pre>
<h2 id="add-columns">Add Columns</h2>
<p>Sometimes, you may need to add a column to the data using a calculation.</p>
<p>Example: Add a column <code>norm_carat</code> converting the field carat in the diamonds dataset to a standardized variable.</p>
<pre><code class="language-python">## Add a column equal to the z-score for the carat variable
diamonds['norm_carat'] = (diamonds['carat'] - diamonds['carat'].mean() )/diamonds['carat'].std()
diamonds.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>norm_carat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
      <td>-1.198157</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
      <td>-1.240350</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
      <td>-1.198157</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
      <td>-1.071577</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
      <td>-1.029384</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="add-column-with-insert">Add column with <code>insert</code></h3>
<p>Use <code>df.insert(col_location, col_title, contents)</code> to insert at a particular location.</p>
<p>Below we insert a random number at position 3 in the diamonds dataframe.</p>
<pre><code class="language-python">## mydf.insert(col_location, col_title, contents) does the trick

diamonds.insert(3, &quot;random_value&quot;, np.random.randint(0, 100, diamonds.shape[0]))
diamonds.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>random_value</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>norm_carat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>62</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
      <td>-1.198157</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>36</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
      <td>-1.240350</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>5</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
      <td>-1.198157</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>79</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
      <td>-1.071577</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>98</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
      <td>-1.029384</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="add-column-with-assign">Add column with <code>assign</code></h3>
<pre><code class="language-python">## This does not add the column to the original data frame unless you make it equal to the new one

diamonds.assign(total = diamonds.x + diamonds.y + diamonds.z).head()

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>random_value</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>norm_carat</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>62</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
      <td>-1.198157</td>
      <td>10.36</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>36</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
      <td>-1.240350</td>
      <td>10.04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>5</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
      <td>-1.198157</td>
      <td>10.43</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>79</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
      <td>-1.071577</td>
      <td>11.06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>98</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
      <td>-1.029384</td>
      <td>11.44</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Notice the 'total' column from above is not there, .

diamonds.head(2)

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>random_value</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>norm_carat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>62</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
      <td>-1.198157</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>36</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
      <td>-1.240350</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="delete-columns">Delete Columns</h2>
<p>Sometimes, you may need to remove certain columns to remove unwanted information, or to reduce the size of the dataset.</p>
<p><code>del df['ColName']</code> does the trick for a single column.</p>
<p>Similarly, <code>df.drop(['ColName'], axis = 1, inplace = True)</code> can be used to delete multiple columns.  It can also be used to delete rows.  </p>
<pre><code class="language-python"># Example: delete the 'norm_carat' column we inserted earlier

del diamonds['norm_carat']
</code></pre>
<pre><code class="language-python">## Or we can use the drop command

diamonds.drop('random_value', axis=1, inplace=True)
</code></pre>
<pre><code class="language-python"># Let us now look a the list of columns that are left

diamonds.columns
</code></pre>
<pre><code>Index(['carat', 'cut', 'color', 'clarity', 'depth', 'table', 'price', 'x', 'y',
       'z'],
      dtype='object')
</code></pre>
<h2 id="reordering-columns">Reordering Columns</h2>
<p>Sometimes you may need to rearrange the order in which columns appear to make them easier to read.
In Pandas, that can be done by assigning the new column order to the same dataframe.</p>
<p>Example: Make price the first column in the diamonds dataset.</p>
<pre><code class="language-python">diamonds = diamonds[['price', 'carat', 'cut', 'color', 'clarity', 'depth', 'table',  'x', 'y','z']]
</code></pre>
<pre><code class="language-python">diamonds
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>326</td>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>326</td>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>327</td>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>334</td>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>335</td>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53935</th>
      <td>2757</td>
      <td>0.72</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI1</td>
      <td>60.8</td>
      <td>57.0</td>
      <td>5.75</td>
      <td>5.76</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>2757</td>
      <td>0.72</td>
      <td>Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>63.1</td>
      <td>55.0</td>
      <td>5.69</td>
      <td>5.75</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>2757</td>
      <td>0.70</td>
      <td>Very Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>60.0</td>
      <td>5.66</td>
      <td>5.68</td>
      <td>3.56</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>2757</td>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>2757</td>
      <td>0.75</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>55.0</td>
      <td>5.83</td>
      <td>5.87</td>
      <td>3.64</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>

<h2 id="sorting-values">Sorting Values</h2>
<p>Sorting rows by their values is a common task.</p>
<p>Example: Sort the diamonds dataset by price and carat weight so that the former is sorted in ascending order, and the latter in ascending order.</p>
<p>Format is <code>df.sort_values(['a', 'b'], ascending=[True, False])</code></p>
<pre><code class="language-python">diamonds.sort_values(['carat', 'price', 'depth'], ascending = [False, False, False]).head(8)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27415</th>
      <td>18018</td>
      <td>5.01</td>
      <td>Fair</td>
      <td>J</td>
      <td>I1</td>
      <td>65.5</td>
      <td>59.0</td>
      <td>10.74</td>
      <td>10.54</td>
      <td>6.98</td>
    </tr>
    <tr>
      <th>27630</th>
      <td>18531</td>
      <td>4.50</td>
      <td>Fair</td>
      <td>J</td>
      <td>I1</td>
      <td>65.8</td>
      <td>58.0</td>
      <td>10.23</td>
      <td>10.16</td>
      <td>6.72</td>
    </tr>
    <tr>
      <th>27130</th>
      <td>17329</td>
      <td>4.13</td>
      <td>Fair</td>
      <td>H</td>
      <td>I1</td>
      <td>64.8</td>
      <td>61.0</td>
      <td>10.00</td>
      <td>9.85</td>
      <td>6.43</td>
    </tr>
    <tr>
      <th>25999</th>
      <td>15223</td>
      <td>4.01</td>
      <td>Premium</td>
      <td>J</td>
      <td>I1</td>
      <td>62.5</td>
      <td>62.0</td>
      <td>10.02</td>
      <td>9.94</td>
      <td>6.24</td>
    </tr>
    <tr>
      <th>25998</th>
      <td>15223</td>
      <td>4.01</td>
      <td>Premium</td>
      <td>I</td>
      <td>I1</td>
      <td>61.0</td>
      <td>61.0</td>
      <td>10.14</td>
      <td>10.10</td>
      <td>6.17</td>
    </tr>
    <tr>
      <th>26444</th>
      <td>15984</td>
      <td>4.00</td>
      <td>Very Good</td>
      <td>I</td>
      <td>I1</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>10.01</td>
      <td>9.94</td>
      <td>6.31</td>
    </tr>
    <tr>
      <th>26534</th>
      <td>16193</td>
      <td>3.67</td>
      <td>Premium</td>
      <td>I</td>
      <td>I1</td>
      <td>62.4</td>
      <td>56.0</td>
      <td>9.86</td>
      <td>9.81</td>
      <td>6.13</td>
    </tr>
    <tr>
      <th>23644</th>
      <td>11668</td>
      <td>3.65</td>
      <td>Fair</td>
      <td>H</td>
      <td>I1</td>
      <td>67.1</td>
      <td>53.0</td>
      <td>9.53</td>
      <td>9.48</td>
      <td>6.38</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Another example of sorting, but with the change updating the dataframe through 'inplace=True'

diamonds.sort_values(['price', 'carat'], ascending=[True, False], inplace = True)
</code></pre>
<pre><code class="language-python"># Let us look at how the sorted dataset looks like

diamonds
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>326</td>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>326</td>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>327</td>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>334</td>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>335</td>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>27745</th>
      <td>18803</td>
      <td>2.00</td>
      <td>Very Good</td>
      <td>H</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>57.0</td>
      <td>7.95</td>
      <td>8.00</td>
      <td>5.01</td>
    </tr>
    <tr>
      <th>27746</th>
      <td>18804</td>
      <td>2.07</td>
      <td>Ideal</td>
      <td>G</td>
      <td>SI2</td>
      <td>62.5</td>
      <td>55.0</td>
      <td>8.20</td>
      <td>8.13</td>
      <td>5.11</td>
    </tr>
    <tr>
      <th>27747</th>
      <td>18806</td>
      <td>1.51</td>
      <td>Ideal</td>
      <td>G</td>
      <td>IF</td>
      <td>61.7</td>
      <td>55.0</td>
      <td>7.37</td>
      <td>7.41</td>
      <td>4.56</td>
    </tr>
    <tr>
      <th>27748</th>
      <td>18818</td>
      <td>2.00</td>
      <td>Very Good</td>
      <td>G</td>
      <td>SI1</td>
      <td>63.5</td>
      <td>56.0</td>
      <td>7.90</td>
      <td>7.97</td>
      <td>5.04</td>
    </tr>
    <tr>
      <th>27749</th>
      <td>18823</td>
      <td>2.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>60.8</td>
      <td>60.0</td>
      <td>8.50</td>
      <td>8.47</td>
      <td>5.16</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>

<h2 id="renaming-columns">Renaming Columns</h2>
<p>Renaming columns is often needed to remove spaces in column names, or make everything lowercase, or to provide more descriptive or concise column headings.</p>
<p>Can be done by passing a dictionary of old_name: new_name to the rename function.</p>
<p>Example: Rename price to dollars, and carat to weight in the diamonds dataset.</p>
<pre><code class="language-Python">df.rename(columns={'oldName1': 'newName1', 'oldName2': 'newName2'}, inplace=True)
</code></pre>
<pre><code class="language-python">diamonds.rename(columns = {'price': 'dollars', 'carat': 'weight'})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dollars</th>
      <th>weight</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>326</td>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>326</td>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>327</td>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>334</td>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>335</td>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>27745</th>
      <td>18803</td>
      <td>2.00</td>
      <td>Very Good</td>
      <td>H</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>57.0</td>
      <td>7.95</td>
      <td>8.00</td>
      <td>5.01</td>
    </tr>
    <tr>
      <th>27746</th>
      <td>18804</td>
      <td>2.07</td>
      <td>Ideal</td>
      <td>G</td>
      <td>SI2</td>
      <td>62.5</td>
      <td>55.0</td>
      <td>8.20</td>
      <td>8.13</td>
      <td>5.11</td>
    </tr>
    <tr>
      <th>27747</th>
      <td>18806</td>
      <td>1.51</td>
      <td>Ideal</td>
      <td>G</td>
      <td>IF</td>
      <td>61.7</td>
      <td>55.0</td>
      <td>7.37</td>
      <td>7.41</td>
      <td>4.56</td>
    </tr>
    <tr>
      <th>27748</th>
      <td>18818</td>
      <td>2.00</td>
      <td>Very Good</td>
      <td>G</td>
      <td>SI1</td>
      <td>63.5</td>
      <td>56.0</td>
      <td>7.90</td>
      <td>7.97</td>
      <td>5.04</td>
    </tr>
    <tr>
      <th>27749</th>
      <td>18823</td>
      <td>2.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>60.8</td>
      <td>60.0</td>
      <td>8.50</td>
      <td>8.47</td>
      <td>5.16</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>

<pre><code class="language-python">diamonds.rename(columns={'price': 'dollars'}, inplace=False)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dollars</th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>326</td>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>326</td>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>327</td>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>334</td>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>335</td>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>27745</th>
      <td>18803</td>
      <td>2.00</td>
      <td>Very Good</td>
      <td>H</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>57.0</td>
      <td>7.95</td>
      <td>8.00</td>
      <td>5.01</td>
    </tr>
    <tr>
      <th>27746</th>
      <td>18804</td>
      <td>2.07</td>
      <td>Ideal</td>
      <td>G</td>
      <td>SI2</td>
      <td>62.5</td>
      <td>55.0</td>
      <td>8.20</td>
      <td>8.13</td>
      <td>5.11</td>
    </tr>
    <tr>
      <th>27747</th>
      <td>18806</td>
      <td>1.51</td>
      <td>Ideal</td>
      <td>G</td>
      <td>IF</td>
      <td>61.7</td>
      <td>55.0</td>
      <td>7.37</td>
      <td>7.41</td>
      <td>4.56</td>
    </tr>
    <tr>
      <th>27748</th>
      <td>18818</td>
      <td>2.00</td>
      <td>Very Good</td>
      <td>G</td>
      <td>SI1</td>
      <td>63.5</td>
      <td>56.0</td>
      <td>7.90</td>
      <td>7.97</td>
      <td>5.04</td>
    </tr>
    <tr>
      <th>27749</th>
      <td>18823</td>
      <td>2.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>60.8</td>
      <td>60.0</td>
      <td>8.50</td>
      <td>8.47</td>
      <td>5.16</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>

<h2 id="removing-duplicates">Removing Duplicates</h2>
<p>Duplicate rows may often be found in a DataFrame.</p>
<p><code>pandas.drop_duplicates()</code> returns a DataFrame where all duplicated rows are removed.</p>
<p>By default, all columns are considered, but you can limit the duplication detection to a subset of columns.  If a subset of columns is used, the first observed value will be retained.  This behavior can be changed by specifying <code>keep = 'last'.</code></p>
<p>Let us consider an example. We create a toy dataframe as below:</p>
<pre><code class="language-python">df = pd.DataFrame({'state': ['NY', 'NJ', 'NJ', 'NJ', 'CT', 'CT', 'CT'],
                  'variable1': [2, 3, 2, 2, 4, 6, 6],
                  'variable2': [10, 22, 22, 24, 11, 24, 24]})
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>variable1</th>
      <th>variable2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NY</td>
      <td>2</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NJ</td>
      <td>3</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NJ</td>
      <td>2</td>
      <td>22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NJ</td>
      <td>2</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>4</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
    </tr>
    <tr>
      <th>6</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div>

<p>Note the below:</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/4534e005-978a-41e0-a6a5-172ee447e9e8.png" /></p>
<pre><code class="language-python">## Dropping duplicates considering all columns

df.drop_duplicates()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>variable1</th>
      <th>variable2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NY</td>
      <td>2</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NJ</td>
      <td>3</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NJ</td>
      <td>2</td>
      <td>22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NJ</td>
      <td>2</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>4</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Dropping duplicates considering only the first two columns.

## (Note which of the two NJ records was retained!)

df.drop_duplicates(['state', 'variable1'])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>variable1</th>
      <th>variable2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NY</td>
      <td>2</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NJ</td>
      <td>3</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NJ</td>
      <td>2</td>
      <td>22</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>4</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="replacing-values">Replacing Values</h2>
<p>We often need to replace values in data.  For example, we may know that 0 means the data is not available, and may wish to replace zeros with NaN.  </p>
<p>Let us replace state names in our previous toy dataset with their full names.</p>
<p>We do this using <code>df.replace({'NJ': 'New Jersey', 'NY': 'New York', 'CT': 'Connecticut’})</code>.</p>
<p>Note that this affects the entire dataframe, so be careful to select the right column name if you want the replacement to occur in only one column!</p>
<pre><code class="language-python">df.replace({'NJ': 'New Jersey', 'NY': 'New York', 'CT': 'Connecticut'})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>variable1</th>
      <th>variable2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New York</td>
      <td>2</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New Jersey</td>
      <td>3</td>
      <td>22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New Jersey</td>
      <td>2</td>
      <td>22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>New Jersey</td>
      <td>2</td>
      <td>24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Connecticut</td>
      <td>4</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Connecticut</td>
      <td>6</td>
      <td>24</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Connecticut</td>
      <td>6</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="binning-using-pandas-cut-function">Binning using Pandas <code>cut</code> Function</h2>
<p>We often need to convert continuous variables into categories.</p>
<p>For example, reconsider our toy dataset.  Consider variable1.  Say we want anything 2 or lower to be labeled as Small, 2 to 4 as Medium, and 4 to 6 as Large.</p>
<p>We can do this as follows:
<code>pd.cut(df.variable1, [0, 2, 4, 6], labels = ["Small", "Medium", "Large"])</code></p>
<p>Consider <code>variable1</code>.  Say we want anything 2 or lower to be labeled as Small,
2 to 4 as Medium, and 4 to 6 as Large.</p>
<p>We use the <code>pd.cut</code> function to create the bins, and assign them labels as below. </p>
<p>If no labels are specified, the mathematical notation for intervals will be used for the bins, ie <code>[(0, 2] &lt; (2, 4] &lt; (4, 6]]</code> ( <code>(</code> means does not include, and <code>[</code> means includes)</p>
<pre><code class="language-python">df['NewColumn'] = pd.cut(df.variable1, [0, 2, 4, 6], labels = [&quot;Small&quot;, &quot;Medium&quot;, &quot;Large&quot;])
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>variable1</th>
      <th>variable2</th>
      <th>NewColumn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NY</td>
      <td>2</td>
      <td>10</td>
      <td>Small</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NJ</td>
      <td>3</td>
      <td>22</td>
      <td>Medium</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NJ</td>
      <td>2</td>
      <td>22</td>
      <td>Small</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NJ</td>
      <td>2</td>
      <td>24</td>
      <td>Small</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>4</td>
      <td>11</td>
      <td>Medium</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
      <td>Large</td>
    </tr>
    <tr>
      <th>6</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
      <td>Large</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>variable1</th>
      <th>variable2</th>
      <th>NewColumn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NY</td>
      <td>2</td>
      <td>10</td>
      <td>Small</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NJ</td>
      <td>3</td>
      <td>22</td>
      <td>Medium</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NJ</td>
      <td>2</td>
      <td>22</td>
      <td>Small</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NJ</td>
      <td>2</td>
      <td>24</td>
      <td>Small</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>4</td>
      <td>11</td>
      <td>Medium</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
      <td>Large</td>
    </tr>
    <tr>
      <th>6</th>
      <td>CT</td>
      <td>6</td>
      <td>24</td>
      <td>Large</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="binning-into-quantiles-using-qcut">Binning into Quantiles using <code>qcut</code></h2>
<p>Sometimes we may desire an equal number of observations in our bins.</p>
<p>In such cases, we can use quantiles as bins but then the intervals may not be equal (though the count of observations in each bin may be similar.</p>
<p>We can also specify arbitrary quantiles as bins.</p>
<p>In Pandas, use <code>pd.qcut(df.variable1, number_of_quantiles)</code> to achieve this.</p>
<pre><code class="language-python">pd.qcut(df.variable1, 2)
</code></pre>
<pre><code>0    (1.999, 3.0]
1    (1.999, 3.0]
2    (1.999, 3.0]
3    (1.999, 3.0]
4      (3.0, 6.0]
5      (3.0, 6.0]
6      (3.0, 6.0]
Name: variable1, dtype: category
Categories (2, interval[float64, right]): [(1.999, 3.0] &lt; (3.0, 6.0]]
</code></pre>
<pre><code class="language-python">pd.qcut(diamonds.price, 4)
</code></pre>
<pre><code>0          (325.999, 950.0]
1          (325.999, 950.0]
2          (325.999, 950.0]
3          (325.999, 950.0]
4          (325.999, 950.0]
                ...        
27745    (5324.25, 18823.0]
27746    (5324.25, 18823.0]
27747    (5324.25, 18823.0]
27748    (5324.25, 18823.0]
27749    (5324.25, 18823.0]
Name: price, Length: 53940, dtype: category
Categories (4, interval[float64, right]): [(325.999, 950.0] &lt; (950.0, 2401.0] &lt; (2401.0, 5324.25] &lt; (5324.25, 18823.0]]
</code></pre>
<pre><code class="language-python">diamonds['quartiles']=pd.qcut(diamonds.price, 4)
diamonds['Price_Category']=pd.qcut(diamonds.price, 4, labels=['Economy','Affordable','Pricey','Expensive'])
diamonds.sample(8)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>quartiles</th>
      <th>Price_Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27174</th>
      <td>17442</td>
      <td>1.76</td>
      <td>Ideal</td>
      <td>G</td>
      <td>VS2</td>
      <td>60.3</td>
      <td>57.0</td>
      <td>7.90</td>
      <td>7.83</td>
      <td>4.74</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>34257</th>
      <td>857</td>
      <td>0.30</td>
      <td>Ideal</td>
      <td>F</td>
      <td>VVS1</td>
      <td>62.3</td>
      <td>56.0</td>
      <td>4.30</td>
      <td>4.34</td>
      <td>2.69</td>
      <td>(325.999, 950.0]</td>
      <td>Economy</td>
    </tr>
    <tr>
      <th>21817</th>
      <td>9891</td>
      <td>1.31</td>
      <td>Ideal</td>
      <td>G</td>
      <td>VS1</td>
      <td>61.5</td>
      <td>57.0</td>
      <td>7.02</td>
      <td>7.06</td>
      <td>4.33</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>27277</th>
      <td>17730</td>
      <td>2.12</td>
      <td>Ideal</td>
      <td>F</td>
      <td>SI2</td>
      <td>62.3</td>
      <td>57.0</td>
      <td>8.19</td>
      <td>8.22</td>
      <td>5.11</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>37561</th>
      <td>988</td>
      <td>0.31</td>
      <td>Premium</td>
      <td>G</td>
      <td>IF</td>
      <td>61.7</td>
      <td>54.0</td>
      <td>4.36</td>
      <td>4.33</td>
      <td>2.68</td>
      <td>(950.0, 2401.0]</td>
      <td>Affordable</td>
    </tr>
    <tr>
      <th>44087</th>
      <td>1554</td>
      <td>0.50</td>
      <td>Ideal</td>
      <td>E</td>
      <td>VS2</td>
      <td>62.1</td>
      <td>55.0</td>
      <td>5.11</td>
      <td>5.13</td>
      <td>3.18</td>
      <td>(950.0, 2401.0]</td>
      <td>Affordable</td>
    </tr>
    <tr>
      <th>24935</th>
      <td>13387</td>
      <td>2.01</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>62.1</td>
      <td>57.0</td>
      <td>8.00</td>
      <td>7.88</td>
      <td>4.93</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>7607</th>
      <td>4259</td>
      <td>0.84</td>
      <td>Very Good</td>
      <td>G</td>
      <td>VVS2</td>
      <td>60.4</td>
      <td>55.0</td>
      <td>6.07</td>
      <td>6.12</td>
      <td>3.68</td>
      <td>(2401.0, 5324.25]</td>
      <td>Pricey</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># ..combining pandas functions to get a list of the unique quartiles and price_category columns

diamonds[['quartiles', 'Price_Category']].drop_duplicates().sort_values(by='quartiles').reset_index()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>quartiles</th>
      <th>Price_Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>(325.999, 950.0]</td>
      <td>Economy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36691</td>
      <td>(950.0, 2401.0]</td>
      <td>Affordable</td>
    </tr>
    <tr>
      <th>2</th>
      <td>51735</td>
      <td>(2401.0, 5324.25]</td>
      <td>Pricey</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12766</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># ..looking at counts in each category
diamonds.groupby(['quartiles', 'Price_Category']).agg({&quot;carat&quot;:&quot;count&quot;}).query('carat&gt;0').rename({'carat':'Count of Diamonds'}, axis=1)
</code></pre>
<pre><code>C:\Users\user\AppData\Local\Temp\ipykernel_21280\3774040384.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  diamonds.groupby(['quartiles', 'Price_Category']).agg({"carat":"count"}).query('carat&gt;0').rename({'carat':'Count of Diamonds'}, axis=1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Count of Diamonds</th>
    </tr>
    <tr>
      <th>quartiles</th>
      <th>Price_Category</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(325.999, 950.0]</th>
      <th>Economy</th>
      <td>13490</td>
    </tr>
    <tr>
      <th>(950.0, 2401.0]</th>
      <th>Affordable</th>
      <td>13495</td>
    </tr>
    <tr>
      <th>(2401.0, 5324.25]</th>
      <th>Pricey</th>
      <td>13470</td>
    </tr>
    <tr>
      <th>(5324.25, 18823.0]</th>
      <th>Expensive</th>
      <td>13485</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="select-a-random-sample-of-data">Select a random sample of data</h2>
<p>Often, we need to look at a sample of the observations.  <code>df.head()</code> and <code>df.tail()</code> produce the same records each time, and often it is good to look at other data.</p>
<p><code>df.sample(n)</code> gives you a random set of <em>n</em> observations from the data.</p>
<pre><code class="language-python">## Either a discrete number of rows,
diamonds.sample(3)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>quartiles</th>
      <th>Price_Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9847</th>
      <td>4676</td>
      <td>0.91</td>
      <td>Premium</td>
      <td>E</td>
      <td>VS2</td>
      <td>62.2</td>
      <td>60.0</td>
      <td>6.21</td>
      <td>6.13</td>
      <td>3.84</td>
      <td>(2401.0, 5324.25]</td>
      <td>Pricey</td>
    </tr>
    <tr>
      <th>48494</th>
      <td>1981</td>
      <td>0.52</td>
      <td>Ideal</td>
      <td>F</td>
      <td>VS2</td>
      <td>61.5</td>
      <td>56.0</td>
      <td>5.19</td>
      <td>5.21</td>
      <td>3.20</td>
      <td>(950.0, 2401.0]</td>
      <td>Affordable</td>
    </tr>
    <tr>
      <th>38402</th>
      <td>1024</td>
      <td>0.35</td>
      <td>Premium</td>
      <td>H</td>
      <td>VVS1</td>
      <td>60.6</td>
      <td>60.0</td>
      <td>4.57</td>
      <td>4.51</td>
      <td>2.75</td>
      <td>(950.0, 2401.0]</td>
      <td>Affordable</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## or a fraction of the total data
diamonds.sample(frac = 0.00015)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>quartiles</th>
      <th>Price_Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13413</th>
      <td>5510</td>
      <td>1.20</td>
      <td>Ideal</td>
      <td>H</td>
      <td>SI1</td>
      <td>62.9</td>
      <td>57.0</td>
      <td>6.79</td>
      <td>6.76</td>
      <td>4.26</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>37504</th>
      <td>984</td>
      <td>0.41</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI1</td>
      <td>61.8</td>
      <td>59.0</td>
      <td>4.81</td>
      <td>4.77</td>
      <td>2.96</td>
      <td>(950.0, 2401.0]</td>
      <td>Affordable</td>
    </tr>
    <tr>
      <th>24608</th>
      <td>12931</td>
      <td>2.06</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>62.6</td>
      <td>58.0</td>
      <td>8.06</td>
      <td>8.03</td>
      <td>5.04</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>22350</th>
      <td>628</td>
      <td>0.31</td>
      <td>Very Good</td>
      <td>I</td>
      <td>VS1</td>
      <td>63.5</td>
      <td>57.0</td>
      <td>4.28</td>
      <td>4.26</td>
      <td>2.71</td>
      <td>(325.999, 950.0]</td>
      <td>Economy</td>
    </tr>
    <tr>
      <th>15933</th>
      <td>6371</td>
      <td>1.25</td>
      <td>Ideal</td>
      <td>G</td>
      <td>SI2</td>
      <td>61.1</td>
      <td>55.0</td>
      <td>6.95</td>
      <td>6.99</td>
      <td>4.26</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>19798</th>
      <td>8365</td>
      <td>1.25</td>
      <td>Ideal</td>
      <td>H</td>
      <td>VS1</td>
      <td>62.1</td>
      <td>57.0</td>
      <td>6.89</td>
      <td>6.92</td>
      <td>4.29</td>
      <td>(5324.25, 18823.0]</td>
      <td>Expensive</td>
    </tr>
    <tr>
      <th>53055</th>
      <td>2607</td>
      <td>0.72</td>
      <td>Ideal</td>
      <td>F</td>
      <td>VS2</td>
      <td>61.1</td>
      <td>56.0</td>
      <td>5.83</td>
      <td>5.79</td>
      <td>3.55</td>
      <td>(2401.0, 5324.25]</td>
      <td>Pricey</td>
    </tr>
    <tr>
      <th>49293</th>
      <td>539</td>
      <td>0.33</td>
      <td>Ideal</td>
      <td>H</td>
      <td>VS2</td>
      <td>61.1</td>
      <td>56.0</td>
      <td>4.50</td>
      <td>4.54</td>
      <td>2.76</td>
      <td>(325.999, 950.0]</td>
      <td>Economy</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="string-operations-with-pandas">String operations with Pandas</h2>
<p>We often have to combine text data, split it, find certain types of text, and perform various other functions on strings.</p>
<p>String munging operations often take up a lot of time when cleaning data.</p>
<p>Pandas offers a number of methods to perform string operations – refer list to the right.</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/fa9beb58-319f-4154-b4e5-08d2fe2b29db.png" /></p>
<p><em>Source: Python for Data Analysis, Wes McKinney</em></p>
<h2 id="value-counts">Value Counts</h2>
<pre><code class="language-python">## value_counts provide the frequency for categorical variables
mtcars.cyl.value_counts()
</code></pre>
<pre><code>cyl
8    14
4    11
6     7
Name: count, dtype: int64
</code></pre>
<pre><code class="language-python">## ...and we can get percentages instead too
mtcars.cyl.value_counts(normalize=True)
</code></pre>
<pre><code>cyl
8    0.43750
4    0.34375
6    0.21875
Name: proportion, dtype: float64
</code></pre>
<pre><code class="language-python"># Just checking what range(60,64) returns

list(range(60,64))
</code></pre>
<pre><code>[60, 61, 62, 63]
</code></pre>
<pre><code class="language-python">## We can specify bins for numerical variables
# Below, we are saying give us value counts for 60-61, 61-62, 62-63.

diamonds = sns.load_dataset(&quot;diamonds&quot;)

diamonds.depth.value_counts(bins = range(60,64))
</code></pre>
<pre><code>depth
(61.0, 62.0]      17945
(62.0, 63.0]      15348
(59.999, 61.0]     8451
Name: count, dtype: int64
</code></pre>
<pre><code class="language-python"># Let us create a random vehicle crash dataframe with three columns showing
# city, cause of crash, and the dollar loss from the accident.
# Some of the values are missing, and indicated as a NaN (we create Nan
# values using np.nan)

df = pd.DataFrame(data = {'city': ['NYC', np.nan, 'Boston', 'Boston', 
                                   'WashingtonDC', np.nan, 'Boston', 
                                   'NYC', 'Boston', 'NYC'],
                         'cause': ['distracted', 'drowsy', 'drowsy', 
                                   np.nan, 'drunk', 'distracted', 
                                   'distracted', np.nan, np.nan, 'drunk'],
                         'dollar_loss': [8194, 4033, 9739, 4876, 4421, 
                                         6094, 5080, 2909, 9712, 2450]})

df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>cause</th>
      <th>dollar_loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NYC</td>
      <td>distracted</td>
      <td>8194</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>drowsy</td>
      <td>4033</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Boston</td>
      <td>drowsy</td>
      <td>9739</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Boston</td>
      <td>NaN</td>
      <td>4876</td>
    </tr>
    <tr>
      <th>4</th>
      <td>WashingtonDC</td>
      <td>drunk</td>
      <td>4421</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>distracted</td>
      <td>6094</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Boston</td>
      <td>distracted</td>
      <td>5080</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NYC</td>
      <td>NaN</td>
      <td>2909</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Boston</td>
      <td>NaN</td>
      <td>9712</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NYC</td>
      <td>drunk</td>
      <td>2450</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Let us check the value_counts by city
# By default, missing values are ignored.
# So you don't see the NaNs.
# You can address it by setting dropna = False, as in the next cell

df.city.value_counts()
</code></pre>
<pre><code>city
Boston          4
NYC             3
WashingtonDC    1
Name: count, dtype: int64
</code></pre>
<pre><code class="language-python">df.city.value_counts(dropna = False)
</code></pre>
<pre><code>city
Boston          4
NYC             3
NaN             2
WashingtonDC    1
Name: count, dtype: int64
</code></pre>
<pre><code class="language-python"># Instead of counts, you can ask for percentages (expressed as a decimal)

df.city.value_counts(dropna = False, normalize = True)
</code></pre>
<pre><code>city
Boston          0.4
NYC             0.3
NaN             0.2
WashingtonDC    0.1
Name: proportion, dtype: float64
</code></pre>
<pre><code class="language-python"># Sometimes, you may use the cumulative sum function to get 
# totals upto that value.  Try to run the cell to understand what it does.

df.city.value_counts().cumsum()
</code></pre>
<pre><code>city
Boston          4
NYC             7
WashingtonDC    8
Name: count, dtype: int64
</code></pre>
<pre><code class="language-python">df.city.value_counts(dropna = False, normalize = True).cumsum()
</code></pre>
<pre><code>city
Boston          0.4
NYC             0.7
NaN             0.9
WashingtonDC    1.0
Name: proportion, dtype: float64
</code></pre>
<h2 id="extract-unique-values">Extract unique values</h2>
<pre><code class="language-python">diamonds.cut.unique()
## You can put `tolist()` at the end to get a cleaner output, or enclose everything in `list`.
</code></pre>
<pre><code>['Ideal', 'Premium', 'Good', 'Very Good', 'Fair']
Categories (5, object): ['Ideal', 'Premium', 'Very Good', 'Good', 'Fair']
</code></pre>
<h2 id="groupby">Groupby</h2>
<p><code>groupby</code> and <code>rename</code> use as parameters the <code>dict</code> format, which is curly brackets, and key : value, each within quotes.</p>
<p>For example, <code>{"old_colname" : "new_colname", "old_colname2" : "new_colname2"}</code> </p>
<pre><code class="language-python">mydf = diamonds.groupby('cut', observed=True)
summ = mydf.agg({&quot;price&quot;: &quot;sum&quot;, &quot;clarity&quot;: &quot;count&quot;, &quot;table&quot;: &quot;mean&quot;}) 
summ
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>clarity</th>
      <th>table</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>74513487</td>
      <td>21551</td>
      <td>55.951668</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>63221498</td>
      <td>13791</td>
      <td>58.746095</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>48107623</td>
      <td>12082</td>
      <td>57.956150</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>19275009</td>
      <td>4906</td>
      <td>58.694639</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>7017600</td>
      <td>1610</td>
      <td>59.053789</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Alternatively, everything could be combined together:
diamonds.groupby('cut', observed=True).agg({&quot;price&quot;: &quot;sum&quot;, &quot;clarity&quot;: &quot;count&quot;, &quot;table&quot;: &quot;mean&quot;})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>clarity</th>
      <th>table</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>74513487</td>
      <td>21551</td>
      <td>55.951668</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>63221498</td>
      <td>13791</td>
      <td>58.746095</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>48107623</td>
      <td>12082</td>
      <td>57.956150</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>19275009</td>
      <td>4906</td>
      <td>58.694639</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>7017600</td>
      <td>1610</td>
      <td>59.053789</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Or, groupby two variables:
diamonds.groupby(['cut', 'color'], observed=True).agg({&quot;price&quot;: &quot;sum&quot;, &quot;clarity&quot;: &quot;count&quot;, &quot;table&quot;: &quot;mean&quot;})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>price</th>
      <th>clarity</th>
      <th>table</th>
    </tr>
    <tr>
      <th>cut</th>
      <th>color</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">Ideal</th>
      <th>D</th>
      <td>7450854</td>
      <td>2834</td>
      <td>55.965632</td>
    </tr>
    <tr>
      <th>E</th>
      <td>10138238</td>
      <td>3903</td>
      <td>55.967461</td>
    </tr>
    <tr>
      <th>F</th>
      <td>12912518</td>
      <td>3826</td>
      <td>55.924203</td>
    </tr>
    <tr>
      <th>G</th>
      <td>18171930</td>
      <td>4884</td>
      <td>55.902375</td>
    </tr>
    <tr>
      <th>H</th>
      <td>12115278</td>
      <td>3115</td>
      <td>55.965843</td>
    </tr>
    <tr>
      <th>I</th>
      <td>9317974</td>
      <td>2093</td>
      <td>56.021357</td>
    </tr>
    <tr>
      <th>J</th>
      <td>4406695</td>
      <td>896</td>
      <td>56.012612</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Premium</th>
      <th>D</th>
      <td>5820962</td>
      <td>1603</td>
      <td>58.718964</td>
    </tr>
    <tr>
      <th>E</th>
      <td>8270443</td>
      <td>2337</td>
      <td>58.779461</td>
    </tr>
    <tr>
      <th>F</th>
      <td>10081319</td>
      <td>2331</td>
      <td>58.679279</td>
    </tr>
    <tr>
      <th>G</th>
      <td>13160170</td>
      <td>2924</td>
      <td>58.702360</td>
    </tr>
    <tr>
      <th>H</th>
      <td>12311428</td>
      <td>2360</td>
      <td>58.792034</td>
    </tr>
    <tr>
      <th>I</th>
      <td>8491146</td>
      <td>1428</td>
      <td>58.771849</td>
    </tr>
    <tr>
      <th>J</th>
      <td>5086030</td>
      <td>808</td>
      <td>58.874752</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Very Good</th>
      <th>D</th>
      <td>5250817</td>
      <td>1513</td>
      <td>58.041309</td>
    </tr>
    <tr>
      <th>E</th>
      <td>7715165</td>
      <td>2400</td>
      <td>58.038875</td>
    </tr>
    <tr>
      <th>F</th>
      <td>8177367</td>
      <td>2164</td>
      <td>57.848429</td>
    </tr>
    <tr>
      <th>G</th>
      <td>8903461</td>
      <td>2299</td>
      <td>57.784428</td>
    </tr>
    <tr>
      <th>H</th>
      <td>8272552</td>
      <td>1824</td>
      <td>57.903015</td>
    </tr>
    <tr>
      <th>I</th>
      <td>6328079</td>
      <td>1204</td>
      <td>58.105150</td>
    </tr>
    <tr>
      <th>J</th>
      <td>3460182</td>
      <td>678</td>
      <td>58.277729</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Good</th>
      <th>D</th>
      <td>2254363</td>
      <td>662</td>
      <td>58.541541</td>
    </tr>
    <tr>
      <th>E</th>
      <td>3194260</td>
      <td>933</td>
      <td>58.779957</td>
    </tr>
    <tr>
      <th>F</th>
      <td>3177637</td>
      <td>909</td>
      <td>58.910891</td>
    </tr>
    <tr>
      <th>G</th>
      <td>3591553</td>
      <td>871</td>
      <td>58.471986</td>
    </tr>
    <tr>
      <th>H</th>
      <td>3001931</td>
      <td>702</td>
      <td>58.611111</td>
    </tr>
    <tr>
      <th>I</th>
      <td>2650994</td>
      <td>522</td>
      <td>58.773946</td>
    </tr>
    <tr>
      <th>J</th>
      <td>1404271</td>
      <td>307</td>
      <td>58.813029</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Fair</th>
      <th>D</th>
      <td>699443</td>
      <td>163</td>
      <td>58.969325</td>
    </tr>
    <tr>
      <th>E</th>
      <td>824838</td>
      <td>224</td>
      <td>59.364732</td>
    </tr>
    <tr>
      <th>F</th>
      <td>1194025</td>
      <td>312</td>
      <td>59.453205</td>
    </tr>
    <tr>
      <th>G</th>
      <td>1331126</td>
      <td>314</td>
      <td>58.773248</td>
    </tr>
    <tr>
      <th>H</th>
      <td>1556112</td>
      <td>303</td>
      <td>58.696370</td>
    </tr>
    <tr>
      <th>I</th>
      <td>819953</td>
      <td>175</td>
      <td>59.237143</td>
    </tr>
    <tr>
      <th>J</th>
      <td>592103</td>
      <td>119</td>
      <td>58.917647</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="rename-columns-with-groupby"><code>rename</code> columns with Groupby</h3>
<pre><code class="language-python">## We continue the above examples to rename the aggregated columns we created using groupby

diamonds.groupby('cut', observed=True).agg({&quot;price&quot;: &quot;sum&quot;, 
                             &quot;clarity&quot;: &quot;count&quot;}).rename(columns = {&quot;price&quot;: &quot;total_price&quot;, &quot;clarity&quot;: &quot;diamond_count&quot;})
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_price</th>
      <th>diamond_count</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ideal</th>
      <td>74513487</td>
      <td>21551</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>63221498</td>
      <td>13791</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>48107623</td>
      <td>12082</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>19275009</td>
      <td>4906</td>
    </tr>
    <tr>
      <th>Fair</th>
      <td>7017600</td>
      <td>1610</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="joining-data-with-merge">Joining Data with Merge</h2>
<p>The data analyst often has to combine data frames much in the same way as database join operations work, which requires connecting two tables based on a reference field.</p>
<p>(joins of all types are discussed here: https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.htmlhttps://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html)</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/78b71cc6-89ae-4f04-9ed6-8e41fe13f10a.png" /></p>
<ul>
<li>Outer Join = A + B + C (keep everything)  </li>
<li>Inner Join = B (keep only the intersection)  </li>
<li>Left Join = A + B (keep all from the left)  </li>
<li>Right Join = B + C (keep all from the right)  </li>
</ul>
<p>You can join data using the pandas merge function.</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/3cd9d80e-b0b1-4245-8bb8-3f2a88cfb068.png" /></p>
<hr />
<p>Consider the below data frames.  The first one is the <strong>left</strong> data frame, and the second one is the <strong>right</strong> data frame.  </p>
<p>Next consider the four types of joins - left, right, inner and outer.</p>
<pre><code class="language-python">## Left data frame

np.random.seed(2)
n = 5
df = pd.DataFrame(
    {'state': list(np.random.choice([&quot;New York&quot;, &quot;Florida&quot;, &quot;California&quot;], size=(n))), 
     'gender': list(np.random.choice([&quot;Male&quot;, &quot;Female&quot;], size=(n), p=[.4, .6])),
     'housing': list(np.random.choice([&quot;Rent&quot;, &quot;Own&quot;], size=(n))),     
     'height': list(np.random.randint(140,200,n))
     })
</code></pre>
<pre><code class="language-python">## Left data frame

df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New York</td>
      <td>Female</td>
      <td>Own</td>
      <td>177</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>179</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>143</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>Female</td>
      <td>Rent</td>
      <td>178</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>Male</td>
      <td>Rent</td>
      <td>144</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Right data frame

df_rent = pd.DataFrame(
          {'state': [&quot;Connecticut&quot;, &quot;Florida&quot;, &quot;California&quot;],
           'avg_rent': [3500, 2200, 4500]})
</code></pre>
<pre><code class="language-python">## Right data frame

df_rent
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>avg_rent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Connecticut</td>
      <td>3500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>2200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>California</td>
      <td>4500</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="left-join">Left Join</h3>
<pre><code class="language-python">df.merge(df_rent, how = 'left' , 
         left_on = 'state', right_on = 'state')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
      <th>avg_rent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New York</td>
      <td>Female</td>
      <td>Own</td>
      <td>177</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>179</td>
      <td>2200.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>143</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>Female</td>
      <td>Rent</td>
      <td>178</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>Male</td>
      <td>Rent</td>
      <td>144</td>
      <td>4500.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="right-join">Right Join</h3>
<pre><code class="language-python">df.merge(df_rent, how = 'right' , 
         left_on = 'state', right_on = 'state')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
      <th>avg_rent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Connecticut</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>179.0</td>
      <td>2200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>California</td>
      <td>Female</td>
      <td>Rent</td>
      <td>178.0</td>
      <td>4500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>Male</td>
      <td>Rent</td>
      <td>144.0</td>
      <td>4500</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="inner-join">Inner Join</h3>
<pre><code class="language-python">df.merge(df_rent, how = 'inner' , 
         left_on = 'state', right_on = 'state')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
      <th>avg_rent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>179</td>
      <td>2200</td>
    </tr>
    <tr>
      <th>1</th>
      <td>California</td>
      <td>Female</td>
      <td>Rent</td>
      <td>178</td>
      <td>4500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>California</td>
      <td>Male</td>
      <td>Rent</td>
      <td>144</td>
      <td>4500</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="outer-join">Outer Join</h3>
<pre><code class="language-python">df.merge(df_rent, how = 'outer' , 
         left_on = 'state', right_on = 'state')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
      <th>avg_rent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>New York</td>
      <td>Female</td>
      <td>Own</td>
      <td>177.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>143.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>179.0</td>
      <td>2200.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>Female</td>
      <td>Rent</td>
      <td>178.0</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>Male</td>
      <td>Rent</td>
      <td>144.0</td>
      <td>4500.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Connecticut</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3500.0</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="concatenation">Concatenation</h2>
<p>Sometimes we need to simply combine datasets without any fancy operations.  </p>
<p>Imagine you have 3 files, each for a different month, and you need to stack them vertically one after the other.</p>
<p>Occasionally, you may need to stack datasets horizontally, ie right next to each other.  For example, imagine you have 2 files, one with names and ages, and the other with names and income. You may just want to ‘stack’ the data next to each other.</p>
<p>As a common operation, this can be done with Pandas’s concat() command.</p>
<p>We use the same df and df_rent dataframes as in the prior slide to illustrate how pd.concat works.</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/694ee333-fdab-4208-8249-dbdf145827ad.png" /></p>
<pre><code class="language-python">pd.concat([df_rent, df], axis = 1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>avg_rent</th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Connecticut</td>
      <td>3500.0</td>
      <td>New York</td>
      <td>Female</td>
      <td>Own</td>
      <td>177</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>2200.0</td>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>179</td>
    </tr>
    <tr>
      <th>2</th>
      <td>California</td>
      <td>4500.0</td>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>143</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>California</td>
      <td>Female</td>
      <td>Rent</td>
      <td>178</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>California</td>
      <td>Male</td>
      <td>Rent</td>
      <td>144</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">pd.concat([df_rent, df], axis = 0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>avg_rent</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Connecticut</td>
      <td>3500.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>2200.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>California</td>
      <td>4500.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>New York</td>
      <td>NaN</td>
      <td>Female</td>
      <td>Own</td>
      <td>177.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Florida</td>
      <td>NaN</td>
      <td>Male</td>
      <td>Rent</td>
      <td>179.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>NaN</td>
      <td>Male</td>
      <td>Rent</td>
      <td>143.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>California</td>
      <td>NaN</td>
      <td>Female</td>
      <td>Rent</td>
      <td>178.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>NaN</td>
      <td>Male</td>
      <td>Rent</td>
      <td>144.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="concatenation-example">Concatenation example</h3>
<p>We load the penguins dataset.</p>
<pre><code class="language-python"># Load the penguins dataset

df = sns.load_dataset('penguins')
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.8</td>
      <td>14.3</td>
      <td>215.0</td>
      <td>4850.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>50.4</td>
      <td>15.7</td>
      <td>222.0</td>
      <td>5750.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.2</td>
      <td>14.8</td>
      <td>212.0</td>
      <td>5200.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>343</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>49.9</td>
      <td>16.1</td>
      <td>213.0</td>
      <td>5400.0</td>
      <td>Male</td>
    </tr>
  </tbody>
</table>
<p>344 rows × 7 columns</p>
</div>

<pre><code class="language-python">df1 = df.sample(6).reset_index(drop=True)
df2 = df.sample(4).reset_index(drop=True)
</code></pre>
<pre><code class="language-python">df1
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.2</td>
      <td>15.8</td>
      <td>215.0</td>
      <td>5300.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.9</td>
      <td>18.6</td>
      <td>172.0</td>
      <td>3150.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.8</td>
      <td>18.3</td>
      <td>174.0</td>
      <td>3400.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Dream</td>
      <td>40.6</td>
      <td>17.2</td>
      <td>187.0</td>
      <td>3475.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.1</td>
      <td>17.9</td>
      <td>190.0</td>
      <td>3400.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.5</td>
      <td>13.5</td>
      <td>210.0</td>
      <td>4550.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df2
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.4</td>
      <td>15.6</td>
      <td>221.0</td>
      <td>5000.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>48.4</td>
      <td>14.4</td>
      <td>203.0</td>
      <td>4625.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>49.0</td>
      <td>16.1</td>
      <td>216.0</td>
      <td>5550.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>35.9</td>
      <td>16.6</td>
      <td>190.0</td>
      <td>3050.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">pd.concat([df1,df2], axis=0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.2</td>
      <td>15.8</td>
      <td>215.0</td>
      <td>5300.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.9</td>
      <td>18.6</td>
      <td>172.0</td>
      <td>3150.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.8</td>
      <td>18.3</td>
      <td>174.0</td>
      <td>3400.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Dream</td>
      <td>40.6</td>
      <td>17.2</td>
      <td>187.0</td>
      <td>3475.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.1</td>
      <td>17.9</td>
      <td>190.0</td>
      <td>3400.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.5</td>
      <td>13.5</td>
      <td>210.0</td>
      <td>4550.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.4</td>
      <td>15.6</td>
      <td>221.0</td>
      <td>5000.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>48.4</td>
      <td>14.4</td>
      <td>203.0</td>
      <td>4625.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>49.0</td>
      <td>16.1</td>
      <td>216.0</td>
      <td>5550.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>35.9</td>
      <td>16.6</td>
      <td>190.0</td>
      <td>3050.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">pd.concat([df1,df2], axis=1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.2</td>
      <td>15.8</td>
      <td>215.0</td>
      <td>5300.0</td>
      <td>Male</td>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.4</td>
      <td>15.6</td>
      <td>221.0</td>
      <td>5000.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.9</td>
      <td>18.6</td>
      <td>172.0</td>
      <td>3150.0</td>
      <td>Female</td>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>48.4</td>
      <td>14.4</td>
      <td>203.0</td>
      <td>4625.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.8</td>
      <td>18.3</td>
      <td>174.0</td>
      <td>3400.0</td>
      <td>Female</td>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>49.0</td>
      <td>16.1</td>
      <td>216.0</td>
      <td>5550.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Dream</td>
      <td>40.6</td>
      <td>17.2</td>
      <td>187.0</td>
      <td>3475.0</td>
      <td>Male</td>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>35.9</td>
      <td>16.6</td>
      <td>190.0</td>
      <td>3050.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.1</td>
      <td>17.9</td>
      <td>190.0</td>
      <td>3400.0</td>
      <td>Female</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.5</td>
      <td>13.5</td>
      <td>210.0</td>
      <td>4550.0</td>
      <td>Female</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df2.index = [3,4,5,6]
</code></pre>
<pre><code class="language-python">pd.concat([df1,df2], axis=0)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.2</td>
      <td>15.8</td>
      <td>215.0</td>
      <td>5300.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.9</td>
      <td>18.6</td>
      <td>172.0</td>
      <td>3150.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.8</td>
      <td>18.3</td>
      <td>174.0</td>
      <td>3400.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Dream</td>
      <td>40.6</td>
      <td>17.2</td>
      <td>187.0</td>
      <td>3475.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.1</td>
      <td>17.9</td>
      <td>190.0</td>
      <td>3400.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.5</td>
      <td>13.5</td>
      <td>210.0</td>
      <td>4550.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.4</td>
      <td>15.6</td>
      <td>221.0</td>
      <td>5000.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>48.4</td>
      <td>14.4</td>
      <td>203.0</td>
      <td>4625.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>49.0</td>
      <td>16.1</td>
      <td>216.0</td>
      <td>5550.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>35.9</td>
      <td>16.6</td>
      <td>190.0</td>
      <td>3050.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">pd.concat([df1,df2], axis=1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.2</td>
      <td>15.8</td>
      <td>215.0</td>
      <td>5300.0</td>
      <td>Male</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.9</td>
      <td>18.6</td>
      <td>172.0</td>
      <td>3150.0</td>
      <td>Female</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>37.8</td>
      <td>18.3</td>
      <td>174.0</td>
      <td>3400.0</td>
      <td>Female</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Dream</td>
      <td>40.6</td>
      <td>17.2</td>
      <td>187.0</td>
      <td>3475.0</td>
      <td>Male</td>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.4</td>
      <td>15.6</td>
      <td>221.0</td>
      <td>5000.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Chinstrap</td>
      <td>Dream</td>
      <td>50.1</td>
      <td>17.9</td>
      <td>190.0</td>
      <td>3400.0</td>
      <td>Female</td>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>48.4</td>
      <td>14.4</td>
      <td>203.0</td>
      <td>4625.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.5</td>
      <td>13.5</td>
      <td>210.0</td>
      <td>4550.0</td>
      <td>Female</td>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>49.0</td>
      <td>16.1</td>
      <td>216.0</td>
      <td>5550.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>35.9</td>
      <td>16.6</td>
      <td>190.0</td>
      <td>3050.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Notice above dataframe has columns with identical names
# For example,the column bill_depth_mm appears twice.
# If we try to select that column, all columns with that name are listed

temp = pd.concat([df1,df2], axis=1)
temp[['bill_depth_mm']]
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bill_depth_mm</th>
      <th>bill_depth_mm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.8</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17.2</td>
      <td>15.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.9</td>
      <td>14.4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13.5</td>
      <td>16.1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>16.6</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="dealing-with-missing-values">Dealing with Missing Values</h2>
<p>Missing data takes one of two forms.<br />
1. Entire rows of data may be missing: In such situations, you will need to think about if the remaining data set is still valuable.<br />
 - Consider if you can assess how much data is missing.  If only a small portion of the data is missing, say 10%, then you may still be able to use it for meaningful analytics.<br />
 - Consider why the data is missing.  If the absent data is missing at random, what you have available may still be a representative sample.<br />
 - Consider if you can re-acquire the data, or address the underlying problems and wait to collect the complete dataset.<br />
2. Some values may be missing in the data, while others are present.<br />
 - We can remove the rows that have missing values.<br />
 - We can replace the missing values with a static default (eg, the mean, or the median).<br />
 - We can try to compute the values in a more structured way.  </p>
<p>An example of missing data appears in the picture below.  Next, we will create this dataset and artifically insert some missing values.</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/2fdd3825-8ad8-4bd4-a442-dc0e426ca305.png" /></p>
<pre><code class="language-python">## We create a random dataset

np.random.seed(1)
n = 5
df = pd.DataFrame(
    {'state': list(np.random.choice([&quot;New York&quot;, &quot;Florida&quot;, &quot;California&quot;], size=(n))), 
     'gender': list(np.random.choice([&quot;Male&quot;, &quot;Female&quot;], size=(n), p=[.4, .6])),
     'housing': list(np.random.choice([&quot;Rent&quot;, &quot;Own&quot;], size=(n))),    
     'height': list(np.random.randint(140,200,n))
     })
</code></pre>
<pre><code class="language-python">## Now we loop through the data and replace a quarter of the values with NaN (`np.nan`)

for row in range(df.shape[0]):
    for col in range(df.shape[1]):
        if np.random.uniform() &lt; 0.25:
            df.iloc[row,col] = np.nan
</code></pre>
<pre><code class="language-python">## Notice the `NaN` values inserted  
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>NaN</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="understanding-the-extent-of-missing-values">Understanding the extent of missing values</h3>
<p>We can count the number of null values, by rows as well as columns.  </p>
<p>In pandas, it is easy to identify null values using <code>df.isna()</code>.  While this provides us a series of True/False Booleans, we can use the <code>sum()</code> command to get the total count of nulls as Booleans are also considered equal to 1 and 0 (for True and False respectively).  </p>
<p>Using the axis parameter, we can specify whether to count missing values by rows (<code>axis = 1</code>) or by columns (<code>axis = 0</code>, the default).  </p>
<ul>
<li>Count of nulls for each column: <code>df.isna().sum(axis=0)</code>  </li>
<li>Count of nulls for each row: <code>df.isna().sum(axis=1)</code>  </li>
</ul>
<pre><code class="language-python">## Count missing values - by columns

df.isna().sum(axis=0)

</code></pre>
<pre><code>state      1
gender     0
housing    1
height     1
dtype: int64
</code></pre>
<pre><code class="language-python">## Count missing values - by rows

df.isna().sum(axis=1)

</code></pre>
<pre><code>0    0
1    0
2    1
3    1
4    1
dtype: int64
</code></pre>
<pre><code class="language-python">## Count missing values - by columns, sorted

df.isna().sum(axis=0).sort_values(ascending=False)

</code></pre>
<pre><code>state      1
housing    1
height     1
gender     0
dtype: int64
</code></pre>
<pre><code class="language-python">df.isna().sum(axis=1).sort_values(ascending=False)
</code></pre>
<pre><code>2    1
3    1
4    1
0    0
1    0
dtype: int64
</code></pre>
<h3 id="how-to-think-about-missing-values">How to think about missing values</h3>
<p>Sometimes, entire rows/observations or columns/features data may be missing in the data (for example, you discover that you are missing data for a city, person, year etc).  If the data is not there in the first place, there is no easy programmatic way to discover the omission.  You may find out about it only accidentally, or through your exploratory data analysis.  </p>
<p>In such situations, you will need to think about if the remaining data set is still valuable.<br />
 - Consider if you can assess how much data is missing.  If only a small portion of the data is missing, say 10%, then you may still be able to use it for meaningful analytics.<br />
 - Consider why the data is missing.  If the absent data is missing at random, what you have available may still be a representative sample.<br />
 - Consider if you can re-acquire the data, or address the underlying problems and wait to collect the complete dataset.  </p>
<p><strong>Approaches</strong><br />
When some values in the data are missing:<br />
1. <strong>Drop rows with nulls:</strong> If data is missing at random, and the remaining data is sufficient for us to build generalizable analytics and models.<br />
   - If data is not missing at random, and rows with missing data are dropped, this can introduce bias into our models.<br />
3. <strong>Drop features/columns with nulls:</strong> Features that have a great deal of data missing at random can often be dropped without affecting analytical usefulness.<br />
4. <strong>Replace with a static default:</strong> Using a summary statistic, eg mean or median, is often an easy way to replace missing values.<br />
5. <strong>Impute missing values</strong> using more advanced methods.  </p>
<pre><code class="language-python">
</code></pre>
<h4 id="drop-missing-values">Drop Missing Values</h4>
<p>The simplest approach is to drop the rows that have a missing value.  This will leave only the rows that are fully populated.  </p>
<p>Pandas offers the function <code>dropna()</code> to remove rows with missing values.</p>
<p>You can control which rows are deleted:</p>
<ul>
<li>Set a threshold <em>n</em> – at least <em>n</em> values must be missing before the row is dropped</li>
<li>Any or All – whether all values should be missing, or any missing values.</li>
</ul>
<h5 id="drop-rows-with-missing-values">Drop rows with missing values</h5>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>NaN</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df.dropna()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
  </tbody>
</table>
</div>

<h5 id="drop-columns-with-missing-values">Drop columns with missing values</h5>
<p>Very similar approach as for rows, except the axis along which we evaluate deletion is vertical instead of horizontal.</p>
<p>Any columns that have a missing value are deleted.</p>
<pre><code class="language-python">df.dropna(axis = 1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Male</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Male</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>NaN</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="fill-missing-data">Fill Missing Data</h4>
<p>Dropping rows or columns that have missing data may not always be a feasible strategy as the remainder of the dataset may become too small.  </p>
<p>Another reason is that we may not want to throw away all the other known information just because one data point for an observation or a feature is not known.</p>
<p>If the data is not missing at random (for example, one sensor in the data collection apparatus was malfunctioning) and all the NaN values relate to a particular type of observation, we will introduce bias into any analytics we perform.</p>
<p>A viable approach in such cases may be to replace the missing values with an estimate, such as the mean, the median, or the most frequent value.</p>
<p>Using <code>pd.fillna()</code>, we can fill any holes in the data in a number of ways.
With <code>df.fillna(constant)</code>, we can replace all <code>NaN</code> values with a constant we specify.  However, if <code>NaN</code>s appear in multiple columns, we may need to specify a different constant for each column.</p>
<p>With <code>pd.fillna(data.mean())</code>, we can replace <code>NaN</code>s with the mean, and similarly for median and other calculated measures.</p>
<pre><code class="language-python">## Fill missing values across the entire dataframe

df.fillna('Connecticut')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Connecticut</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Connecticut</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>Connecticut</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Fill missing values in only a single column

df['state'].fillna('Connecticut', inplace = True)
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Connecticut</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>NaN</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="forward-and-backward-fill">Forward and Backward Fill</h3>
<p>For time series data, we might like to use forward-fill (also called ‘last-observation-carried-forward’, or locf), and backward-fill (opposite of locf).</p>
<ul>
<li><code>df.ffill</code>: propagate last valid observation forward to next valid</li>
<li><code>df.bfill</code>: use next valid observation to fill gap.</li>
</ul>
<pre><code class="language-python">## Let us make some of the height numbers NaN
df.loc[[0,3], 'height'] = np.nan
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Connecticut</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Forward fill
df.ffill()

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Connecticut</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Backward fill
df.bfill()

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>gender</th>
      <th>housing</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>New York</td>
      <td>Male</td>
      <td>Rent</td>
      <td>151.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Connecticut</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Florida</td>
      <td>Male</td>
      <td>Rent</td>
      <td>182.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># We load some data on sales of independent winemakers
import pmdarima
df = pd.DataFrame(pmdarima.datasets.load_wineind(as_series = True), columns=['sales'])
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jan 1980</th>
      <td>15136.0</td>
    </tr>
    <tr>
      <th>Feb 1980</th>
      <td>16733.0</td>
    </tr>
    <tr>
      <th>Mar 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>Apr 1980</th>
      <td>17708.0</td>
    </tr>
    <tr>
      <th>May 1980</th>
      <td>18019.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>Apr 1994</th>
      <td>26323.0</td>
    </tr>
    <tr>
      <th>May 1994</th>
      <td>23779.0</td>
    </tr>
    <tr>
      <th>Jun 1994</th>
      <td>27549.0</td>
    </tr>
    <tr>
      <th>Jul 1994</th>
      <td>29660.0</td>
    </tr>
    <tr>
      <th>Aug 1994</th>
      <td>23356.0</td>
    </tr>
  </tbody>
</table>
<p>176 rows × 1 columns</p>
</div>

<pre><code class="language-python">## Now we loop through the data and replace a quarter of the values with NaN (`np.nan`)

for row in range(df.shape[0]):
    for col in range(df.shape[1]):
        if np.random.uniform() &lt; 0.5:
            df.iloc[row,col] = np.nan
</code></pre>
<pre><code class="language-python">df = df[:20]
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jan 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Feb 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mar 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>Apr 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>May 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Jun 1980</th>
      <td>19227.0</td>
    </tr>
    <tr>
      <th>Jul 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Aug 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Sep 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oct 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Nov 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Dec 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Jan 1981</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Feb 1981</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Mar 1981</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Apr 1981</th>
      <td>21354.0</td>
    </tr>
    <tr>
      <th>May 1981</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Jun 1981</th>
      <td>22125.0</td>
    </tr>
    <tr>
      <th>Jul 1981</th>
      <td>25817.0</td>
    </tr>
    <tr>
      <th>Aug 1981</th>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df.ffill()
</code></pre>
<pre><code>C:\Users\user\AppData\Local\Temp\ipykernel_21280\1145651979.py:1: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method = 'ffill')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jan 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Feb 1980</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Mar 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>Apr 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>May 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>Jun 1980</th>
      <td>19227.0</td>
    </tr>
    <tr>
      <th>Jul 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Aug 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Sep 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Oct 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Nov 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Dec 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Jan 1981</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Feb 1981</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Mar 1981</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Apr 1981</th>
      <td>21354.0</td>
    </tr>
    <tr>
      <th>May 1981</th>
      <td>21354.0</td>
    </tr>
    <tr>
      <th>Jun 1981</th>
      <td>22125.0</td>
    </tr>
    <tr>
      <th>Jul 1981</th>
      <td>25817.0</td>
    </tr>
    <tr>
      <th>Aug 1981</th>
      <td>25817.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">df.bfill()
</code></pre>
<pre><code>C:\Users\user\AppData\Local\Temp\ipykernel_21280\3673297803.py:1: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  df.fillna(method = 'bfill')
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jan 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>Feb 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>Mar 1980</th>
      <td>20016.0</td>
    </tr>
    <tr>
      <th>Apr 1980</th>
      <td>19227.0</td>
    </tr>
    <tr>
      <th>May 1980</th>
      <td>19227.0</td>
    </tr>
    <tr>
      <th>Jun 1980</th>
      <td>19227.0</td>
    </tr>
    <tr>
      <th>Jul 1980</th>
      <td>22893.0</td>
    </tr>
    <tr>
      <th>Aug 1980</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Sep 1980</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Oct 1980</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Nov 1980</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Dec 1980</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Jan 1981</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Feb 1981</th>
      <td>17977.0</td>
    </tr>
    <tr>
      <th>Mar 1981</th>
      <td>21354.0</td>
    </tr>
    <tr>
      <th>Apr 1981</th>
      <td>21354.0</td>
    </tr>
    <tr>
      <th>May 1981</th>
      <td>22125.0</td>
    </tr>
    <tr>
      <th>Jun 1981</th>
      <td>22125.0</td>
    </tr>
    <tr>
      <th>Jul 1981</th>
      <td>25817.0</td>
    </tr>
    <tr>
      <th>Aug 1981</th>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">
</code></pre>
<hr />
<h2 id="imputation-using-sklearn">Imputation using sklearn</h2>
<p>Discarding entire rows or columns, or replacing information with the mean etc may work well in some situations.
A more sophisticated approach may be to model the missing data, and use ML techniques to estimate the missing information.</p>
<p>Scikit-learn’s documentation describes multivariate feature imputation as follows: </p>
<blockquote>
<p>A more sophisticated approach is to use the IterativeImputer class, which models each feature with missing values as a function of other features, and uses that estimate for imputation. It does so in an iterated round-robin fashion: at each step, a feature column is designated as output y and the other feature columns are treated as inputs X. A regressor is fit on (X, y) for known y. Then, the regressor is used to predict the missing values of y. This is done for each feature in an iterative fashion, and then is repeated for max_iter imputation rounds. The results of the final imputation round are returned.</p>
</blockquote>
<p><em>Source: https://scikit-learn.org/stable/modules/impute.html</em></p>
<p>The R ecosystem has several libraries that implement the MICE algorithm.  </p>
<p>A nice write-up and graphic explaining the process is available here: https://cran.r-project.org/web/packages/miceRanger/vignettes/miceAlgorithm.html</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/7f6f9f7d-73ae-41c8-ab5a-0570cc8a2175.png" />
<img alt="image.png" src="../04_Data_Preparation_files/355814ad-93ad-4281-a60a-052555e5a452.png" />
<img alt="image.png" src="../04_Data_Preparation_files/79e113fc-faa7-4de1-afcf-4adfaa8880e1.png" />
<em>Sourced from cran.r-project.org</em></p>
<p>Let us get some data where we can perform some imputations.  But because we are working with Python, we will not use the above, but use sklearn's imputer.</p>
<pre><code class="language-python">## Let us look at the mtcars dataset

import statsmodels.api as sm
df = sm.datasets.get_rdataset('mtcars').data
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>rownames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6</td>
      <td>160.0</td>
      <td>110</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>17.02</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4</td>
      <td>108.0</td>
      <td>93</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.4</td>
      <td>6</td>
      <td>258.0</td>
      <td>110</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8</td>
      <td>360.0</td>
      <td>175</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>6</td>
      <td>225.0</td>
      <td>105</td>
      <td>2.76</td>
      <td>3.460</td>
      <td>20.22</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>8</td>
      <td>360.0</td>
      <td>245</td>
      <td>3.21</td>
      <td>3.570</td>
      <td>15.84</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>4</td>
      <td>146.7</td>
      <td>62</td>
      <td>3.69</td>
      <td>3.190</td>
      <td>20.00</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Merc 230</th>
      <td>22.8</td>
      <td>4</td>
      <td>140.8</td>
      <td>95</td>
      <td>3.92</td>
      <td>3.150</td>
      <td>22.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Merc 280</th>
      <td>19.2</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.30</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 280C</th>
      <td>17.8</td>
      <td>6</td>
      <td>167.6</td>
      <td>123</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.90</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Merc 450SE</th>
      <td>16.4</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>4.070</td>
      <td>17.40</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Merc 450SL</th>
      <td>17.3</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.730</td>
      <td>17.60</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Merc 450SLC</th>
      <td>15.2</td>
      <td>8</td>
      <td>275.8</td>
      <td>180</td>
      <td>3.07</td>
      <td>3.780</td>
      <td>18.00</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Cadillac Fleetwood</th>
      <td>10.4</td>
      <td>8</td>
      <td>472.0</td>
      <td>205</td>
      <td>2.93</td>
      <td>5.250</td>
      <td>17.98</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Lincoln Continental</th>
      <td>10.4</td>
      <td>8</td>
      <td>460.0</td>
      <td>215</td>
      <td>3.00</td>
      <td>5.424</td>
      <td>17.82</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Chrysler Imperial</th>
      <td>14.7</td>
      <td>8</td>
      <td>440.0</td>
      <td>230</td>
      <td>3.23</td>
      <td>5.345</td>
      <td>17.42</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Fiat 128</th>
      <td>32.4</td>
      <td>4</td>
      <td>78.7</td>
      <td>66</td>
      <td>4.08</td>
      <td>2.200</td>
      <td>19.47</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Honda Civic</th>
      <td>30.4</td>
      <td>4</td>
      <td>75.7</td>
      <td>52</td>
      <td>4.93</td>
      <td>1.615</td>
      <td>18.52</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Toyota Corolla</th>
      <td>33.9</td>
      <td>4</td>
      <td>71.1</td>
      <td>65</td>
      <td>4.22</td>
      <td>1.835</td>
      <td>19.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Toyota Corona</th>
      <td>21.5</td>
      <td>4</td>
      <td>120.1</td>
      <td>97</td>
      <td>3.70</td>
      <td>2.465</td>
      <td>20.01</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Dodge Challenger</th>
      <td>15.5</td>
      <td>8</td>
      <td>318.0</td>
      <td>150</td>
      <td>2.76</td>
      <td>3.520</td>
      <td>16.87</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>AMC Javelin</th>
      <td>15.2</td>
      <td>8</td>
      <td>304.0</td>
      <td>150</td>
      <td>3.15</td>
      <td>3.435</td>
      <td>17.30</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Camaro Z28</th>
      <td>13.3</td>
      <td>8</td>
      <td>350.0</td>
      <td>245</td>
      <td>3.73</td>
      <td>3.840</td>
      <td>15.41</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Pontiac Firebird</th>
      <td>19.2</td>
      <td>8</td>
      <td>400.0</td>
      <td>175</td>
      <td>3.08</td>
      <td>3.845</td>
      <td>17.05</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Fiat X1-9</th>
      <td>27.3</td>
      <td>4</td>
      <td>79.0</td>
      <td>66</td>
      <td>4.08</td>
      <td>1.935</td>
      <td>18.90</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Porsche 914-2</th>
      <td>26.0</td>
      <td>4</td>
      <td>120.3</td>
      <td>91</td>
      <td>4.43</td>
      <td>2.140</td>
      <td>16.70</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Lotus Europa</th>
      <td>30.4</td>
      <td>4</td>
      <td>95.1</td>
      <td>113</td>
      <td>3.77</td>
      <td>1.513</td>
      <td>16.90</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Ford Pantera L</th>
      <td>15.8</td>
      <td>8</td>
      <td>351.0</td>
      <td>264</td>
      <td>4.22</td>
      <td>3.170</td>
      <td>14.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Ferrari Dino</th>
      <td>19.7</td>
      <td>6</td>
      <td>145.0</td>
      <td>175</td>
      <td>3.62</td>
      <td>2.770</td>
      <td>15.50</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Maserati Bora</th>
      <td>15.0</td>
      <td>8</td>
      <td>301.0</td>
      <td>335</td>
      <td>3.54</td>
      <td>3.570</td>
      <td>14.60</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Volvo 142E</th>
      <td>21.4</td>
      <td>4</td>
      <td>121.0</td>
      <td>109</td>
      <td>4.11</td>
      <td>2.780</td>
      <td>18.60</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">## Next, we replace a quarter of the values in the data with NaNs

for row in range(df.shape[0]):
    for col in range(df.shape[1]):
        if np.random.uniform() &lt; 0.25:
            df.iloc[row,col] = np.nan
</code></pre>
<pre><code class="language-python">df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>rownames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>NaN</td>
      <td>160.0</td>
      <td>110.0</td>
      <td>3.90</td>
      <td>2.620</td>
      <td>16.46</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>110.0</td>
      <td>3.90</td>
      <td>2.875</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4.0</td>
      <td>108.0</td>
      <td>NaN</td>
      <td>3.85</td>
      <td>2.320</td>
      <td>18.61</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>NaN</td>
      <td>6.0</td>
      <td>258.0</td>
      <td>110.0</td>
      <td>3.08</td>
      <td>3.215</td>
      <td>19.44</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8.0</td>
      <td>360.0</td>
      <td>NaN</td>
      <td>3.15</td>
      <td>3.440</td>
      <td>17.02</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>NaN</td>
      <td>225.0</td>
      <td>105.0</td>
      <td>2.76</td>
      <td>3.460</td>
      <td>20.22</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>8.0</td>
      <td>360.0</td>
      <td>245.0</td>
      <td>3.21</td>
      <td>3.570</td>
      <td>15.84</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>4.0</td>
      <td>146.7</td>
      <td>62.0</td>
      <td>3.69</td>
      <td>3.190</td>
      <td>20.00</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Merc 230</th>
      <td>22.8</td>
      <td>4.0</td>
      <td>140.8</td>
      <td>95.0</td>
      <td>NaN</td>
      <td>3.150</td>
      <td>22.90</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Merc 280</th>
      <td>19.2</td>
      <td>6.0</td>
      <td>167.6</td>
      <td>NaN</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>18.30</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Merc 280C</th>
      <td>17.8</td>
      <td>6.0</td>
      <td>167.6</td>
      <td>NaN</td>
      <td>3.92</td>
      <td>3.440</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Merc 450SE</th>
      <td>16.4</td>
      <td>NaN</td>
      <td>275.8</td>
      <td>180.0</td>
      <td>3.07</td>
      <td>4.070</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Merc 450SL</th>
      <td>17.3</td>
      <td>NaN</td>
      <td>275.8</td>
      <td>NaN</td>
      <td>3.07</td>
      <td>3.730</td>
      <td>17.60</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Merc 450SLC</th>
      <td>15.2</td>
      <td>8.0</td>
      <td>275.8</td>
      <td>180.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.00</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Cadillac Fleetwood</th>
      <td>NaN</td>
      <td>8.0</td>
      <td>472.0</td>
      <td>205.0</td>
      <td>2.93</td>
      <td>NaN</td>
      <td>17.98</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Lincoln Continental</th>
      <td>NaN</td>
      <td>8.0</td>
      <td>460.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.424</td>
      <td>17.82</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Chrysler Imperial</th>
      <td>14.7</td>
      <td>8.0</td>
      <td>440.0</td>
      <td>230.0</td>
      <td>3.23</td>
      <td>NaN</td>
      <td>17.42</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Fiat 128</th>
      <td>32.4</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>4.08</td>
      <td>2.200</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Honda Civic</th>
      <td>30.4</td>
      <td>4.0</td>
      <td>75.7</td>
      <td>NaN</td>
      <td>4.93</td>
      <td>1.615</td>
      <td>18.52</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Toyota Corolla</th>
      <td>33.9</td>
      <td>4.0</td>
      <td>71.1</td>
      <td>NaN</td>
      <td>4.22</td>
      <td>1.835</td>
      <td>19.90</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Toyota Corona</th>
      <td>21.5</td>
      <td>NaN</td>
      <td>120.1</td>
      <td>97.0</td>
      <td>3.70</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dodge Challenger</th>
      <td>15.5</td>
      <td>8.0</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>2.76</td>
      <td>NaN</td>
      <td>16.87</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>AMC Javelin</th>
      <td>15.2</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>NaN</td>
      <td>3.435</td>
      <td>17.30</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Camaro Z28</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>350.0</td>
      <td>245.0</td>
      <td>3.73</td>
      <td>3.840</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Pontiac Firebird</th>
      <td>19.2</td>
      <td>8.0</td>
      <td>400.0</td>
      <td>175.0</td>
      <td>3.08</td>
      <td>3.845</td>
      <td>17.05</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Fiat X1-9</th>
      <td>27.3</td>
      <td>4.0</td>
      <td>79.0</td>
      <td>66.0</td>
      <td>4.08</td>
      <td>1.935</td>
      <td>18.90</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Porsche 914-2</th>
      <td>26.0</td>
      <td>NaN</td>
      <td>120.3</td>
      <td>91.0</td>
      <td>4.43</td>
      <td>NaN</td>
      <td>16.70</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Lotus Europa</th>
      <td>30.4</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>113.0</td>
      <td>3.77</td>
      <td>1.513</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Ford Pantera L</th>
      <td>NaN</td>
      <td>8.0</td>
      <td>351.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Ferrari Dino</th>
      <td>NaN</td>
      <td>6.0</td>
      <td>145.0</td>
      <td>175.0</td>
      <td>3.62</td>
      <td>2.770</td>
      <td>15.50</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>Maserati Bora</th>
      <td>15.0</td>
      <td>NaN</td>
      <td>301.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.60</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>Volvo 142E</th>
      <td>21.4</td>
      <td>4.0</td>
      <td>121.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.780</td>
      <td>18.60</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="iterative-imputer-sklearn">Iterative Imputer (sklearn)</h2>
<p>The Iterative Imputer models each feature with missing values as a function of other features, and uses that estimate for imputation.  It does so in an iterated round-robin fashion: at each step, a feature column is designated as output y and the other feature columns are treated as inputs X.  A regressor is fit on (X, y) for known y. </p>
<p>Then, the regressor is used to predict the missing values of y. </p>
<p>This is done for each feature in an iterative fashion, and then is repeated for max_iter imputation rounds. The results of the final imputation round are returned.</p>
<p><em>Source: https://scikit-learn.org/stable/modules/impute.html#iterative-imputer</em></p>
<pre><code class="language-python">from sklearn.experimental import enable_iterative_imputer
from sklearn.impute import IterativeImputer
imp = IterativeImputer(max_iter=100, random_state=0)

</code></pre>
<pre><code class="language-python">pd.DataFrame(imp.fit_transform(df), columns = df.columns, index = df.index).round(1)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>rownames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.0</td>
      <td>5.2</td>
      <td>160.0</td>
      <td>110.0</td>
      <td>3.9</td>
      <td>2.6</td>
      <td>16.5</td>
      <td>0.7</td>
      <td>0.9</td>
      <td>4.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.0</td>
      <td>6.0</td>
      <td>162.3</td>
      <td>110.0</td>
      <td>3.9</td>
      <td>2.9</td>
      <td>16.8</td>
      <td>0.0</td>
      <td>0.7</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.8</td>
      <td>4.0</td>
      <td>108.0</td>
      <td>90.1</td>
      <td>3.8</td>
      <td>2.3</td>
      <td>18.6</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>20.6</td>
      <td>6.0</td>
      <td>258.0</td>
      <td>110.0</td>
      <td>3.1</td>
      <td>3.2</td>
      <td>19.4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.7</td>
      <td>8.0</td>
      <td>360.0</td>
      <td>190.3</td>
      <td>3.2</td>
      <td>3.4</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>18.1</td>
      <td>5.7</td>
      <td>225.0</td>
      <td>105.0</td>
      <td>2.8</td>
      <td>3.5</td>
      <td>20.2</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.3</td>
      <td>8.0</td>
      <td>360.0</td>
      <td>245.0</td>
      <td>3.2</td>
      <td>3.6</td>
      <td>15.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.4</td>
      <td>4.0</td>
      <td>146.7</td>
      <td>62.0</td>
      <td>3.7</td>
      <td>3.2</td>
      <td>20.0</td>
      <td>0.9</td>
      <td>0.0</td>
      <td>4.3</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>Merc 230</th>
      <td>22.8</td>
      <td>4.0</td>
      <td>140.8</td>
      <td>95.0</td>
      <td>3.9</td>
      <td>3.2</td>
      <td>22.9</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Merc 280</th>
      <td>19.2</td>
      <td>6.0</td>
      <td>167.6</td>
      <td>114.7</td>
      <td>3.9</td>
      <td>3.4</td>
      <td>18.3</td>
      <td>0.6</td>
      <td>0.0</td>
      <td>3.9</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Merc 280C</th>
      <td>17.8</td>
      <td>6.0</td>
      <td>167.6</td>
      <td>115.0</td>
      <td>3.9</td>
      <td>3.4</td>
      <td>18.1</td>
      <td>1.0</td>
      <td>0.4</td>
      <td>4.0</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>Merc 450SE</th>
      <td>16.4</td>
      <td>6.9</td>
      <td>275.8</td>
      <td>180.0</td>
      <td>3.1</td>
      <td>4.1</td>
      <td>19.0</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>3.2</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Merc 450SL</th>
      <td>17.3</td>
      <td>6.7</td>
      <td>275.8</td>
      <td>157.5</td>
      <td>3.1</td>
      <td>3.7</td>
      <td>17.6</td>
      <td>0.0</td>
      <td>0.3</td>
      <td>3.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Merc 450SLC</th>
      <td>15.2</td>
      <td>8.0</td>
      <td>275.8</td>
      <td>180.0</td>
      <td>3.4</td>
      <td>3.6</td>
      <td>18.0</td>
      <td>0.2</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Cadillac Fleetwood</th>
      <td>13.4</td>
      <td>8.0</td>
      <td>472.0</td>
      <td>205.0</td>
      <td>2.9</td>
      <td>5.2</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>-0.2</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Lincoln Continental</th>
      <td>10.8</td>
      <td>8.0</td>
      <td>460.0</td>
      <td>231.2</td>
      <td>2.8</td>
      <td>5.4</td>
      <td>17.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Chrysler Imperial</th>
      <td>14.7</td>
      <td>8.0</td>
      <td>440.0</td>
      <td>230.0</td>
      <td>3.2</td>
      <td>4.6</td>
      <td>17.4</td>
      <td>-0.2</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Fiat 128</th>
      <td>32.4</td>
      <td>4.0</td>
      <td>132.1</td>
      <td>66.0</td>
      <td>4.1</td>
      <td>2.2</td>
      <td>19.8</td>
      <td>0.9</td>
      <td>0.8</td>
      <td>4.2</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Honda Civic</th>
      <td>30.4</td>
      <td>4.0</td>
      <td>75.7</td>
      <td>76.1</td>
      <td>4.9</td>
      <td>1.6</td>
      <td>18.5</td>
      <td>0.9</td>
      <td>1.0</td>
      <td>4.4</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Toyota Corolla</th>
      <td>33.9</td>
      <td>4.0</td>
      <td>71.1</td>
      <td>73.3</td>
      <td>4.2</td>
      <td>1.8</td>
      <td>19.9</td>
      <td>0.9</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Toyota Corona</th>
      <td>21.5</td>
      <td>4.8</td>
      <td>120.1</td>
      <td>97.0</td>
      <td>3.7</td>
      <td>2.8</td>
      <td>20.8</td>
      <td>0.8</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dodge Challenger</th>
      <td>15.5</td>
      <td>8.0</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>2.8</td>
      <td>3.7</td>
      <td>16.9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>AMC Javelin</th>
      <td>15.2</td>
      <td>8.0</td>
      <td>259.5</td>
      <td>150.0</td>
      <td>3.5</td>
      <td>3.4</td>
      <td>17.3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Camaro Z28</th>
      <td>14.4</td>
      <td>8.2</td>
      <td>350.0</td>
      <td>245.0</td>
      <td>3.7</td>
      <td>3.8</td>
      <td>16.9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Pontiac Firebird</th>
      <td>19.2</td>
      <td>8.0</td>
      <td>400.0</td>
      <td>175.0</td>
      <td>3.1</td>
      <td>3.8</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Fiat X1-9</th>
      <td>27.3</td>
      <td>4.0</td>
      <td>79.0</td>
      <td>66.0</td>
      <td>4.1</td>
      <td>1.9</td>
      <td>18.9</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Porsche 914-2</th>
      <td>26.0</td>
      <td>4.7</td>
      <td>120.3</td>
      <td>91.0</td>
      <td>4.4</td>
      <td>2.4</td>
      <td>16.7</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Lotus Europa</th>
      <td>30.4</td>
      <td>4.0</td>
      <td>99.9</td>
      <td>113.0</td>
      <td>3.8</td>
      <td>1.5</td>
      <td>18.1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Ford Pantera L</th>
      <td>17.0</td>
      <td>8.0</td>
      <td>351.0</td>
      <td>187.6</td>
      <td>3.2</td>
      <td>3.7</td>
      <td>14.7</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.7</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Ferrari Dino</th>
      <td>18.9</td>
      <td>6.0</td>
      <td>145.0</td>
      <td>175.0</td>
      <td>3.6</td>
      <td>2.8</td>
      <td>15.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>Maserati Bora</th>
      <td>15.0</td>
      <td>7.0</td>
      <td>301.0</td>
      <td>168.8</td>
      <td>3.3</td>
      <td>4.3</td>
      <td>14.6</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>Volvo 142E</th>
      <td>21.4</td>
      <td>4.0</td>
      <td>121.0</td>
      <td>95.6</td>
      <td>3.9</td>
      <td>2.8</td>
      <td>18.6</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Let us compare imputed results to actual results in our original data.</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/560450b1-b0a9-4ea2-8e0d-92649fc40ff0.png" /></p>
<p>Not bad!!</p>
<h2 id="knn-imputer">KNN Imputer</h2>
<ul>
<li>The KNNImputer class provides imputation for filling in missing values using the k-Nearest Neighbors approach. By default, a euclidean distance metric that supports missing values, <code>nan_euclidean_distances</code>, is used to find the nearest neighbors. </li>
<li>Each missing feature is imputed using values from n_neighbors nearest neighbors that have a value for the feature. </li>
<li>The feature of the neighbors are averaged uniformly or weighted by distance to each neighbor. </li>
<li>When the number of available neighbors is less than n_neighbors and there are no defined distances to the training set, the training set average for that feature is used during imputation. </li>
<li>If there is at least one neighbor with a defined distance, the weighted or unweighted average of the remaining neighbors will be used during imputation. </li>
<li>If a feature is always missing in training, it is removed during transform.</li>
</ul>
<p><em>Source: https://scikit-learn.org/stable/modules/impute.html#knnimpute</em> </p>
<pre><code class="language-python">from sklearn.impute import KNNImputer
imputer = KNNImputer(n_neighbors=2, weights=&quot;uniform&quot;)
pd.DataFrame(imputer.fit_transform(df), columns = df.columns, index = df.index)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>rownames</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mazda RX4</th>
      <td>21.00</td>
      <td>6.0</td>
      <td>160.0</td>
      <td>110.0</td>
      <td>3.330</td>
      <td>2.6200</td>
      <td>16.460</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Mazda RX4 Wag</th>
      <td>21.00</td>
      <td>6.0</td>
      <td>160.0</td>
      <td>177.5</td>
      <td>3.900</td>
      <td>2.2275</td>
      <td>17.020</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Datsun 710</th>
      <td>22.80</td>
      <td>4.0</td>
      <td>108.0</td>
      <td>175.0</td>
      <td>3.850</td>
      <td>2.3200</td>
      <td>18.610</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Hornet 4 Drive</th>
      <td>21.40</td>
      <td>6.0</td>
      <td>258.0</td>
      <td>110.0</td>
      <td>3.080</td>
      <td>3.2150</td>
      <td>19.440</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Hornet Sportabout</th>
      <td>18.70</td>
      <td>6.0</td>
      <td>360.0</td>
      <td>175.0</td>
      <td>3.150</td>
      <td>3.4400</td>
      <td>17.020</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Valiant</th>
      <td>20.30</td>
      <td>6.0</td>
      <td>154.2</td>
      <td>105.0</td>
      <td>2.760</td>
      <td>3.4600</td>
      <td>20.220</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Duster 360</th>
      <td>14.30</td>
      <td>8.0</td>
      <td>360.0</td>
      <td>245.0</td>
      <td>3.210</td>
      <td>3.5700</td>
      <td>15.840</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Merc 240D</th>
      <td>24.40</td>
      <td>5.0</td>
      <td>146.7</td>
      <td>175.0</td>
      <td>3.690</td>
      <td>2.6475</td>
      <td>20.060</td>
      <td>1.0</td>
      <td>0.5</td>
      <td>4.0</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>Merc 230</th>
      <td>22.80</td>
      <td>5.0</td>
      <td>140.8</td>
      <td>175.0</td>
      <td>3.920</td>
      <td>3.1500</td>
      <td>17.815</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Merc 280</th>
      <td>19.20</td>
      <td>6.0</td>
      <td>167.6</td>
      <td>123.0</td>
      <td>3.920</td>
      <td>3.4400</td>
      <td>18.300</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Merc 280C</th>
      <td>17.80</td>
      <td>6.0</td>
      <td>167.6</td>
      <td>114.0</td>
      <td>3.920</td>
      <td>3.4500</td>
      <td>18.900</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Merc 450SE</th>
      <td>12.80</td>
      <td>8.0</td>
      <td>275.8</td>
      <td>212.5</td>
      <td>3.070</td>
      <td>4.0700</td>
      <td>16.705</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Merc 450SL</th>
      <td>12.80</td>
      <td>8.0</td>
      <td>275.8</td>
      <td>180.0</td>
      <td>3.070</td>
      <td>4.7470</td>
      <td>17.650</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Merc 450SLC</th>
      <td>12.55</td>
      <td>8.0</td>
      <td>275.8</td>
      <td>138.5</td>
      <td>3.070</td>
      <td>3.2675</td>
      <td>18.000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Cadillac Fleetwood</th>
      <td>10.40</td>
      <td>8.0</td>
      <td>472.0</td>
      <td>205.0</td>
      <td>2.930</td>
      <td>5.2500</td>
      <td>17.650</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Lincoln Continental</th>
      <td>10.40</td>
      <td>8.0</td>
      <td>373.9</td>
      <td>225.0</td>
      <td>3.000</td>
      <td>5.4240</td>
      <td>16.705</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Chrysler Imperial</th>
      <td>14.70</td>
      <td>7.0</td>
      <td>440.0</td>
      <td>175.0</td>
      <td>3.230</td>
      <td>3.4475</td>
      <td>17.420</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Fiat 128</th>
      <td>32.40</td>
      <td>4.0</td>
      <td>78.7</td>
      <td>66.0</td>
      <td>4.080</td>
      <td>2.2000</td>
      <td>19.400</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Honda Civic</th>
      <td>30.40</td>
      <td>6.0</td>
      <td>75.7</td>
      <td>52.0</td>
      <td>4.930</td>
      <td>1.8850</td>
      <td>18.950</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Toyota Corolla</th>
      <td>27.40</td>
      <td>4.0</td>
      <td>111.2</td>
      <td>59.0</td>
      <td>4.310</td>
      <td>1.8350</td>
      <td>19.900</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>Toyota Corona</th>
      <td>12.80</td>
      <td>6.0</td>
      <td>120.1</td>
      <td>97.0</td>
      <td>3.700</td>
      <td>2.4650</td>
      <td>17.650</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Dodge Challenger</th>
      <td>15.50</td>
      <td>8.0</td>
      <td>318.0</td>
      <td>175.0</td>
      <td>2.955</td>
      <td>3.5200</td>
      <td>16.355</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>AMC Javelin</th>
      <td>15.20</td>
      <td>8.0</td>
      <td>359.0</td>
      <td>138.5</td>
      <td>3.150</td>
      <td>3.4350</td>
      <td>17.300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Camaro Z28</th>
      <td>12.95</td>
      <td>8.0</td>
      <td>296.9</td>
      <td>245.0</td>
      <td>3.035</td>
      <td>4.7470</td>
      <td>15.410</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>Pontiac Firebird</th>
      <td>12.80</td>
      <td>8.0</td>
      <td>400.0</td>
      <td>254.5</td>
      <td>3.080</td>
      <td>4.4295</td>
      <td>17.050</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Fiat X1-9</th>
      <td>23.80</td>
      <td>4.0</td>
      <td>79.0</td>
      <td>85.5</td>
      <td>4.080</td>
      <td>1.9350</td>
      <td>18.900</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>Porsche 914-2</th>
      <td>12.80</td>
      <td>4.0</td>
      <td>120.3</td>
      <td>91.0</td>
      <td>4.430</td>
      <td>2.6350</td>
      <td>18.600</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>5.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Lotus Europa</th>
      <td>12.80</td>
      <td>6.0</td>
      <td>95.1</td>
      <td>113.0</td>
      <td>3.770</td>
      <td>1.5130</td>
      <td>18.600</td>
      <td>1.0</td>
      <td>0.5</td>
      <td>5.0</td>
      <td>2.5</td>
    </tr>
    <tr>
      <th>Ford Pantera L</th>
      <td>15.80</td>
      <td>8.0</td>
      <td>296.9</td>
      <td>264.0</td>
      <td>4.220</td>
      <td>3.1700</td>
      <td>14.500</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Ferrari Dino</th>
      <td>17.40</td>
      <td>6.0</td>
      <td>145.0</td>
      <td>175.0</td>
      <td>3.620</td>
      <td>4.4295</td>
      <td>15.500</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>Maserati Bora</th>
      <td>15.00</td>
      <td>6.0</td>
      <td>301.0</td>
      <td>335.0</td>
      <td>3.540</td>
      <td>3.5700</td>
      <td>14.600</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>Volvo 142E</th>
      <td>21.40</td>
      <td>4.0</td>
      <td>121.0</td>
      <td>109.0</td>
      <td>4.110</td>
      <td>2.7800</td>
      <td>18.600</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.5</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Let us compare imputed values to actual data.</p>
<p><img alt="image.png" src="../04_Data_Preparation_files/dfb564bb-58b7-4834-bfb9-428e20936fb8.png" /></p>
<p>This is even better than the iterative imputer!!</p>
<h2 id="list-comprehension-and-other-useful-tricks">List Comprehension and Other Useful Tricks</h2>
<p>List comprehension returns a list, and takes the following format:</p>
<blockquote>
<p><strong>[</strong> function(item) <strong>for</strong> item <strong>in</strong> iterable <strong>if</strong> condition <strong>]</strong> </p>
</blockquote>
<pre><code class="language-python"># Create an empty dataframe

import pandas as pd

df = pd.DataFrame(columns = ['Date', 'User 1', 'User 2', 'User 3', 'User 4', 'User 5', 'User 6', 'User 7'])
df

</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>User 1</th>
      <th>User 2</th>
      <th>User 3</th>
      <th>User 4</th>
      <th>User 5</th>
      <th>User 6</th>
      <th>User 7</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<pre><code class="language-python"># List all columns in a dataframe meeting a criteria

[col for col in df if col.startswith('U')]
</code></pre>
<pre><code>['User 1', 'User 2', 'User 3', 'User 4', 'User 5', 'User 6', 'User 7']
</code></pre>
<pre><code class="language-python"># If condition in a single line

b = 4
a = &quot;positive&quot; if b &gt;= 0 else &quot;negative&quot;
a
</code></pre>
<pre><code>'positive'
</code></pre>
<p><strong>List comprehension</strong><br />
newlist = [expression for item in iterable if condition == True]</p>
<pre><code class="language-python"># Basic list comprehension
x = list(v**2 for v in range(4))
x
</code></pre>
<pre><code>[0, 1, 4, 9]
</code></pre>
<pre><code class="language-python"># List comprehension

fruits = [&quot;apple&quot;, &quot;banana&quot;, &quot;cherry&quot;, &quot;kiwi&quot;, &quot;mango&quot;]

newlist = [x for x in fruits if &quot;a&quot; in x]

print(newlist)
</code></pre>
<pre><code>['apple', 'banana', 'mango']
</code></pre>
<pre><code class="language-python"># Subsetting a dict

samples = {k: v for k, v in samples.items() if k not in [&quot;idx&quot;, &quot;sentence1&quot;, &quot;sentence2&quot;]}
</code></pre>
<pre><code class="language-python"># A function to identify text in a string
def corona(text):
    corona_story_strings = ['covid', 'corona', 'sars', 'virus', 'coronavirus', 'vaccine']
    return any(x in text for x in corona_story_strings)
</code></pre>
<pre><code class="language-python">
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../03_Visualization_Basics/" class="btn btn-neutral float-left" title="Visualization Basics"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../05_Introduction_to_Modeling/" class="btn btn-neutral float-right" title="Introduction to Modeling">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../03_Visualization_Basics/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../05_Introduction_to_Modeling/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
